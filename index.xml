<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Explained Intuitively</title>
<link>https://www.arunprakash.org/index.html</link>
<atom:link href="https://www.arunprakash.org/index.xml" rel="self" type="application/rss+xml"/>
<description>A blog about large language models and tools</description>
<generator>quarto-1.3.340</generator>
<lastBuildDate>Thu, 04 Jan 2024 18:30:00 GMT</lastBuildDate>
<item>
  <title>Master the Art of Function Calling in OpenAI Assistants API: A Comprehensive Guide for Beginners</title>
  <dc:creator>Arun Prakash</dc:creator>
  <link>https://www.arunprakash.org/posts/master-the-art-of-function-calling-in-openai-assistants-api-a-comprehensive-guide-for-beginners/assistants_function_calling.html</link>
  <description><![CDATA[ 




<p><img src="https://www.arunprakash.org/posts/master-the-art-of-function-calling-in-openai-assistants-api-a-comprehensive-guide-for-beginners/assistant.png" class="img-fluid"></p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># !pip3 install openai -U</span></span></code></pre></div>
</div>
<p>Welcome to our comprehensive guide on leveraging function calling in the OpenAI Assistant API. Whether you’re a seasoned developer or a curious beginner, this tutorial is designed to help you understand and implement this powerful feature in your AI projects.</p>
<p>Here’s what we’ll be diving into:</p>
<ul>
<li>The basics of function calling in the OpenAI Assistant API</li>
<li>Steps to create an assistant</li>
<li>Crafting a message and initiating a thread</li>
<li>Identifying when a message requires a function call</li>
<li>Determining which function to call and what arguments to pass</li>
<li>Retrieving the response from a function call</li>
<li>Understanding the final response</li>
</ul>
<p>OpenAI Assistants are equipped with a variety of tools, including retrieval, code interpretation, and function calling. In this guide, we’ll be focusing primarily on the function calling capabilities.</p>
<p>To illustrate these concepts, we’ll walk you through a simple demo. We’ll start by demonstrating a common challenge - reversing a string - and then show you how to overcome this challenge by creating a function that reverses the string and integrating it with the assistant.</p>
<p>Our goal is to provide you with a clear, practical understanding of function calling in the OpenAI Assistant API, empowering you to create more dynamic and interactive AI applications. Let’s get started!</p>
<p>In general, assistants can use tools such as retrrieval, code interpreter, and function calling.</p>
<p>In this tutorial we focus more on function calling capabilities of assistants.</p>
<p>We create a simple demo that shows the failure of reversing a string and then we create a function that reverses the string and connect it with the assistant.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dictionary print indentatio</span></span></code></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> json</span>
<span id="cb3-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb3-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> dotenv <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> load_dotenv</span>
<span id="cb3-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> openai</span>
<span id="cb3-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> openai <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> OpenAI</span>
<span id="cb3-6">client <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> OpenAI()</span>
<span id="cb3-7">load_dotenv()</span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># openai key</span></span>
<span id="cb3-9">OPENAI_API_KEY <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OPENAI_API_KEY"</span>)</span>
<span id="cb3-10">openai.api_key <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> OPENAI_API_KEY</span>
<span id="cb3-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> IPython.display <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> display, Markdown</span></code></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># openai version</span></span>
<span id="cb4-2">openai.__version__</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>'1.6.1'</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb6-2">    model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4-1106-preview"</span>,</span>
<span id="cb6-3">    messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb6-4">        {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reverse the string openaichatgpt"</span>},</span>
<span id="cb6-5">    ],</span>
<span id="cb6-6">    temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb6-7">    seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb6-8">)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">display(Markdown(response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].message.content))</span></code></pre></div>
<div class="cell-output cell-output-display">
<p>To reverse the string “openaichatgpt”, you would simply reverse the order of the characters to get “tpgtahciapeneo”.</p>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"tpgtahciapeneo"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"openaichatgpt"</span>[::<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>False</code></pre>
</div>
</div>
<p>Large Language Models use tokens to split text into smaller pieces, and reversing a string is not a usual data that is has seen during training, so it is not able to predict it correctly.</p>
<p>We can fix this by creating a function that will reverse the string, and use the model to ask us to call the function and get results and pass it to the model.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> reverse_string(string):</span>
<span id="cb10-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> string[::<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span></code></pre></div>
</div>
<section id="creating-an-assistant" class="level1">
<h1>Creating an Assistant</h1>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># function_json for reverse_string</span></span>
<span id="cb11-2">function_json <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'type'</span>:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'function'</span>,</span>
<span id="cb11-3">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'function'</span>:{</span>
<span id="cb11-4">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'name'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'reverse_string'</span>,</span>
<span id="cb11-5">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'parameters'</span>:{</span>
<span id="cb11-6">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"object"</span>,</span>
<span id="cb11-7">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"properties"</span>:{</span>
<span id="cb11-8">                          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"string"</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'type'</span>:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'string'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'description'</span>:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A single word"</span>},</span>
<span id="cb11-9">                      },</span>
<span id="cb11-10">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'required'</span> : [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"string"</span>]</span>
<span id="cb11-11">                }</span>
<span id="cb11-12"></span>
<span id="cb11-13">    }</span>
<span id="cb11-14">}</span></code></pre></div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">available_functions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb12-2">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reverse_string"</span>: reverse_string</span>
<span id="cb12-3">}</span></code></pre></div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> openai <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> OpenAI</span>
<span id="cb13-2">client <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> OpenAI()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">assistant <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.beta.assistants.create(</span>
<span id="cb14-2">    name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Python Tutor"</span>,</span>
<span id="cb14-3">    instructions<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a personal python tutor."</span>,</span>
<span id="cb14-4">    tools<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[function_json],</span>
<span id="cb14-5">    model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4-1106-preview"</span></span>
<span id="cb14-6">)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">assistant</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>Assistant(id='asst_UQEBrB5fuKnzx472Sf5qWYdH', created_at=1704457106, description=None, file_ids=[], instructions='You are a personal python tutor.', metadata={}, model='gpt-4-1106-preview', name='Python Tutor', object='assistant', tools=[ToolFunction(function=FunctionDefinition(name='reverse_string', description=None, parameters={'type': 'object', 'properties': {'string': {'type': 'string', 'description': 'A single word'}}, 'required': ['string']}), type='function')])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(json.dumps(assistant.model_dump(), indent<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{
    "id": "asst_UQEBrB5fuKnzx472Sf5qWYdH",
    "created_at": 1704457106,
    "description": null,
    "file_ids": [],
    "instructions": "You are a personal python tutor.",
    "metadata": {},
    "model": "gpt-4-1106-preview",
    "name": "Python Tutor",
    "object": "assistant",
    "tools": [
        {
            "function": {
                "name": "reverse_string",
                "description": null,
                "parameters": {
                    "type": "object",
                    "properties": {
                        "string": {
                            "type": "string",
                            "description": "A single word"
                        }
                    },
                    "required": [
                        "string"
                    ]
                }
            },
            "type": "function"
        }
    ]
}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span>(assistant)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>openai.types.beta.assistant.Assistant</code></pre>
</div>
</div>
</section>
<section id="thread" class="level1">
<h1>Thread</h1>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1">thread <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.beta.threads.create()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">thread.model_dump()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>{'id': 'thread_3fT59LTUrodHJPjBQYsIYm6F',
 'created_at': 1704457106,
 'metadata': {},
 'object': 'thread'}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1">thread</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>Thread(id='thread_3fT59LTUrodHJPjBQYsIYm6F', created_at=1704457106, metadata={}, object='thread')</code></pre>
</div>
</div>
</section>
<section id="add-a-message-to-a-thread" class="level1">
<h1>Add a Message to a Thread</h1>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1">message <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.beta.threads.messages.create(</span>
<span id="cb26-2">    thread_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>thread.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>,</span>
<span id="cb26-3">    role<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>,</span>
<span id="cb26-4">    content<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"what are different loops in python?"</span></span>
<span id="cb26-5">)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">message</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>ThreadMessage(id='msg_UDx8nMLlKxvriXAEBeW0AJ9f', assistant_id=None, content=[MessageContentText(text=Text(annotations=[], value='what are different loops in python?'), type='text')], created_at=1704457107, file_ids=[], metadata={}, object='thread.message', role='user', run_id=None, thread_id='thread_3fT59LTUrodHJPjBQYsIYm6F')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">message.model_dump()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>{'id': 'msg_UDx8nMLlKxvriXAEBeW0AJ9f',
 'assistant_id': None,
 'content': [{'text': {'annotations': [],
    'value': 'what are different loops in python?'},
   'type': 'text'}],
 'created_at': 1704457107,
 'file_ids': [],
 'metadata': {},
 'object': 'thread.message',
 'role': 'user',
 'run_id': None,
 'thread_id': 'thread_3fT59LTUrodHJPjBQYsIYm6F'}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1">thread_messages <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.beta.threads.messages.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(thread_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>thread.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>)</span>
<span id="cb31-2">thread_messages.data</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>[ThreadMessage(id='msg_UDx8nMLlKxvriXAEBeW0AJ9f', assistant_id=None, content=[MessageContentText(text=Text(annotations=[], value='what are different loops in python?'), type='text')], created_at=1704457107, file_ids=[], metadata={}, object='thread.message', role='user', run_id=None, thread_id='thread_3fT59LTUrodHJPjBQYsIYm6F')]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1">thread_messages.model_dump()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>{'data': [{'id': 'msg_UDx8nMLlKxvriXAEBeW0AJ9f',
   'assistant_id': None,
   'content': [{'text': {'annotations': [],
      'value': 'what are different loops in python?'},
     'type': 'text'}],
   'created_at': 1704457107,
   'file_ids': [],
   'metadata': {},
   'object': 'thread.message',
   'role': 'user',
   'run_id': None,
   'thread_id': 'thread_3fT59LTUrodHJPjBQYsIYm6F'}],
 'object': 'list',
 'first_id': 'msg_UDx8nMLlKxvriXAEBeW0AJ9f',
 'last_id': 'msg_UDx8nMLlKxvriXAEBeW0AJ9f',
 'has_more': False}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1">run <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.beta.threads.runs.create(</span>
<span id="cb35-2">  thread_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>thread.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>,</span>
<span id="cb35-3">  assistant_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>assistant.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>,</span>
<span id="cb35-4">)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(json.dumps(run.model_dump(), indent<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{
    "id": "run_BLZnD60Vl7wePLUsdmUFR5zd",
    "assistant_id": "asst_UQEBrB5fuKnzx472Sf5qWYdH",
    "cancelled_at": null,
    "completed_at": null,
    "created_at": 1704457108,
    "expires_at": 1704457708,
    "failed_at": null,
    "file_ids": [],
    "instructions": "You are a personal python tutor.",
    "last_error": null,
    "metadata": {},
    "model": "gpt-4-1106-preview",
    "object": "thread.run",
    "required_action": null,
    "started_at": null,
    "status": "queued",
    "thread_id": "thread_3fT59LTUrodHJPjBQYsIYm6F",
    "tools": [
        {
            "function": {
                "name": "reverse_string",
                "description": null,
                "parameters": {
                    "type": "object",
                    "properties": {
                        "string": {
                            "type": "string",
                            "description": "A single word"
                        }
                    },
                    "required": [
                        "string"
                    ]
                }
            },
            "type": "function"
        }
    ]
}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1">run <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.beta.threads.runs.retrieve(</span>
<span id="cb38-2">  thread_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>thread.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>,</span>
<span id="cb38-3">  run_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>run.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span></span>
<span id="cb38-4">)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(json.dumps(run.model_dump(), indent<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{
    "id": "run_BLZnD60Vl7wePLUsdmUFR5zd",
    "assistant_id": "asst_UQEBrB5fuKnzx472Sf5qWYdH",
    "cancelled_at": null,
    "completed_at": null,
    "created_at": 1704457108,
    "expires_at": 1704457708,
    "failed_at": null,
    "file_ids": [],
    "instructions": "You are a personal python tutor.",
    "last_error": null,
    "metadata": {},
    "model": "gpt-4-1106-preview",
    "object": "thread.run",
    "required_action": null,
    "started_at": 1704457108,
    "status": "in_progress",
    "thread_id": "thread_3fT59LTUrodHJPjBQYsIYm6F",
    "tools": [
        {
            "function": {
                "name": "reverse_string",
                "description": null,
                "parameters": {
                    "type": "object",
                    "properties": {
                        "string": {
                            "type": "string",
                            "description": "A single word"
                        }
                    },
                    "required": [
                        "string"
                    ]
                }
            },
            "type": "function"
        }
    ]
}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1">run</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>Run(id='run_BLZnD60Vl7wePLUsdmUFR5zd', assistant_id='asst_UQEBrB5fuKnzx472Sf5qWYdH', cancelled_at=None, completed_at=None, created_at=1704457108, expires_at=1704457708, failed_at=None, file_ids=[], instructions='You are a personal python tutor.', last_error=None, metadata={}, model='gpt-4-1106-preview', object='thread.run', required_action=None, started_at=1704457108, status='in_progress', thread_id='thread_3fT59LTUrodHJPjBQYsIYm6F', tools=[ToolAssistantToolsFunction(function=FunctionDefinition(name='reverse_string', description=None, parameters={'type': 'object', 'properties': {'string': {'type': 'string', 'description': 'A single word'}}, 'required': ['string']}), type='function')])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1">run.status</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>'in_progress'</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span></code></pre></div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> run.status <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"queued"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">or</span> run.status <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"in_progress"</span>:</span>
<span id="cb46-2">    run <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.beta.threads.runs.retrieve(</span>
<span id="cb46-3">      thread_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>thread.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>,</span>
<span id="cb46-4">      run_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>run.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span></span>
<span id="cb46-5">    )</span>
<span id="cb46-6">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(run.status)</span>
<span id="cb46-7">    time.sleep(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb46-8">    </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>in_progress
in_progress
in_progress
in_progress
in_progress
in_progress
in_progress
in_progress
in_progress
in_progress
in_progress
in_progress
in_progress
completed</code></pre>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1">run</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>Run(id='run_BLZnD60Vl7wePLUsdmUFR5zd', assistant_id='asst_UQEBrB5fuKnzx472Sf5qWYdH', cancelled_at=None, completed_at=1704457140, created_at=1704457108, expires_at=None, failed_at=None, file_ids=[], instructions='You are a personal python tutor.', last_error=None, metadata={}, model='gpt-4-1106-preview', object='thread.run', required_action=None, started_at=1704457108, status='completed', thread_id='thread_3fT59LTUrodHJPjBQYsIYm6F', tools=[ToolAssistantToolsFunction(function=FunctionDefinition(name='reverse_string', description=None, parameters={'type': 'object', 'properties': {'string': {'type': 'string', 'description': 'A single word'}}, 'required': ['string']}), type='function')])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1">messages <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.beta.threads.messages.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb50-2">  thread_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>thread.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span></span>
<span id="cb50-3">)</span>
<span id="cb50-4"></span>
<span id="cb50-5">messages</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>SyncCursorPage[ThreadMessage](data=[ThreadMessage(id='msg_a5FW3oicgn271ztQwcIa6kQ6', assistant_id='asst_UQEBrB5fuKnzx472Sf5qWYdH', content=[MessageContentText(text=Text(annotations=[], value='In Python, there are two primary types of loops that allow you to execute a block of code repeatedly:\n\n1. `for` Loop: This loop is used for iterating over a sequence (which could be a list, tuple, dictionary, set, or string) with the ability to execute a block of code for each item in the sequence. An example of a `for` loop:\n\n```python\nfor item in ["apple", "banana", "cherry"]:\n    print(item)\n```\n\n2. `while` Loop: This loop repeatedly executes the target statement(s) as long as the given condition is true. The condition is evaluated before executing the body of the loop. Here\'s an example of a `while` loop:\n\n```python\ncount = 0\nwhile count &lt; 5:\n    print(count)\n    count += 1\n```\n\nPython also provides some loop control statements that can be used within these loops:\n\n- `break`: Terminates the loop and transfers execution to the statement immediately following the loop.\n- `continue`: Skips the remaining part of the loop for the current iteration and moves to the next iteration.\n- `else`: An optional clause associated with loops that is executed if the loop completes normally (i.e., not terminated by a `break` statement).\n\nHere\'s an example of using `break`, `continue`, and `else` with a `for` loop:\n\n```python\nfor num in range(2, 10):\n    if num % 2 == 0:\n        print("Found an even number", num)\n        continue\n    print("Found a number", num)\nelse:\n    print("The loop is completed without a break statement.")\n```\n\nAnd an example using `while` loop:\n\n```python\ncount = 1\nwhile count &lt; 10:\n    if count == 5:\n        break\n    print(count)\n    count += 1\nelse:\n    print("Reached the value of 5 and stopped the loop with a break statement.")\n```\n\nAdditionally, Python allows the use of nested loops (a loop inside another loop), which can be useful for more complex iteration scenarios. However, it\'s important to use them judiciously as they can lead to high computational complexity, especially with large datasets.'), type='text')], created_at=1704457109, file_ids=[], metadata={}, object='thread.message', role='assistant', run_id='run_BLZnD60Vl7wePLUsdmUFR5zd', thread_id='thread_3fT59LTUrodHJPjBQYsIYm6F'), ThreadMessage(id='msg_UDx8nMLlKxvriXAEBeW0AJ9f', assistant_id=None, content=[MessageContentText(text=Text(annotations=[], value='what are different loops in python?'), type='text')], created_at=1704457107, file_ids=[], metadata={}, object='thread.message', role='user', run_id=None, thread_id='thread_3fT59LTUrodHJPjBQYsIYm6F')], object='list', first_id='msg_a5FW3oicgn271ztQwcIa6kQ6', last_id='msg_UDx8nMLlKxvriXAEBeW0AJ9f', has_more=False)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(json.dumps(messages.model_dump(), indent<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{
    "data": [
        {
            "id": "msg_a5FW3oicgn271ztQwcIa6kQ6",
            "assistant_id": "asst_UQEBrB5fuKnzx472Sf5qWYdH",
            "content": [
                {
                    "text": {
                        "annotations": [],
                        "value": "In Python, there are two primary types of loops that allow you to execute a block of code repeatedly:\n\n1. `for` Loop: This loop is used for iterating over a sequence (which could be a list, tuple, dictionary, set, or string) with the ability to execute a block of code for each item in the sequence. An example of a `for` loop:\n\n```python\nfor item in [\"apple\", \"banana\", \"cherry\"]:\n    print(item)\n```\n\n2. `while` Loop: This loop repeatedly executes the target statement(s) as long as the given condition is true. The condition is evaluated before executing the body of the loop. Here's an example of a `while` loop:\n\n```python\ncount = 0\nwhile count &lt; 5:\n    print(count)\n    count += 1\n```\n\nPython also provides some loop control statements that can be used within these loops:\n\n- `break`: Terminates the loop and transfers execution to the statement immediately following the loop.\n- `continue`: Skips the remaining part of the loop for the current iteration and moves to the next iteration.\n- `else`: An optional clause associated with loops that is executed if the loop completes normally (i.e., not terminated by a `break` statement).\n\nHere's an example of using `break`, `continue`, and `else` with a `for` loop:\n\n```python\nfor num in range(2, 10):\n    if num % 2 == 0:\n        print(\"Found an even number\", num)\n        continue\n    print(\"Found a number\", num)\nelse:\n    print(\"The loop is completed without a break statement.\")\n```\n\nAnd an example using `while` loop:\n\n```python\ncount = 1\nwhile count &lt; 10:\n    if count == 5:\n        break\n    print(count)\n    count += 1\nelse:\n    print(\"Reached the value of 5 and stopped the loop with a break statement.\")\n```\n\nAdditionally, Python allows the use of nested loops (a loop inside another loop), which can be useful for more complex iteration scenarios. However, it's important to use them judiciously as they can lead to high computational complexity, especially with large datasets."
                    },
                    "type": "text"
                }
            ],
            "created_at": 1704457109,
            "file_ids": [],
            "metadata": {},
            "object": "thread.message",
            "role": "assistant",
            "run_id": "run_BLZnD60Vl7wePLUsdmUFR5zd",
            "thread_id": "thread_3fT59LTUrodHJPjBQYsIYm6F"
        },
        {
            "id": "msg_UDx8nMLlKxvriXAEBeW0AJ9f",
            "assistant_id": null,
            "content": [
                {
                    "text": {
                        "annotations": [],
                        "value": "what are different loops in python?"
                    },
                    "type": "text"
                }
            ],
            "created_at": 1704457107,
            "file_ids": [],
            "metadata": {},
            "object": "thread.message",
            "role": "user",
            "run_id": null,
            "thread_id": "thread_3fT59LTUrodHJPjBQYsIYm6F"
        }
    ],
    "object": "list",
    "first_id": "msg_a5FW3oicgn271ztQwcIa6kQ6",
    "last_id": "msg_UDx8nMLlKxvriXAEBeW0AJ9f",
    "has_more": false
}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1">display(Markdown(messages.data[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].content[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].text.value))</span></code></pre></div>
<div class="cell-output cell-output-display">
<p>In Python, there are two primary types of loops that allow you to execute a block of code repeatedly:</p>
<ol type="1">
<li><code>for</code> Loop: This loop is used for iterating over a sequence (which could be a list, tuple, dictionary, set, or string) with the ability to execute a block of code for each item in the sequence. An example of a <code>for</code> loop:</li>
</ol>
<div class="sourceCode" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> item <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"apple"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"banana"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cherry"</span>]:</span>
<span id="cb55-2">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(item)</span></code></pre></div>
<ol start="2" type="1">
<li><code>while</code> Loop: This loop repeatedly executes the target statement(s) as long as the given condition is true. The condition is evaluated before executing the body of the loop. Here’s an example of a <code>while</code> loop:</li>
</ol>
<div class="sourceCode" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1">count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb56-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>:</span>
<span id="cb56-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(count)</span>
<span id="cb56-4">    count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span></code></pre></div>
<p>Python also provides some loop control statements that can be used within these loops:</p>
<ul>
<li><code>break</code>: Terminates the loop and transfers execution to the statement immediately following the loop.</li>
<li><code>continue</code>: Skips the remaining part of the loop for the current iteration and moves to the next iteration.</li>
<li><code>else</code>: An optional clause associated with loops that is executed if the loop completes normally (i.e., not terminated by a <code>break</code> statement).</li>
</ul>
<p>Here’s an example of using <code>break</code>, <code>continue</code>, and <code>else</code> with a <code>for</code> loop:</p>
<div class="sourceCode" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> num <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>):</span>
<span id="cb57-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> num <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb57-3">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Found an even number"</span>, num)</span>
<span id="cb57-4">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">continue</span></span>
<span id="cb57-5">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Found a number"</span>, num)</span>
<span id="cb57-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb57-7">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The loop is completed without a break statement."</span>)</span></code></pre></div>
<p>And an example using <code>while</code> loop:</p>
<div class="sourceCode" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1">count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb58-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>:</span>
<span id="cb58-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>:</span>
<span id="cb58-4">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">break</span></span>
<span id="cb58-5">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(count)</span>
<span id="cb58-6">    count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb58-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb58-8">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reached the value of 5 and stopped the loop with a break statement."</span>)</span></code></pre></div>
<p>Additionally, Python allows the use of nested loops (a loop inside another loop), which can be useful for more complex iteration scenarios. However, it’s important to use them judiciously as they can lead to high computational complexity, especially with large datasets.</p>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># new message</span></span>
<span id="cb59-2">message <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.beta.threads.messages.create(</span>
<span id="cb59-3">    thread_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>thread.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>,</span>
<span id="cb59-4">    role<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>,</span>
<span id="cb59-5">    content<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"what's the reverse of the string openaichatgpt?"</span></span>
<span id="cb59-6">)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># new run</span></span>
<span id="cb60-2">run <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.beta.threads.runs.create(</span>
<span id="cb60-3">  thread_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>thread.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>,</span>
<span id="cb60-4">  assistant_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>assistant.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>,</span>
<span id="cb60-5">)</span>
<span id="cb60-6"></span>
<span id="cb60-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># wait for run to complete</span></span>
<span id="cb60-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> run.status <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"queued"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">or</span> run.status <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"in_progress"</span>:</span>
<span id="cb60-9">    run <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.beta.threads.runs.retrieve(</span>
<span id="cb60-10">      thread_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>thread.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>,</span>
<span id="cb60-11">      run_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>run.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span></span>
<span id="cb60-12">    )</span>
<span id="cb60-13">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(run.status)</span>
<span id="cb60-14">    time.sleep(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>in_progress
in_progress
requires_action</code></pre>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1">run.status</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>'requires_action'</code></pre>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(json.dumps(run.model_dump(), indent<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{
    "id": "run_dmH9mQUYjLLQJEYuXZQZJOHH",
    "assistant_id": "asst_UQEBrB5fuKnzx472Sf5qWYdH",
    "cancelled_at": null,
    "completed_at": null,
    "created_at": 1704457145,
    "expires_at": 1704457745,
    "failed_at": null,
    "file_ids": [],
    "instructions": "You are a personal python tutor.",
    "last_error": null,
    "metadata": {},
    "model": "gpt-4-1106-preview",
    "object": "thread.run",
    "required_action": {
        "submit_tool_outputs": {
            "tool_calls": [
                {
                    "id": "call_aQzOoDu3V00J5lkG6zVNtdqc",
                    "function": {
                        "arguments": "{\"string\":\"openaichatgpt\"}",
                        "name": "reverse_string"
                    },
                    "type": "function"
                }
            ]
        },
        "type": "submit_tool_outputs"
    },
    "started_at": 1704457145,
    "status": "requires_action",
    "thread_id": "thread_3fT59LTUrodHJPjBQYsIYm6F",
    "tools": [
        {
            "function": {
                "name": "reverse_string",
                "description": null,
                "parameters": {
                    "type": "object",
                    "properties": {
                        "string": {
                            "type": "string",
                            "description": "A single word"
                        }
                    },
                    "required": [
                        "string"
                    ]
                }
            },
            "type": "function"
        }
    ]
}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1">run.required_action</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>RequiredAction(submit_tool_outputs=RequiredActionSubmitToolOutputs(tool_calls=[RequiredActionFunctionToolCall(id='call_aQzOoDu3V00J5lkG6zVNtdqc', function=Function(arguments='{"string":"openaichatgpt"}', name='reverse_string'), type='function')]), type='submit_tool_outputs')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> run.status <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"requires_action"</span>:</span>
<span id="cb68-2">    tool_call <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> run.required_action.submit_tool_outputs.tool_calls[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb68-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tool call: "</span>, tool_call)</span>
<span id="cb68-4">    function_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tool_call.function.name</span>
<span id="cb68-5">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Function name: "</span>, function_name)</span>
<span id="cb68-6">    arguments <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.loads(tool_call.function.arguments)</span>
<span id="cb68-7">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Function arguments: "</span>, arguments)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tool call:  RequiredActionFunctionToolCall(id='call_aQzOoDu3V00J5lkG6zVNtdqc', function=Function(arguments='{"string":"openaichatgpt"}', name='reverse_string'), type='function')
Function name:  reverse_string
Function arguments:  {'string': 'openaichatgpt'}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># call the function</span></span>
<span id="cb70-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> run.status <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"requires_action"</span>:</span>
<span id="cb70-3">    tool_call <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> run.required_action.submit_tool_outputs.tool_calls[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb70-4">    function_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tool_call.function.name</span>
<span id="cb70-5">    arguments <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.loads(tool_call.function.arguments)</span>
<span id="cb70-6">    function <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> available_functions[function_name]</span>
<span id="cb70-7">    output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> function(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>arguments)</span>
<span id="cb70-8">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Function output: "</span>, output)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Function output:  tpgtahcianepo</code></pre>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(json.dumps(run.model_dump(), indent<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{
    "id": "run_dmH9mQUYjLLQJEYuXZQZJOHH",
    "assistant_id": "asst_UQEBrB5fuKnzx472Sf5qWYdH",
    "cancelled_at": null,
    "completed_at": null,
    "created_at": 1704457145,
    "expires_at": 1704457745,
    "failed_at": null,
    "file_ids": [],
    "instructions": "You are a personal python tutor.",
    "last_error": null,
    "metadata": {},
    "model": "gpt-4-1106-preview",
    "object": "thread.run",
    "required_action": {
        "submit_tool_outputs": {
            "tool_calls": [
                {
                    "id": "call_aQzOoDu3V00J5lkG6zVNtdqc",
                    "function": {
                        "arguments": "{\"string\":\"openaichatgpt\"}",
                        "name": "reverse_string"
                    },
                    "type": "function"
                }
            ]
        },
        "type": "submit_tool_outputs"
    },
    "started_at": 1704457145,
    "status": "requires_action",
    "thread_id": "thread_3fT59LTUrodHJPjBQYsIYm6F",
    "tools": [
        {
            "function": {
                "name": "reverse_string",
                "description": null,
                "parameters": {
                    "type": "object",
                    "properties": {
                        "string": {
                            "type": "string",
                            "description": "A single word"
                        }
                    },
                    "required": [
                        "string"
                    ]
                }
            },
            "type": "function"
        }
    ]
}</code></pre>
</div>
</div>
</section>
<section id="let-the-model-know-about-the-function-outputs" class="level1">
<h1>Let the Model Know about the function outputs</h1>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1">run <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.beta.threads.runs.submit_tool_outputs(</span>
<span id="cb74-2">    thread_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>thread.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>,</span>
<span id="cb74-3">    run_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>run.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>,</span>
<span id="cb74-4">    tool_outputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[{<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tool_call_id"</span>: tool_call.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"output"</span>: json.dumps(output)}],</span>
<span id="cb74-5">)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb75" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> run.status <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"queued"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">or</span> run.status <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"in_progress"</span>:</span>
<span id="cb75-2">    run <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.beta.threads.runs.retrieve(</span>
<span id="cb75-3">      thread_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>thread.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>,</span>
<span id="cb75-4">      run_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>run.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span></span>
<span id="cb75-5">    )</span>
<span id="cb75-6">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(run.status)</span>
<span id="cb75-7">    time.sleep(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>in_progress
completed</code></pre>
</div>
</div>
</section>
<section id="retrieve-the-message-from-history-and-display-the-output" class="level1">
<h1>Retrieve the message from history and display the output</h1>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb77" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1">messages <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.beta.threads.messages.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb77-2">    thread_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>thread.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span></span>
<span id="cb77-3">    )</span></code></pre></div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb78" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(json.dumps(messages.model_dump(), indent<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{
    "data": [
        {
            "id": "msg_vp29v6UA7Amr7isw4LdGNhcW",
            "assistant_id": "asst_UQEBrB5fuKnzx472Sf5qWYdH",
            "content": [
                {
                    "text": {
                        "annotations": [],
                        "value": "The reverse of the string \"openaichatgpt\" is \"tpgtahcianepo\"."
                    },
                    "type": "text"
                }
            ],
            "created_at": 1704457154,
            "file_ids": [],
            "metadata": {},
            "object": "thread.message",
            "role": "assistant",
            "run_id": "run_dmH9mQUYjLLQJEYuXZQZJOHH",
            "thread_id": "thread_3fT59LTUrodHJPjBQYsIYm6F"
        },
        {
            "id": "msg_QPbWzZkoRFveMIRPWtvREz0s",
            "assistant_id": null,
            "content": [
                {
                    "text": {
                        "annotations": [],
                        "value": "what's the reverse of the string openaichatgpt?"
                    },
                    "type": "text"
                }
            ],
            "created_at": 1704457145,
            "file_ids": [],
            "metadata": {},
            "object": "thread.message",
            "role": "user",
            "run_id": null,
            "thread_id": "thread_3fT59LTUrodHJPjBQYsIYm6F"
        },
        {
            "id": "msg_a5FW3oicgn271ztQwcIa6kQ6",
            "assistant_id": "asst_UQEBrB5fuKnzx472Sf5qWYdH",
            "content": [
                {
                    "text": {
                        "annotations": [],
                        "value": "In Python, there are two primary types of loops that allow you to execute a block of code repeatedly:\n\n1. `for` Loop: This loop is used for iterating over a sequence (which could be a list, tuple, dictionary, set, or string) with the ability to execute a block of code for each item in the sequence. An example of a `for` loop:\n\n```python\nfor item in [\"apple\", \"banana\", \"cherry\"]:\n    print(item)\n```\n\n2. `while` Loop: This loop repeatedly executes the target statement(s) as long as the given condition is true. The condition is evaluated before executing the body of the loop. Here's an example of a `while` loop:\n\n```python\ncount = 0\nwhile count &lt; 5:\n    print(count)\n    count += 1\n```\n\nPython also provides some loop control statements that can be used within these loops:\n\n- `break`: Terminates the loop and transfers execution to the statement immediately following the loop.\n- `continue`: Skips the remaining part of the loop for the current iteration and moves to the next iteration.\n- `else`: An optional clause associated with loops that is executed if the loop completes normally (i.e., not terminated by a `break` statement).\n\nHere's an example of using `break`, `continue`, and `else` with a `for` loop:\n\n```python\nfor num in range(2, 10):\n    if num % 2 == 0:\n        print(\"Found an even number\", num)\n        continue\n    print(\"Found a number\", num)\nelse:\n    print(\"The loop is completed without a break statement.\")\n```\n\nAnd an example using `while` loop:\n\n```python\ncount = 1\nwhile count &lt; 10:\n    if count == 5:\n        break\n    print(count)\n    count += 1\nelse:\n    print(\"Reached the value of 5 and stopped the loop with a break statement.\")\n```\n\nAdditionally, Python allows the use of nested loops (a loop inside another loop), which can be useful for more complex iteration scenarios. However, it's important to use them judiciously as they can lead to high computational complexity, especially with large datasets."
                    },
                    "type": "text"
                }
            ],
            "created_at": 1704457109,
            "file_ids": [],
            "metadata": {},
            "object": "thread.message",
            "role": "assistant",
            "run_id": "run_BLZnD60Vl7wePLUsdmUFR5zd",
            "thread_id": "thread_3fT59LTUrodHJPjBQYsIYm6F"
        },
        {
            "id": "msg_UDx8nMLlKxvriXAEBeW0AJ9f",
            "assistant_id": null,
            "content": [
                {
                    "text": {
                        "annotations": [],
                        "value": "what are different loops in python?"
                    },
                    "type": "text"
                }
            ],
            "created_at": 1704457107,
            "file_ids": [],
            "metadata": {},
            "object": "thread.message",
            "role": "user",
            "run_id": null,
            "thread_id": "thread_3fT59LTUrodHJPjBQYsIYm6F"
        }
    ],
    "object": "list",
    "first_id": "msg_vp29v6UA7Amr7isw4LdGNhcW",
    "last_id": "msg_UDx8nMLlKxvriXAEBeW0AJ9f",
    "has_more": false
}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb80" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> message <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> messages.data:</span>
<span id="cb80-2">    display(Markdown(message.content[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].text.value))</span>
<span id="cb80-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p>The reverse of the string “openaichatgpt” is “tpgtahcianepo”.</p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>********************************************************************************
********************************************************************************
********************************************************************************
********************************************************************************</code></pre>
</div>
<div class="cell-output cell-output-display">
<p>what’s the reverse of the string openaichatgpt?</p>
</div>
<div class="cell-output cell-output-display">
<p>In Python, there are two primary types of loops that allow you to execute a block of code repeatedly:</p>
<ol type="1">
<li><code>for</code> Loop: This loop is used for iterating over a sequence (which could be a list, tuple, dictionary, set, or string) with the ability to execute a block of code for each item in the sequence. An example of a <code>for</code> loop:</li>
</ol>
<div class="sourceCode" id="cb82" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> item <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"apple"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"banana"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cherry"</span>]:</span>
<span id="cb82-2">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(item)</span></code></pre></div>
<ol start="2" type="1">
<li><code>while</code> Loop: This loop repeatedly executes the target statement(s) as long as the given condition is true. The condition is evaluated before executing the body of the loop. Here’s an example of a <code>while</code> loop:</li>
</ol>
<div class="sourceCode" id="cb83" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1">count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb83-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>:</span>
<span id="cb83-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(count)</span>
<span id="cb83-4">    count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span></code></pre></div>
<p>Python also provides some loop control statements that can be used within these loops:</p>
<ul>
<li><code>break</code>: Terminates the loop and transfers execution to the statement immediately following the loop.</li>
<li><code>continue</code>: Skips the remaining part of the loop for the current iteration and moves to the next iteration.</li>
<li><code>else</code>: An optional clause associated with loops that is executed if the loop completes normally (i.e., not terminated by a <code>break</code> statement).</li>
</ul>
<p>Here’s an example of using <code>break</code>, <code>continue</code>, and <code>else</code> with a <code>for</code> loop:</p>
<div class="sourceCode" id="cb84" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> num <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>):</span>
<span id="cb84-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> num <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb84-3">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Found an even number"</span>, num)</span>
<span id="cb84-4">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">continue</span></span>
<span id="cb84-5">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Found a number"</span>, num)</span>
<span id="cb84-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb84-7">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The loop is completed without a break statement."</span>)</span></code></pre></div>
<p>And an example using <code>while</code> loop:</p>
<div class="sourceCode" id="cb85" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1">count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb85-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>:</span>
<span id="cb85-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>:</span>
<span id="cb85-4">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">break</span></span>
<span id="cb85-5">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(count)</span>
<span id="cb85-6">    count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb85-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb85-8">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reached the value of 5 and stopped the loop with a break statement."</span>)</span></code></pre></div>
<p>Additionally, Python allows the use of nested loops (a loop inside another loop), which can be useful for more complex iteration scenarios. However, it’s important to use them judiciously as they can lead to high computational complexity, especially with large datasets.</p>
</div>
<div class="cell-output cell-output-display">
<p>what are different loops in python?</p>
</div>
</div>
</section>
<section id="delete-the-assistant" class="level1">
<h1>Delete the Assistant</h1>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb86" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.beta.assistants.delete(assistant_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>assistant.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>)</span>
<span id="cb86-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(response)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AssistantDeleted(id='asst_UQEBrB5fuKnzx472Sf5qWYdH', deleted=True, object='assistant.deleted')</code></pre>
</div>
</div>



</section>

<div class="quarto-listing quarto-listing-container-default" id="listing-listing">
<div class="list quarto-listing-default">

</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div><a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>llm</category>
  <category>openai</category>
  <category>function calling</category>
  <category>openai assistants api</category>
  <guid>https://www.arunprakash.org/posts/master-the-art-of-function-calling-in-openai-assistants-api-a-comprehensive-guide-for-beginners/assistants_function_calling.html</guid>
  <pubDate>Thu, 04 Jan 2024 18:30:00 GMT</pubDate>
  <media:content url="https://www.arunprakash.org/posts/master-the-art-of-function-calling-in-openai-assistants-api-a-comprehensive-guide-for-beginners/assistant.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>MoodCast: Leveraging OpenAI Parallel Function Calling for Real-Time Weather-Based Music Playlists</title>
  <dc:creator>Arun Prakash</dc:creator>
  <link>https://www.arunprakash.org/posts/openai-parallel-function-calling-handson-tools/function_calling.html</link>
  <description><![CDATA[ 




<p>This blog post introduces “MoodCast,” a project that leverages OpenAI’s function calling feature to create real-time, weather-based music playlists. By integrating the OpenWeather and Spotify APIs, MoodCast demonstrates the power and flexibility of OpenAI’s function calling in a practical, engaging application.</p>
<p>OpenAI’s function calling feature allows developers to describe a function, and the model generates a JSON output containing arguments. This feature doesn’t call any function itself, but it generates the JSON that can be used to call a function from your code. This is a significant advancement as it allows developers to interact with AI in a more structured and systematic way, overcoming the challenges of dealing with unstructured data outputs.</p>
<p>In the context of MoodCast, this feature is used to interact with the OpenWeather and Spotify APIs, creating a unique blend of AI, weather data, and music. The project serves as a practical example of how OpenAI’s function calling can be used to solve complex problems and create innovative applications.</p>
<p>This blog post will focus on how to use function calling for OpenAI’s chat completion endpoints. It will provide a detailed guide on how to leverage this feature for your applications, with MoodCast serving as a real-world example. Whether you’re a seasoned developer or a beginner in the field of AI, this post aims to provide valuable insights into the potential of OpenAI’s function calling feature.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.arunprakash.org/posts/openai-parallel-function-calling-handson-tools/music.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Logo</figcaption>
</figure>
</div>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> json</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> dotenv <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> load_dotenv</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> openai</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> openai <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> OpenAI</span>
<span id="cb1-6">client <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> OpenAI()</span>
<span id="cb1-7">load_dotenv()</span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># openai key</span></span>
<span id="cb1-9">OPENAI_API_KEY <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OPENAI_API_KEY"</span>)</span>
<span id="cb1-10">openai.api_key <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> OPENAI_API_KEY</span>
<span id="cb1-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> IPython.display <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> display, Markdown</span></code></pre></div>
</div>
<p>First let’s check what openai chat completion say about current weather</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb2-2">    model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4-1106-preview"</span>,</span>
<span id="cb2-3">    messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb2-4">        {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"what's the current weather in Tokyo?"</span>}</span>
<span id="cb2-5">    ],</span>
<span id="cb2-6">    temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb2-7">    seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-8">)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(response)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ChatCompletion(id='chatcmpl-8dISDM1s7co80v8cx8z65WwUKkTLQ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="I'm sorry, but I cannot provide real-time data such as the current weather. To get the latest weather information for Tokyo or any other location, please check a reliable weather forecasting service or website like the Japan Meteorological Agency, Weather.com, or a weather app on your smartphone. These sources are regularly updated and can provide you with current conditions, forecasts, and any weather alerts that might be in effect.", role='assistant', function_call=None, tool_calls=None))], created=1704376421, model='gpt-4-1106-preview', object='chat.completion', system_fingerprint='fp_3905aa4f79', usage=CompletionUsage(completion_tokens=82, prompt_tokens=15, total_tokens=97))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">display(Markdown(response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].message.content))</span></code></pre></div>
<div class="cell-output cell-output-display">
<p>I’m sorry, but I cannot provide real-time data such as the current weather. To get the latest weather information for Tokyo or any other location, please check a reliable weather forecasting service or website like the Japan Meteorological Agency, Weather.com, or a weather app on your smartphone. These sources are regularly updated and can provide you with current conditions, forecasts, and any weather alerts that might be in effect.</p>
</div>
</div>
<p>As we can see openai does not have any information about the current weather. So we will use openweather api to get the current weather and then use openai chat completion to generate a response.</p>
<section id="live-data-using-openweathermap-api" class="level1">
<h1>Live Data using OpenWeatherMap API</h1>
<p>You can signup here to get your api key https://openweathermap.org/api</p>
<p>I have stored all the api key infomration in a .env file. You can create your own .env file and store your api key there.</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"></span>
<span id="cb6-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># .env file</span></span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OPENWEATHER_API_KEY</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>your_api_key</span>
<span id="cb6-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">OPENAI_API_KEY</span> = sk-key</span>
<span id="cb6-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">SPOTIFY_CLIENT_ID</span> = 4444633gfdggdggdgdgdg</span>
<span id="cb6-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">SPOTIFY_CLIENT_SECRET</span> = 23rtrrgrdgdr5353terg</span></code></pre></div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> requests</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> get_current_weather(city, api_key<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OPENWEATHER_API_KEY"</span>), unit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"metric"</span>):</span>
<span id="cb7-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Get the current weather for a given city using OpenWeather API."""</span></span>
<span id="cb7-5">    base_url <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"http://api.openweathermap.org/data/2.5/weather"</span></span>
<span id="cb7-6">    params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb7-7">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q"</span>: city,</span>
<span id="cb7-8">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"appid"</span>: api_key,</span>
<span id="cb7-9">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"units"</span>: unit</span>
<span id="cb7-10">    }</span>
<span id="cb7-11">    response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> requests.get(base_url, params<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>params)</span>
<span id="cb7-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> response.status_code <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>:</span>
<span id="cb7-13">        data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> response.json()</span>
<span id="cb7-14">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#print(data)</span></span>
<span id="cb7-15">        weather <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb7-16">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"location"</span>: data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"name"</span>],</span>
<span id="cb7-17">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"temperature"</span>: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"main"</span>][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"temp"</span>]),</span>
<span id="cb7-18">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rain"</span>: data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weather"</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"main"</span>],</span>
<span id="cb7-19">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"unit"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Celsius"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> unit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"metric"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fahrenheit"</span></span>
<span id="cb7-20">        }</span>
<span id="cb7-21">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> json.dumps(weather)</span>
<span id="cb7-22">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb7-23">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"location"</span>: city, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"temperature"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"unknown"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"unit"</span>: unit, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rain"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"unknown"</span>}</span>
<span id="cb7-24"></span>
<span id="cb7-25">api_key <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OPENWEATHER_API_KEY"</span>)</span>
<span id="cb7-26">weather_info <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> get_current_weather(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nagercoil"</span>)</span>
<span id="cb7-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(weather_info)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{"location": "Nagercoil", "temperature": 26, "rain": "Clouds", "unit": "Celsius"}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span>(weather_info)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>str</code></pre>
</div>
</div>
</section>
<section id="spotify-music" class="level1">
<h1>Spotify Music</h1>
<p>We can create an application on spotify and get the client id and client secret. We can use these credentials to get the access token and then use the access token to get the current weather based playlist.</p>
<p>https://developer.spotify.com/</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># !pip3 install spotipy</span></span></code></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> spotipy</span>
<span id="cb12-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> spotipy.oauth2 <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SpotifyClientCredentials</span>
<span id="cb12-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb12-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> IPython.display <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image, display, Audio</span>
<span id="cb12-5"></span>
<span id="cb12-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> search_song(song_name):</span>
<span id="cb12-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set up your Spotify credentials</span></span>
<span id="cb12-8">    client_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SPOTIFY_CLIENT_ID"</span>)</span>
<span id="cb12-9">    client_secret <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SPOTIFY_CLIENT_SECRET"</span>)</span>
<span id="cb12-10"></span>
<span id="cb12-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Authenticate with Spotify</span></span>
<span id="cb12-12">    client_credentials_manager <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SpotifyClientCredentials(client_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>client_id, client_secret<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>client_secret)</span>
<span id="cb12-13">    sp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> spotipy.Spotify(client_credentials_manager<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>client_credentials_manager)</span>
<span id="cb12-14"></span>
<span id="cb12-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Search for the song</span></span>
<span id="cb12-16">    results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sp.search(q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>song_name, limit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'track'</span>)</span>
<span id="cb12-17">    tracks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tracks'</span>][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'items'</span>]</span>
<span id="cb12-18"></span>
<span id="cb12-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the first result</span></span>
<span id="cb12-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> tracks:</span>
<span id="cb12-21">        track <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tracks[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb12-22">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> json.dumps({</span>
<span id="cb12-23">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"song"</span>: track[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'name'</span>],</span>
<span id="cb12-24">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"artist"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">', '</span>.join(artist[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'name'</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> artist <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> track[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'artists'</span>]),</span>
<span id="cb12-25">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"album"</span>: track[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'album'</span>][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'name'</span>],</span>
<span id="cb12-26">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"album_cover_url"</span>: track[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'album'</span>][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'images'</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'url'</span>],</span>
<span id="cb12-27">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"preview_url"</span>: track[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'preview_url'</span>]</span>
<span id="cb12-28">        })</span>
<span id="cb12-29"></span>
<span id="cb12-30">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb12-31">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No song found"</span></span>
<span id="cb12-32"></span>
<span id="cb12-33">song_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Appadi podu"</span></span>
<span id="cb12-34">song_details <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> search_song(song_name)</span>
<span id="cb12-35"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(song_details)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{"song": "Appadi Podu", "artist": "Vidyasagar, Krishnakumar Kunnath, Anuradha Sriram", "album": "Ghilli (Original Motion Picture Soundtrack)", "album_cover_url": "https://i.scdn.co/image/ab67616d0000b2737bbef42d34fd25b14b2a54ea", "preview_url": "https://p.scdn.co/mp3-preview/df03b78315eaa0c7e20d66ea17dcf1a5fa4e6e3e?cid=706a549bcf8a4575b6e1dd3fc24f5f95"}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display song details</span></span>
<span id="cb14-2">song_details_json <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.loads(song_details)</span>
<span id="cb14-3">display(Image(url<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>song_details_json[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"album_cover_url"</span>], width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>), )</span>
<span id="cb14-4">display(Markdown(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"[</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>song_details_json[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'song'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> by </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>song_details_json[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'artist'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">](</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>song_details_json[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'preview_url'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>))</span>
<span id="cb14-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(song_details_json[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"album"</span>])</span></code></pre></div>
<div class="cell-output cell-output-display">
<img src="https://www.arunprakash.org/posts/openai-parallel-function-calling-handson-tools/https:/i.scdn.co/image/ab67616d0000b2737bbef42d34fd25b14b2a54ea" width="100">
</div>
<div class="cell-output cell-output-display">
<p><a href="https://p.scdn.co/mp3-preview/df03b78315eaa0c7e20d66ea17dcf1a5fa4e6e3e?cid=706a549bcf8a4575b6e1dd3fc24f5f95">Appadi Podu by Vidyasagar, Krishnakumar Kunnath, Anuradha Sriram</a></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Ghilli (Original Motion Picture Soundtrack)</code></pre>
</div>
</div>
</section>
<section id="creating-tools" class="level1">
<h1>Creating Tools</h1>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">available_tools <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb16-2">        {</span>
<span id="cb16-3">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"function"</span>,</span>
<span id="cb16-4">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"function"</span>: {</span>
<span id="cb16-5">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"name"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"get_current_weather"</span>,</span>
<span id="cb16-6">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"description"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Get the current weather in a given location, use farhenheit"</span>,</span>
<span id="cb16-7">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"parameters"</span>: {</span>
<span id="cb16-8">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"object"</span>,</span>
<span id="cb16-9">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"properties"</span>: {</span>
<span id="cb16-10">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"city"</span>: {</span>
<span id="cb16-11">                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"string"</span>,</span>
<span id="cb16-12">                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"description"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The city to get the weather for"</span>,</span>
<span id="cb16-13">                        },</span>
<span id="cb16-14">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"unit"</span>: {</span>
<span id="cb16-15">                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"string"</span>,</span>
<span id="cb16-16">                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"description"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The unit to use for the temperature, metric is default"</span>,</span>
<span id="cb16-17">                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"enum"</span>: [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"metric"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"imperial"</span>],</span>
<span id="cb16-18">                        }</span>
<span id="cb16-19">                    },</span>
<span id="cb16-20">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"required"</span>: [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"city"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"unit"</span>],</span>
<span id="cb16-21">                },</span>
<span id="cb16-22">            },</span>
<span id="cb16-23">        },</span>
<span id="cb16-24">        {</span>
<span id="cb16-25">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"function"</span>,</span>
<span id="cb16-26">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"function"</span>: {</span>
<span id="cb16-27">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"name"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"search_song"</span>,</span>
<span id="cb16-28">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"description"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Search for a song on Spotify and display its details including the artist, album, album cover, and a preview link if available"</span>,</span>
<span id="cb16-29">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"parameters"</span>: {</span>
<span id="cb16-30">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"object"</span>,</span>
<span id="cb16-31">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"properties"</span>: {</span>
<span id="cb16-32">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"song_name"</span>: {</span>
<span id="cb16-33">                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"string"</span>,</span>
<span id="cb16-34">                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"description"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The name of the song to search for"</span>,</span>
<span id="cb16-35">                        }</span>
<span id="cb16-36">                    },</span>
<span id="cb16-37">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"required"</span>: [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"song_name"</span>],</span>
<span id="cb16-38">                }</span>
<span id="cb16-39">            }</span>
<span id="cb16-40">        }</span>
<span id="cb16-41">    ]</span></code></pre></div>
</div>
<p>In the MoodCast project, JSON is utilized to define tools for function descriptions, which are essential for the OpenAI function calling feature. This feature enables the AI to generate structured data outputs, specifically JSON objects containing arguments for functions described in the API call. For instance, the <code>get_current_weather</code> function is defined to fetch current weather data for a specified city, while the <code>search_song</code> function is designed to search for songs on Spotify. These function descriptions are crucial as they guide the AI in generating the correct JSON output that can be used to call functions from the code, thereby facilitating the integration with OpenWeather and Spotify APIs.</p>
<p>To effectively use function calling with OpenAI, developers must clearly define their functions, including the name, description, and parameters, in a JSON format. This structured approach allows the AI to understand the context and generate the appropriate JSON output. The OpenAI API documentation provides guidelines on how to describe functions for function calling, emphasizing the importance of a clear and detailed function schema to ensure accurate and useful responses from the AI model.</p>
<p>For MoodCast, this means that by defining functions like <code>get_current_weather</code> and <code>search_song</code> with precise parameters and descriptions, the AI can produce JSON outputs that correspond to these functions. These outputs can then be used to make API calls to OpenWeather and Spotify, respectively, to create a music playlist that matches the current weather conditions, showcasing a practical application of OpenAI’s function calling capability in a real-world project.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">city <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nagercoil"</span></span></code></pre></div>
</div>
</section>
<section id="openai-chat-completion-function-calling" class="level1">
<h1>Openai Chat Completion Function Calling</h1>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">messages <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb18-2">    {</span>
<span id="cb18-3">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>,</span>
<span id="cb18-4">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A Song Suggestions Assistant based on local weather in metric and local language"</span></span>
<span id="cb18-5">    },</span>
<span id="cb18-6">    {</span>
<span id="cb18-7">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>,</span>
<span id="cb18-8">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"""I am in </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>city<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, suggest 5 songs based on their current weather and their local language</span></span>
<span id="cb18-9"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">        and display their album details such as album cover, artist, and preview link.</span></span>
<span id="cb18-10"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">        return a json object with keys as song, artist, album, album_cover_url, and preview_url and reason</span></span>
<span id="cb18-11"></span>
<span id="cb18-12"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">        key as song_suggestions and value as a list of json objects with keys as song, artist, album, album_cover_url, preview_url, and reason</span></span>
<span id="cb18-13"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb18-14">    }</span>
<span id="cb18-15">]</span>
<span id="cb18-16"></span>
<span id="cb18-17">tools <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> available_tools</span>
<span id="cb18-18">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb18-19">    model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4-1106-preview"</span>,</span>
<span id="cb18-20">    messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>messages,</span>
<span id="cb18-21">    tools<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tools,</span>
<span id="cb18-22">    tool_choice<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"auto"</span>, </span>
<span id="cb18-23">    temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span></span>
<span id="cb18-24">)</span>
<span id="cb18-25">response_message <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].message</span>
<span id="cb18-26">tool_calls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> response_message.tool_calls</span></code></pre></div>
</div>
<p>We can also force the model to use some particular function by using <code>tool_choice = {"type": "function", "function": {"name": "my_function"}}</code> forces the model to call that function.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1">response</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>ChatCompletion(id='chatcmpl-8dISaihzl1Q2k7S09VBau44EwlMMv', choices=[Choice(finish_reason='tool_calls', index=0, logprobs=None, message=ChatCompletionMessage(content=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_FmoMsWB1hklh6GvT9QmrTX3k', function=Function(arguments='{\n  "city": "Nagercoil",\n  "unit": "metric"\n}', name='get_current_weather'), type='function')]))], created=1704376444, model='gpt-4-1106-preview', object='chat.completion', system_fingerprint='fp_3905aa4f79', usage=CompletionUsage(completion_tokens=28, prompt_tokens=249, total_tokens=277))</code></pre>
</div>
</div>
<p>As when openai gonna use function calling, you can see the <code>finish_reason</code> in the response, which indicates we have to call the function with the given arguments and get the results, and pass it to the model again</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1">response_message</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>ChatCompletionMessage(content=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_FmoMsWB1hklh6GvT9QmrTX3k', function=Function(arguments='{\n  "city": "Nagercoil",\n  "unit": "metric"\n}', name='get_current_weather'), type='function')])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">response_message.tool_calls</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>[ChatCompletionMessageToolCall(id='call_FmoMsWB1hklh6GvT9QmrTX3k', function=Function(arguments='{\n  "city": "Nagercoil",\n  "unit": "metric"\n}', name='get_current_weather'), type='function')]</code></pre>
</div>
</div>
<section id="tool-calls" class="level3">
<h3 class="anchored" data-anchor-id="tool-calls">Tool Calls</h3>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> tool <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> tool_calls:</span>
<span id="cb25-2">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Tool ID: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>tool<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb25-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Call the function: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>tool<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>function<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb25-4">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Parameters: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>tool<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>function<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>arguments<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tool ID: call_FmoMsWB1hklh6GvT9QmrTX3k
Call the function: get_current_weather
Parameters: {
  "city": "Nagercoil",
  "unit": "metric"
}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">function_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tool_calls[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].function.name</span>
<span id="cb27-2">function_args <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tool_calls[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].function.arguments</span>
<span id="cb27-3"></span>
<span id="cb27-4">function_name, function_args</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>('get_current_weather', '{\n  "city": "Nagercoil",\n  "unit": "metric"\n}')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">function_args <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.loads(function_args)</span>
<span id="cb29-2">function_args</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>{'city': 'Nagercoil', 'unit': 'metric'}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1">available_functions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb31-2">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"get_current_weather"</span>: get_current_weather,</span>
<span id="cb31-3">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"search_song"</span>: search_song,</span>
<span id="cb31-4">    }</span></code></pre></div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1">function_response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> available_functions[function_name](<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>function_args)</span>
<span id="cb32-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(function_response)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{"location": "Nagercoil", "temperature": 26, "rain": "Clouds", "unit": "Celsius"}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1">messages</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>[{'role': 'system',
  'content': 'A Song Suggestions Assistant based on local weather in metric and local language'},
 {'role': 'user',
  'content': 'I am in Nagercoil, suggest 5 songs based on their current weather and their local language\n        and display their album details such as album cover, artist, and preview link.\n        return a json object with keys as song, artist, album, album_cover_url, and preview_url and reason\n\n        key as song_suggestions and value as a list of json objects with keys as song, artist, album, album_cover_url, preview_url, and reason\n        '}]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1">messages.append(response_message)</span>
<span id="cb36-2">messages</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>[{'role': 'system',
  'content': 'A Song Suggestions Assistant based on local weather in metric and local language'},
 {'role': 'user',
  'content': 'I am in Nagercoil, suggest 5 songs based on their current weather and their local language\n        and display their album details such as album cover, artist, and preview link.\n        return a json object with keys as song, artist, album, album_cover_url, and preview_url and reason\n\n        key as song_suggestions and value as a list of json objects with keys as song, artist, album, album_cover_url, preview_url, and reason\n        '},
 ChatCompletionMessage(content=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_FmoMsWB1hklh6GvT9QmrTX3k', function=Function(arguments='{\n  "city": "Nagercoil",\n  "unit": "metric"\n}', name='get_current_weather'), type='function')])]</code></pre>
</div>
</div>
</section>
<section id="appending-tool-call-responses-to-the-message-history" class="level3">
<h3 class="anchored" data-anchor-id="appending-tool-call-responses-to-the-message-history">Appending Tool Call Responses to the Message History</h3>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1">messages.append(</span>
<span id="cb38-2">                {</span>
<span id="cb38-3">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tool_call_id"</span>: tool_calls[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>,</span>
<span id="cb38-4">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tool"</span>,</span>
<span id="cb38-5">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"name"</span>: function_name,</span>
<span id="cb38-6">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: function_response,</span>
<span id="cb38-7">                }</span>
<span id="cb38-8">            )</span>
<span id="cb38-9">messages</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>[{'role': 'system',
  'content': 'A Song Suggestions Assistant based on local weather in metric and local language'},
 {'role': 'user',
  'content': 'I am in Nagercoil, suggest 5 songs based on their current weather and their local language\n        and display their album details such as album cover, artist, and preview link.\n        return a json object with keys as song, artist, album, album_cover_url, and preview_url and reason\n\n        key as song_suggestions and value as a list of json objects with keys as song, artist, album, album_cover_url, preview_url, and reason\n        '},
 ChatCompletionMessage(content=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_FmoMsWB1hklh6GvT9QmrTX3k', function=Function(arguments='{\n  "city": "Nagercoil",\n  "unit": "metric"\n}', name='get_current_weather'), type='function')]),
 {'tool_call_id': 'call_FmoMsWB1hklh6GvT9QmrTX3k',
  'role': 'tool',
  'name': 'get_current_weather',
  'content': '{"location": "Nagercoil", "temperature": 26, "rain": "Clouds", "unit": "Celsius"}'}]</code></pre>
</div>
</div>
</section>
<section id="second-call-to-get-song-details" class="level3">
<h3 class="anchored" data-anchor-id="second-call-to-get-song-details">Second Call to get Song Details</h3>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1">second_response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb40-2">            model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4-1106-preview"</span>,</span>
<span id="cb40-3">            messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>messages,</span>
<span id="cb40-4">            tools<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>available_tools,</span>
<span id="cb40-5">            tool_choice<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"auto"</span>,</span>
<span id="cb40-6">        )</span>
<span id="cb40-7"></span>
<span id="cb40-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(second_response)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ChatCompletion(id='chatcmpl-8dISdx8ctxPgd8bD3BDnYCEOmialh', choices=[Choice(finish_reason='tool_calls', index=0, logprobs=None, message=ChatCompletionMessage(content='The current weather in Nagercoil is 26 degrees Celsius with clouds. Based on this weather, I will suggest songs that convey a sense of peace, comfort, and perhaps contemplation, which is often associated with cloudy days. The local language in Nagercoil is Tamil, so I will be selecting Tamil songs that match the weather mood.\n\nI will now search for suitable Tamil songs and provide their details. Please wait a moment while I process this information.', role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_UEVy6FVIVy3V2kwcD36tDRvv', function=Function(arguments='{"song_name": "Mazhai Kuruvi"}', name='search_song'), type='function'), ChatCompletionMessageToolCall(id='call_XKVJrqRjh1aafYldWeBWNnG2', function=Function(arguments='{"song_name": "Nenjukulle"}', name='search_song'), type='function'), ChatCompletionMessageToolCall(id='call_I5Gnz9hvK1JuX8cSPFH14aL8', function=Function(arguments='{"song_name": "Uyire Uyire"}', name='search_song'), type='function'), ChatCompletionMessageToolCall(id='call_KrUYtZqTDopUCua3dRbrOC9B', function=Function(arguments='{"song_name": "Vaseegara"}', name='search_song'), type='function'), ChatCompletionMessageToolCall(id='call_w724Il0i6dFCDLG4l4OmPY4e', function=Function(arguments='{"song_name": "Aaromale"}', name='search_song'), type='function')]))], created=1704376447, model='gpt-4-1106-preview', object='chat.completion', system_fingerprint='fp_c6efb4aa39', usage=CompletionUsage(completion_tokens=279, prompt_tokens=307, total_tokens=586))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1">display(Markdown(second_response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].message.content))</span></code></pre></div>
<div class="cell-output cell-output-display">
<p>The current weather in Nagercoil is 26 degrees Celsius with clouds. Based on this weather, I will suggest songs that convey a sense of peace, comfort, and perhaps contemplation, which is often associated with cloudy days. The local language in Nagercoil is Tamil, so I will be selecting Tamil songs that match the weather mood.</p>
<p>I will now search for suitable Tamil songs and provide their details. Please wait a moment while I process this information.</p>
</div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1">tool_calls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> second_response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].message.tool_calls</span></code></pre></div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> tool <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> tool_calls:</span>
<span id="cb44-2">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Tool ID: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>tool<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb44-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Call the function: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>tool<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>function<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb44-4">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Parameters: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>tool<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>function<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>arguments<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tool ID: call_UEVy6FVIVy3V2kwcD36tDRvv
Call the function: search_song
Parameters: {"song_name": "Mazhai Kuruvi"}
Tool ID: call_XKVJrqRjh1aafYldWeBWNnG2
Call the function: search_song
Parameters: {"song_name": "Nenjukulle"}
Tool ID: call_I5Gnz9hvK1JuX8cSPFH14aL8
Call the function: search_song
Parameters: {"song_name": "Uyire Uyire"}
Tool ID: call_KrUYtZqTDopUCua3dRbrOC9B
Call the function: search_song
Parameters: {"song_name": "Vaseegara"}
Tool ID: call_w724Il0i6dFCDLG4l4OmPY4e
Call the function: search_song
Parameters: {"song_name": "Aaromale"}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1">messages.append(second_response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].message)</span></code></pre></div>
</div>
</section>
<section id="call-the-function-and-append-the-results-to-the-message-history" class="level3">
<h3 class="anchored" data-anchor-id="call-the-function-and-append-the-results-to-the-message-history">Call the function and append the results to the message history</h3>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> tool <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> tool_calls:</span>
<span id="cb47-2">    function_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tool.function.name</span>
<span id="cb47-3">    function_args <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.loads(tool.function.arguments)</span>
<span id="cb47-4">    function_response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> available_functions[function_name](<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>function_args)</span>
<span id="cb47-5"></span>
<span id="cb47-6">    messages.append(</span>
<span id="cb47-7">        {</span>
<span id="cb47-8">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tool_call_id"</span>: tool.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>,</span>
<span id="cb47-9">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tool"</span>,</span>
<span id="cb47-10">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"name"</span>: function_name,</span>
<span id="cb47-11">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: function_response,</span>
<span id="cb47-12">        }</span>
<span id="cb47-13">    )</span>
<span id="cb47-14">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(function_response)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{"song": "Mazhai Kuruvi", "artist": "A.R. Rahman", "album": "Chekka Chivantha Vaanam (Original Motion Picture Soundtrack)", "album_cover_url": "https://i.scdn.co/image/ab67616d0000b2735234d8419de0ffdccc8c27a7", "preview_url": "https://p.scdn.co/mp3-preview/771e747c73fc6cd5914a4e447f9daf3bd74e38a5?cid=706a549bcf8a4575b6e1dd3fc24f5f95"}
{"song": "Nenjukulle", "artist": "Ashbel Peter, Theertha", "album": "Nenjukulle", "album_cover_url": "https://i.scdn.co/image/ab67616d0000b273d3d692e38621d741606588e7", "preview_url": "https://p.scdn.co/mp3-preview/d48678e7eef2bebd5a099d2b6b1ff5dd299ff102?cid=706a549bcf8a4575b6e1dd3fc24f5f95"}
{"song": "Uyire Uyire", "artist": "Saagar, Na.Muthukumar", "album": "Santhosh Subramaniyam (Original Motion Picture Soundtrack)", "album_cover_url": "https://i.scdn.co/image/ab67616d0000b2738b895bdb8ccefee6ab65114b", "preview_url": "https://p.scdn.co/mp3-preview/c4e812236497ce1f72610be2af10740ad6ecead6?cid=706a549bcf8a4575b6e1dd3fc24f5f95"}
{"song": "Vaseegara", "artist": "Bombay Jayashri", "album": "Minnalae (Original Motion Picture Soundtrack)", "album_cover_url": "https://i.scdn.co/image/ab67616d0000b273102f02fa7e7ded2bc5f65653", "preview_url": "https://p.scdn.co/mp3-preview/2db5c05f48a7214b56c8eed843103ae3f241e00e?cid=706a549bcf8a4575b6e1dd3fc24f5f95"}
{"song": "Aaromale", "artist": "A.R. Rahman, Alphons Joseph", "album": "Vinnathaandi Varuvaayaa (Original Motion Picture Soundtrack)", "album_cover_url": "https://i.scdn.co/image/ab67616d0000b27397838a7eeb5f477cfc6707a5", "preview_url": "https://p.scdn.co/mp3-preview/ed07e1b3e3fe14b55e29c10c5413dd9e04fbe1e5?cid=706a549bcf8a4575b6e1dd3fc24f5f95"}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1">messages</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>[{'role': 'system',
  'content': 'A Song Suggestions Assistant based on local weather in metric and local language'},
 {'role': 'user',
  'content': 'I am in Nagercoil, suggest 5 songs based on their current weather and their local language\n        and display their album details such as album cover, artist, and preview link.\n        return a json object with keys as song, artist, album, album_cover_url, and preview_url and reason\n\n        key as song_suggestions and value as a list of json objects with keys as song, artist, album, album_cover_url, preview_url, and reason\n        '},
 ChatCompletionMessage(content=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_FmoMsWB1hklh6GvT9QmrTX3k', function=Function(arguments='{\n  "city": "Nagercoil",\n  "unit": "metric"\n}', name='get_current_weather'), type='function')]),
 {'tool_call_id': 'call_FmoMsWB1hklh6GvT9QmrTX3k',
  'role': 'tool',
  'name': 'get_current_weather',
  'content': '{"location": "Nagercoil", "temperature": 26, "rain": "Clouds", "unit": "Celsius"}'},
 ChatCompletionMessage(content='The current weather in Nagercoil is 26 degrees Celsius with clouds. Based on this weather, I will suggest songs that convey a sense of peace, comfort, and perhaps contemplation, which is often associated with cloudy days. The local language in Nagercoil is Tamil, so I will be selecting Tamil songs that match the weather mood.\n\nI will now search for suitable Tamil songs and provide their details. Please wait a moment while I process this information.', role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_UEVy6FVIVy3V2kwcD36tDRvv', function=Function(arguments='{"song_name": "Mazhai Kuruvi"}', name='search_song'), type='function'), ChatCompletionMessageToolCall(id='call_XKVJrqRjh1aafYldWeBWNnG2', function=Function(arguments='{"song_name": "Nenjukulle"}', name='search_song'), type='function'), ChatCompletionMessageToolCall(id='call_I5Gnz9hvK1JuX8cSPFH14aL8', function=Function(arguments='{"song_name": "Uyire Uyire"}', name='search_song'), type='function'), ChatCompletionMessageToolCall(id='call_KrUYtZqTDopUCua3dRbrOC9B', function=Function(arguments='{"song_name": "Vaseegara"}', name='search_song'), type='function'), ChatCompletionMessageToolCall(id='call_w724Il0i6dFCDLG4l4OmPY4e', function=Function(arguments='{"song_name": "Aaromale"}', name='search_song'), type='function')]),
 {'tool_call_id': 'call_UEVy6FVIVy3V2kwcD36tDRvv',
  'role': 'tool',
  'name': 'search_song',
  'content': '{"song": "Mazhai Kuruvi", "artist": "A.R. Rahman", "album": "Chekka Chivantha Vaanam (Original Motion Picture Soundtrack)", "album_cover_url": "https://i.scdn.co/image/ab67616d0000b2735234d8419de0ffdccc8c27a7", "preview_url": "https://p.scdn.co/mp3-preview/771e747c73fc6cd5914a4e447f9daf3bd74e38a5?cid=706a549bcf8a4575b6e1dd3fc24f5f95"}'},
 {'tool_call_id': 'call_XKVJrqRjh1aafYldWeBWNnG2',
  'role': 'tool',
  'name': 'search_song',
  'content': '{"song": "Nenjukulle", "artist": "Ashbel Peter, Theertha", "album": "Nenjukulle", "album_cover_url": "https://i.scdn.co/image/ab67616d0000b273d3d692e38621d741606588e7", "preview_url": "https://p.scdn.co/mp3-preview/d48678e7eef2bebd5a099d2b6b1ff5dd299ff102?cid=706a549bcf8a4575b6e1dd3fc24f5f95"}'},
 {'tool_call_id': 'call_I5Gnz9hvK1JuX8cSPFH14aL8',
  'role': 'tool',
  'name': 'search_song',
  'content': '{"song": "Uyire Uyire", "artist": "Saagar, Na.Muthukumar", "album": "Santhosh Subramaniyam (Original Motion Picture Soundtrack)", "album_cover_url": "https://i.scdn.co/image/ab67616d0000b2738b895bdb8ccefee6ab65114b", "preview_url": "https://p.scdn.co/mp3-preview/c4e812236497ce1f72610be2af10740ad6ecead6?cid=706a549bcf8a4575b6e1dd3fc24f5f95"}'},
 {'tool_call_id': 'call_KrUYtZqTDopUCua3dRbrOC9B',
  'role': 'tool',
  'name': 'search_song',
  'content': '{"song": "Vaseegara", "artist": "Bombay Jayashri", "album": "Minnalae (Original Motion Picture Soundtrack)", "album_cover_url": "https://i.scdn.co/image/ab67616d0000b273102f02fa7e7ded2bc5f65653", "preview_url": "https://p.scdn.co/mp3-preview/2db5c05f48a7214b56c8eed843103ae3f241e00e?cid=706a549bcf8a4575b6e1dd3fc24f5f95"}'},
 {'tool_call_id': 'call_w724Il0i6dFCDLG4l4OmPY4e',
  'role': 'tool',
  'name': 'search_song',
  'content': '{"song": "Aaromale", "artist": "A.R. Rahman, Alphons Joseph", "album": "Vinnathaandi Varuvaayaa (Original Motion Picture Soundtrack)", "album_cover_url": "https://i.scdn.co/image/ab67616d0000b27397838a7eeb5f477cfc6707a5", "preview_url": "https://p.scdn.co/mp3-preview/ed07e1b3e3fe14b55e29c10c5413dd9e04fbe1e5?cid=706a549bcf8a4575b6e1dd3fc24f5f95"}'}]</code></pre>
</div>
</div>
</section>
<section id="third-response-to-get-the-final-results-as-json-object" class="level3">
<h3 class="anchored" data-anchor-id="third-response-to-get-the-final-results-as-json-object">Third Response to get the final results as JSON Object</h3>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1">third_response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb51-2">                model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4-1106-preview"</span>,</span>
<span id="cb51-3">                messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>messages,</span>
<span id="cb51-4">                response_format<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"json_object"</span>}</span>
<span id="cb51-5">            )</span></code></pre></div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1">third_response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].message.content</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>'\n{\n    "song_suggestions": [\n        {\n            "song": "Mazhai Kuruvi",\n            "artist": "A.R. Rahman",\n            "album": "Chekka Chivantha Vaanam (Original Motion Picture Soundtrack)",\n            "album_cover_url": "https://i.scdn.co/image/ab67616d0000b2735234d8419de0ffdccc8c27a7",\n            "preview_url": "https://p.scdn.co/mp3-preview/771e747c73fc6cd5914a4e447f9daf3bd74e38a5?cid=706a549bcf8a4575b6e1dd3fc24f5f95",\n            "reason": "This song has a soothing melody that resonates well with a cloudy and peaceful atmosphere."\n        },\n        {\n            "song": "Nenjukulle",\n            "artist": "A.R. Rahman, Shakthisree Gopalan",\n            "album": "Kadal (Original Motion Picture Soundtrack)",\n            "album_cover_url": "https://i.scdn.co/image/ab67616d0000b273d3d692e38621d741606588e7",\n            "preview_url": "https://p.scdn.co/mp3-preview/d48678e7eef2bebd5a099d2b6b1ff5dd299ff102?cid=706a549bcf8a4575b6e1dd3fc24f5f95",\n            "reason": "The backdrop of the ocean in the lyrics, combined with the cloudy weather theme, provides a tranquil listening experience."\n        },\n        {\n            "song": "Uyire Uyire",\n            "artist": "Hariharan, Bombay Jayashri",\n            "album": "Bombay (Original Motion Picture Soundtrack)",\n            "album_cover_url": "https://i.scdn.co/image/ab67616d0000b2738b895bdb8ccefee6ab65114b",\n            "preview_url": "https://p.scdn.co/mp3-preview/c4e812236497ce1f72610be2af10740ad6ecead6?cid=706a549bcf8a4575b6e1dd3fc24f5f95",\n            "reason": "Its lyrical depth and the warmth of the composition blend nicely with the introspective mood of a cloudy day."\n        },\n        {\n            "song": "Vaseegara",\n            "artist": "Bombay Jayashri",\n            "album": "Minnalae (Original Motion Picture Soundtrack)",\n            "album_cover_url": "https://i.scdn.co/image/ab67616d0000b273102f02fa7e7ded2bc5f65653",\n            "preview_url": "https://p.scdn.co/mp3-preview/2db5c05f48a7214b56c8eed843103ae3f241e00e?cid=706a549bcf8a4575b6e1dd3fc24f5f95",\n            "reason": "This classic love ballad with its serene mood is perfect for a cloudy day lounging."\n        },\n        {\n            "song": "Aaromale",\n            "artist": "Alphons Joseph",\n            "album": "Vinnaithaandi Varuvaayaa (Original Motion Picture Soundtrack)",\n            "album_cover_url": "https://i.scdn.co/image/ab67616d0000b27397838a7eeb5f477cfc6707a5",\n            "preview_url": "https://p.scdn.co/mp3-preview/ed07e1b3e3fe14b55e29c10c5413dd9e04fbe1e5?cid=706a549bcf8a4575b6e1dd3fc24f5f95",\n            "reason": "A refreshing song that\'s well-suited for when the clouds are out and you crave an uplifting atmosphere."\n        }\n    ]\n}'</code></pre>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display song details</span></span>
<span id="cb54-2">song_details_json <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.loads(third_response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].message.content)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1">song_details_json</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>{'song_suggestions': [{'song': 'Mazhai Kuruvi',
   'artist': 'A.R. Rahman',
   'album': 'Chekka Chivantha Vaanam (Original Motion Picture Soundtrack)',
   'album_cover_url': 'https://i.scdn.co/image/ab67616d0000b2735234d8419de0ffdccc8c27a7',
   'preview_url': 'https://p.scdn.co/mp3-preview/771e747c73fc6cd5914a4e447f9daf3bd74e38a5?cid=706a549bcf8a4575b6e1dd3fc24f5f95',
   'reason': 'This song has a soothing melody that resonates well with a cloudy and peaceful atmosphere.'},
  {'song': 'Nenjukulle',
   'artist': 'A.R. Rahman, Shakthisree Gopalan',
   'album': 'Kadal (Original Motion Picture Soundtrack)',
   'album_cover_url': 'https://i.scdn.co/image/ab67616d0000b273d3d692e38621d741606588e7',
   'preview_url': 'https://p.scdn.co/mp3-preview/d48678e7eef2bebd5a099d2b6b1ff5dd299ff102?cid=706a549bcf8a4575b6e1dd3fc24f5f95',
   'reason': 'The backdrop of the ocean in the lyrics, combined with the cloudy weather theme, provides a tranquil listening experience.'},
  {'song': 'Uyire Uyire',
   'artist': 'Hariharan, Bombay Jayashri',
   'album': 'Bombay (Original Motion Picture Soundtrack)',
   'album_cover_url': 'https://i.scdn.co/image/ab67616d0000b2738b895bdb8ccefee6ab65114b',
   'preview_url': 'https://p.scdn.co/mp3-preview/c4e812236497ce1f72610be2af10740ad6ecead6?cid=706a549bcf8a4575b6e1dd3fc24f5f95',
   'reason': 'Its lyrical depth and the warmth of the composition blend nicely with the introspective mood of a cloudy day.'},
  {'song': 'Vaseegara',
   'artist': 'Bombay Jayashri',
   'album': 'Minnalae (Original Motion Picture Soundtrack)',
   'album_cover_url': 'https://i.scdn.co/image/ab67616d0000b273102f02fa7e7ded2bc5f65653',
   'preview_url': 'https://p.scdn.co/mp3-preview/2db5c05f48a7214b56c8eed843103ae3f241e00e?cid=706a549bcf8a4575b6e1dd3fc24f5f95',
   'reason': 'This classic love ballad with its serene mood is perfect for a cloudy day lounging.'},
  {'song': 'Aaromale',
   'artist': 'Alphons Joseph',
   'album': 'Vinnaithaandi Varuvaayaa (Original Motion Picture Soundtrack)',
   'album_cover_url': 'https://i.scdn.co/image/ab67616d0000b27397838a7eeb5f477cfc6707a5',
   'preview_url': 'https://p.scdn.co/mp3-preview/ed07e1b3e3fe14b55e29c10c5413dd9e04fbe1e5?cid=706a549bcf8a4575b6e1dd3fc24f5f95',
   'reason': "A refreshing song that's well-suited for when the clouds are out and you crave an uplifting atmosphere."}]}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span>(song_details_json)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>dict</code></pre>
</div>
</div>
</section>
</section>
<section id="display-model-outputs" class="level1">
<h1>Display Model Outputs</h1>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Displaying each song suggestion with its details</span></span>
<span id="cb59-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> song <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> song_details_json[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"song_suggestions"</span>]:</span>
<span id="cb59-3">    display(Markdown(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"### </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>song[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'song'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>))</span>
<span id="cb59-4">    display(Markdown(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"**Artist:** </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>song[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'artist'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>))</span>
<span id="cb59-5">    display(Markdown(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"**Album:** </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>song[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'album'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>))</span>
<span id="cb59-6">    display(Image(url<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>song[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'album_cover_url'</span>], width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>))</span>
<span id="cb59-7">    display(Markdown(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"[Preview the song](</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>song[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'preview_url'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>))</span>
<span id="cb59-8">    display(Markdown(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"**Reason:** </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>song[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'reason'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>))</span>
<span id="cb59-9">    display(Markdown(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"----"</span>))</span></code></pre></div>
<section id="mazhai-kuruvi" class="level3 cell-output cell-output-display">
<h3 class="anchored" data-anchor-id="mazhai-kuruvi">Mazhai Kuruvi</h3>
</section>
<div class="cell-output cell-output-display">
<p><strong>Artist:</strong> A.R. Rahman</p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Album:</strong> Chekka Chivantha Vaanam (Original Motion Picture Soundtrack)</p>
</div>
<div class="cell-output cell-output-display">
<img src="https://www.arunprakash.org/posts/openai-parallel-function-calling-handson-tools/https:/i.scdn.co/image/ab67616d0000b2735234d8419de0ffdccc8c27a7" width="200">
</div>
<div class="cell-output cell-output-display">
<p><a href="https://p.scdn.co/mp3-preview/771e747c73fc6cd5914a4e447f9daf3bd74e38a5?cid=706a549bcf8a4575b6e1dd3fc24f5f95">Preview the song</a></p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Reason:</strong> This song has a soothing melody that resonates well with a cloudy and peaceful atmosphere.</p>
</div>
<div class="cell-output cell-output-display">
<hr>
</div>
<section id="nenjukulle" class="level3 cell-output cell-output-display">
<h3 class="anchored" data-anchor-id="nenjukulle">Nenjukulle</h3>
</section>
<div class="cell-output cell-output-display">
<p><strong>Artist:</strong> A.R. Rahman, Shakthisree Gopalan</p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Album:</strong> Kadal (Original Motion Picture Soundtrack)</p>
</div>
<div class="cell-output cell-output-display">
<img src="https://www.arunprakash.org/posts/openai-parallel-function-calling-handson-tools/https:/i.scdn.co/image/ab67616d0000b273d3d692e38621d741606588e7" width="200">
</div>
<div class="cell-output cell-output-display">
<p><a href="https://p.scdn.co/mp3-preview/d48678e7eef2bebd5a099d2b6b1ff5dd299ff102?cid=706a549bcf8a4575b6e1dd3fc24f5f95">Preview the song</a></p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Reason:</strong> The backdrop of the ocean in the lyrics, combined with the cloudy weather theme, provides a tranquil listening experience.</p>
</div>
<div class="cell-output cell-output-display">
<hr>
</div>
<section id="uyire-uyire" class="level3 cell-output cell-output-display">
<h3 class="anchored" data-anchor-id="uyire-uyire">Uyire Uyire</h3>
</section>
<div class="cell-output cell-output-display">
<p><strong>Artist:</strong> Hariharan, Bombay Jayashri</p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Album:</strong> Bombay (Original Motion Picture Soundtrack)</p>
</div>
<div class="cell-output cell-output-display">
<img src="https://www.arunprakash.org/posts/openai-parallel-function-calling-handson-tools/https:/i.scdn.co/image/ab67616d0000b2738b895bdb8ccefee6ab65114b" width="200">
</div>
<div class="cell-output cell-output-display">
<p><a href="https://p.scdn.co/mp3-preview/c4e812236497ce1f72610be2af10740ad6ecead6?cid=706a549bcf8a4575b6e1dd3fc24f5f95">Preview the song</a></p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Reason:</strong> Its lyrical depth and the warmth of the composition blend nicely with the introspective mood of a cloudy day.</p>
</div>
<div class="cell-output cell-output-display">
<hr>
</div>
<section id="vaseegara" class="level3 cell-output cell-output-display">
<h3 class="anchored" data-anchor-id="vaseegara">Vaseegara</h3>
</section>
<div class="cell-output cell-output-display">
<p><strong>Artist:</strong> Bombay Jayashri</p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Album:</strong> Minnalae (Original Motion Picture Soundtrack)</p>
</div>
<div class="cell-output cell-output-display">
<img src="https://www.arunprakash.org/posts/openai-parallel-function-calling-handson-tools/https:/i.scdn.co/image/ab67616d0000b273102f02fa7e7ded2bc5f65653" width="200">
</div>
<div class="cell-output cell-output-display">
<p><a href="https://p.scdn.co/mp3-preview/2db5c05f48a7214b56c8eed843103ae3f241e00e?cid=706a549bcf8a4575b6e1dd3fc24f5f95">Preview the song</a></p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Reason:</strong> This classic love ballad with its serene mood is perfect for a cloudy day lounging.</p>
</div>
<div class="cell-output cell-output-display">
<hr>
</div>
<section id="aaromale" class="level3 cell-output cell-output-display">
<h3 class="anchored" data-anchor-id="aaromale">Aaromale</h3>
</section>
<div class="cell-output cell-output-display">
<p><strong>Artist:</strong> Alphons Joseph</p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Album:</strong> Vinnaithaandi Varuvaayaa (Original Motion Picture Soundtrack)</p>
</div>
<div class="cell-output cell-output-display">
<img src="https://www.arunprakash.org/posts/openai-parallel-function-calling-handson-tools/https:/i.scdn.co/image/ab67616d0000b27397838a7eeb5f477cfc6707a5" width="200">
</div>
<div class="cell-output cell-output-display">
<p><a href="https://p.scdn.co/mp3-preview/ed07e1b3e3fe14b55e29c10c5413dd9e04fbe1e5?cid=706a549bcf8a4575b6e1dd3fc24f5f95">Preview the song</a></p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Reason:</strong> A refreshing song that’s well-suited for when the clouds are out and you crave an uplifting atmosphere.</p>
</div>
<div class="cell-output cell-output-display">
<hr>
</div>
</div>
</section>
<section id="putting-it-all-together" class="level1">
<h1>Putting it all together</h1>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> generate_weather_music(city):</span>
<span id="cb60-2">    messages <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb60-3">        {</span>
<span id="cb60-4">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>,</span>
<span id="cb60-5">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A Song Suggestions Assistant based on local weather in metric and local language"</span></span>
<span id="cb60-6">        },</span>
<span id="cb60-7">        {</span>
<span id="cb60-8">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>,</span>
<span id="cb60-9">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"""I am in </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>city<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, suggest 5 songs based on their current weather and their local language</span></span>
<span id="cb60-10"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">            and display their album details such as album cover, artist, and preview link.</span></span>
<span id="cb60-11"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">            return a json object with keys as song, artist, album, album_cover_url, and preview_url and reason</span></span>
<span id="cb60-12"></span>
<span id="cb60-13"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">            key as song_suggestions and value as a list of json objects with keys as song, artist, album, album_cover_url, preview_url, and reason</span></span>
<span id="cb60-14"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">            """</span></span>
<span id="cb60-15">        }</span>
<span id="cb60-16">    ]</span>
<span id="cb60-17">    tools <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> available_tools</span>
<span id="cb60-18">    response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb60-19">        model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4-1106-preview"</span>,</span>
<span id="cb60-20">        messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>messages,</span>
<span id="cb60-21">        tools<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tools,</span>
<span id="cb60-22">        tool_choice<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"auto"</span>,</span>
<span id="cb60-23">        temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span></span>
<span id="cb60-24">    )</span>
<span id="cb60-25">    response_message <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].message</span>
<span id="cb60-26">    tool_calls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> response_message.tool_calls</span>
<span id="cb60-27"></span>
<span id="cb60-28">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> tool_calls:</span>
<span id="cb60-29">        function_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tool_calls[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].function.name</span>
<span id="cb60-30">        function_args <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.loads(tool_calls[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].function.arguments)</span>
<span id="cb60-31">        function_response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> available_functions[function_name](<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>function_args)</span>
<span id="cb60-32"></span>
<span id="cb60-33">        messages.append(response_message)</span>
<span id="cb60-34">        messages.append(</span>
<span id="cb60-35">            {</span>
<span id="cb60-36">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tool_call_id"</span>: tool_calls[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>,</span>
<span id="cb60-37">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tool"</span>,</span>
<span id="cb60-38">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"name"</span>: function_name,</span>
<span id="cb60-39">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: function_response,</span>
<span id="cb60-40">            }</span>
<span id="cb60-41">        )</span>
<span id="cb60-42"></span>
<span id="cb60-43">        second_response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb60-44">            model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4-1106-preview"</span>,</span>
<span id="cb60-45">            messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>messages,</span>
<span id="cb60-46">            tools<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>available_tools,</span>
<span id="cb60-47">            tool_choice<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"auto"</span>,</span>
<span id="cb60-48">        )</span>
<span id="cb60-49"></span>
<span id="cb60-50">        response_message <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> second_response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].message</span>
<span id="cb60-51">        tool_calls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> response_message.tool_calls</span>
<span id="cb60-52"></span>
<span id="cb60-53">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> tool_calls:</span>
<span id="cb60-54">            messages.append(response_message)</span>
<span id="cb60-55">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> tool <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> tool_calls:</span>
<span id="cb60-56">                function_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tool.function.name</span>
<span id="cb60-57">                function_args <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.loads(tool.function.arguments)</span>
<span id="cb60-58">                function_response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> available_functions[function_name](<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>function_args)</span>
<span id="cb60-59"></span>
<span id="cb60-60">                messages.append(</span>
<span id="cb60-61">                    {</span>
<span id="cb60-62">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tool_call_id"</span>: tool.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>,</span>
<span id="cb60-63">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tool"</span>,</span>
<span id="cb60-64">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"name"</span>: function_name,</span>
<span id="cb60-65">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: function_response,</span>
<span id="cb60-66">                    }</span>
<span id="cb60-67">                )</span>
<span id="cb60-68"></span>
<span id="cb60-69">            third_response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb60-70">                model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4-1106-preview"</span>,</span>
<span id="cb60-71">                messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>messages,</span>
<span id="cb60-72">                response_format<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"json_object"</span>}</span>
<span id="cb60-73">            )</span>
<span id="cb60-74"></span>
<span id="cb60-75">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> third_response</span></code></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.arunprakash.org/posts/openai-parallel-function-calling-handson-tools/function_calling_files/figure-html/7f404b0a-1-image.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image.png</figcaption>
</figure>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb61" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1">result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> generate_weather_music(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sydney"</span>)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1">song_suggestions_json <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> result.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].message.content</span></code></pre></div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span>(song_suggestions_json)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>str</code></pre>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1">song_suggestions_json <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.loads(song_suggestions_json)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1">song_suggestions_json </span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>{'song_suggestions': [{'song': 'Over the Rainbow',
   'artist': "Israel Kamakawiwo'ole",
   'album': 'Alone In Iz World',
   'album_cover_url': 'https://i.scdn.co/image/ab67616d0000b27356c868c8c85e7e4e62bd9ec1',
   'preview_url': 'https://p.scdn.co/mp3-preview/2b0ebc854ece09122c1918aeff6af258493defe9?cid=706a549bcf8a4575b6e1dd3fc24f5f95',
   'reason': "This classic song's soothing ukulele and gentle vocals perfectly match the peacefulness of an overcast day."},
  {'song': 'Sweater Weather',
   'artist': 'The Neighbourhood',
   'album': 'I Love You.',
   'album_cover_url': 'https://i.scdn.co/image/ab67616d0000b2738265a736a1eb838ad5a0b921',
   'preview_url': 'https://p.scdn.co/mp3-preview/877602f424a9dea277b13301ffc516f9fd1fbe7e?cid=706a549bcf8a4575b6e1dd3fc24f5f95',
   'reason': "The title itself and the song's vibe are a nod to the cozy feel of the current Sydney weather."},
  {'song': 'Set Fire to the Rain',
   'artist': 'Adele',
   'album': '21',
   'album_cover_url': 'https://i.scdn.co/image/ab67616d0000b2732118bf9b198b05a95ded6300',
   'preview_url': 'https://p.scdn.co/mp3-preview/6fc68c105e091645376471727960d2ba3cd0ee01?cid=706a549bcf8a4575b6e1dd3fc24f5f95',
   'reason': "Though it's not raining, the cloudy skies can bring about the feeling captured by this powerful yet soulful song."},
  {'song': 'Cloudy Day',
   'artist': 'Tones And I',
   'album': 'Cloudy Day',
   'album_cover_url': 'https://i.scdn.co/image/ab67616d0000b273d2cf6639f08099bdb14e388d',
   'preview_url': 'https://p.scdn.co/mp3-preview/9c49fc0dfef73b4f91d444309b06450c9e30fee5?cid=706a549bcf8a4575b6e1dd3fc24f5f95',
   'reason': 'This song has a fitting title and an uplifting tone that can bring positivity to a cloudy day.'},
  {'song': 'Cloudbusting',
   'artist': 'Kate Bush',
   'album': 'Hounds Of Love',
   'album_cover_url': 'https://i.scdn.co/image/ab67616d0000b273ad08f4b38efbff0c0da0f252',
   'preview_url': 'https://p.scdn.co/mp3-preview/0156aec767cfcbe6bfc80bb9c8ad931169a3d910?cid=706a549bcf8a4575b6e1dd3fc24f5f95',
   'reason': 'An evocative track that seamlessly aligns with the overcast weather in Sydney, capturing the theme of moving through introspective moments.'}]}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> song <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> song_suggestions_json[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"song_suggestions"</span>]:</span>
<span id="cb68-2">    display(Markdown(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"### </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>song[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'song'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>))</span>
<span id="cb68-3">    display(Markdown(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"**Artist:** </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>song[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'artist'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>))</span>
<span id="cb68-4">    display(Markdown(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"**Album:** </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>song[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'album'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>))</span>
<span id="cb68-5">    display(Image(url<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>song[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'album_cover_url'</span>], width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>))</span>
<span id="cb68-6">    display(Markdown(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"[Preview the song](</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>song[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'preview_url'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>))</span>
<span id="cb68-7">    display(Markdown(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"**Reason:** </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>song[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'reason'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>))</span>
<span id="cb68-8">    display(Markdown(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"----"</span>))</span></code></pre></div>
<section id="over-the-rainbow" class="level3 cell-output cell-output-display">
<h3 class="anchored" data-anchor-id="over-the-rainbow">Over the Rainbow</h3>
</section>
<div class="cell-output cell-output-display">
<p><strong>Artist:</strong> Israel Kamakawiwo’ole</p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Album:</strong> Alone In Iz World</p>
</div>
<div class="cell-output cell-output-display">
<img src="https://www.arunprakash.org/posts/openai-parallel-function-calling-handson-tools/https:/i.scdn.co/image/ab67616d0000b27356c868c8c85e7e4e62bd9ec1" width="200">
</div>
<div class="cell-output cell-output-display">
<p><a href="https://p.scdn.co/mp3-preview/2b0ebc854ece09122c1918aeff6af258493defe9?cid=706a549bcf8a4575b6e1dd3fc24f5f95">Preview the song</a></p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Reason:</strong> This classic song’s soothing ukulele and gentle vocals perfectly match the peacefulness of an overcast day.</p>
</div>
<div class="cell-output cell-output-display">
<hr>
</div>
<section id="sweater-weather" class="level3 cell-output cell-output-display">
<h3 class="anchored" data-anchor-id="sweater-weather">Sweater Weather</h3>
</section>
<div class="cell-output cell-output-display">
<p><strong>Artist:</strong> The Neighbourhood</p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Album:</strong> I Love You.</p>
</div>
<div class="cell-output cell-output-display">
<img src="https://www.arunprakash.org/posts/openai-parallel-function-calling-handson-tools/https:/i.scdn.co/image/ab67616d0000b2738265a736a1eb838ad5a0b921" width="200">
</div>
<div class="cell-output cell-output-display">
<p><a href="https://p.scdn.co/mp3-preview/877602f424a9dea277b13301ffc516f9fd1fbe7e?cid=706a549bcf8a4575b6e1dd3fc24f5f95">Preview the song</a></p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Reason:</strong> The title itself and the song’s vibe are a nod to the cozy feel of the current Sydney weather.</p>
</div>
<div class="cell-output cell-output-display">
<hr>
</div>
<section id="set-fire-to-the-rain" class="level3 cell-output cell-output-display">
<h3 class="anchored" data-anchor-id="set-fire-to-the-rain">Set Fire to the Rain</h3>
</section>
<div class="cell-output cell-output-display">
<p><strong>Artist:</strong> Adele</p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Album:</strong> 21</p>
</div>
<div class="cell-output cell-output-display">
<img src="https://www.arunprakash.org/posts/openai-parallel-function-calling-handson-tools/https:/i.scdn.co/image/ab67616d0000b2732118bf9b198b05a95ded6300" width="200">
</div>
<div class="cell-output cell-output-display">
<p><a href="https://p.scdn.co/mp3-preview/6fc68c105e091645376471727960d2ba3cd0ee01?cid=706a549bcf8a4575b6e1dd3fc24f5f95">Preview the song</a></p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Reason:</strong> Though it’s not raining, the cloudy skies can bring about the feeling captured by this powerful yet soulful song.</p>
</div>
<div class="cell-output cell-output-display">
<hr>
</div>
<section id="cloudy-day" class="level3 cell-output cell-output-display">
<h3 class="anchored" data-anchor-id="cloudy-day">Cloudy Day</h3>
</section>
<div class="cell-output cell-output-display">
<p><strong>Artist:</strong> Tones And I</p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Album:</strong> Cloudy Day</p>
</div>
<div class="cell-output cell-output-display">
<img src="https://www.arunprakash.org/posts/openai-parallel-function-calling-handson-tools/https:/i.scdn.co/image/ab67616d0000b273d2cf6639f08099bdb14e388d" width="200">
</div>
<div class="cell-output cell-output-display">
<p><a href="https://p.scdn.co/mp3-preview/9c49fc0dfef73b4f91d444309b06450c9e30fee5?cid=706a549bcf8a4575b6e1dd3fc24f5f95">Preview the song</a></p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Reason:</strong> This song has a fitting title and an uplifting tone that can bring positivity to a cloudy day.</p>
</div>
<div class="cell-output cell-output-display">
<hr>
</div>
<section id="cloudbusting" class="level3 cell-output cell-output-display">
<h3 class="anchored" data-anchor-id="cloudbusting">Cloudbusting</h3>
</section>
<div class="cell-output cell-output-display">
<p><strong>Artist:</strong> Kate Bush</p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Album:</strong> Hounds Of Love</p>
</div>
<div class="cell-output cell-output-display">
<img src="https://www.arunprakash.org/posts/openai-parallel-function-calling-handson-tools/https:/i.scdn.co/image/ab67616d0000b273ad08f4b38efbff0c0da0f252" width="200">
</div>
<div class="cell-output cell-output-display">
<p><a href="https://p.scdn.co/mp3-preview/0156aec767cfcbe6bfc80bb9c8ad931169a3d910?cid=706a549bcf8a4575b6e1dd3fc24f5f95">Preview the song</a></p>
</div>
<div class="cell-output cell-output-display">
<p><strong>Reason:</strong> An evocative track that seamlessly aligns with the overcast weather in Sydney, capturing the theme of moving through introspective moments.</p>
</div>
<div class="cell-output cell-output-display">
<hr>
</div>
</div>



</section>

<div class="quarto-listing quarto-listing-container-default" id="listing-listing">
<div class="list quarto-listing-default">

</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div><a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>llm</category>
  <category>openai</category>
  <category>function-calling</category>
  <guid>https://www.arunprakash.org/posts/openai-parallel-function-calling-handson-tools/function_calling.html</guid>
  <pubDate>Tue, 02 Jan 2024 18:30:00 GMT</pubDate>
  <media:content url="https://www.arunprakash.org/posts/openai-parallel-function-calling-handson-tools/music.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Understanding OpenAI ChatCompletion Model Parameters</title>
  <dc:creator>Arun Prakash</dc:creator>
  <link>https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature.html</link>
  <description><![CDATA[ 




<p>In this notebook, we will go through different parameters in LLM that control the token generation process</p>
<ul>
<li>temperature</li>
<li>top_p</li>
<li>frequency_penalty</li>
<li>presence_penalty</li>
</ul>
<p>In each parameter, we will explore different range of values and discuss about openai’s default values and recommendations. Then in the final section we will go through <strong>some real examples</strong> to understand how these parameters affect the token generation process.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature_files/figure-html/e178d8be-1-IMG_F4CC52CE7F7F-1.jpeg" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">IMG_F4CC52CE7F7F-1.jpeg</figcaption>
</figure>
</div>
<p>I have written two helper functions <code>highlight_openai_response</code> and <code>highlight</code> for highlighting the probabilities of the tokens generated by the model. Less probable tokens are highlighted in white and more probable tokens are highlighted in green.</p>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1">question <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">What is machine learning? Explain it to a five year old.</span></span>
<span id="cb1-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Answer within 100 words, 3 paragraphs</span></span>
<span id="cb1-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb1-6"></span>
<span id="cb1-7">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-3.5-turbo"</span></span>
<span id="cb1-8"></span>
<span id="cb1-9"></span></code></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sns</span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> IPython.display <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> HTML</span>
<span id="cb2-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.colors <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> mcolors</span>
<span id="cb2-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb2-5"></span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> highlight_openai_response(response):</span>
<span id="cb2-8">    messages <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].message.content</span>
<span id="cb2-9">    probabilities <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb2-10"></span>
<span id="cb2-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> res <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].logprobs.content:</span>
<span id="cb2-12">        probabilities.append(np.exp(res.logprob))</span>
<span id="cb2-13"></span>
<span id="cb2-14">    highlight(messages, probabilities)</span>
<span id="cb2-15"></span>
<span id="cb2-16"></span>
<span id="cb2-17"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> highlight(text, probabilities):</span>
<span id="cb2-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Split the text into words, preserving newlines and spaces</span></span>
<span id="cb2-19">    words <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb2-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> line <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> text.split(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>):</span>
<span id="cb2-21">        words.extend([(word, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> word <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> line.split(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> [(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)])</span>
<span id="cb2-22"></span>
<span id="cb2-23">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove the last element if it is a newline, added due to the split</span></span>
<span id="cb2-24">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> words[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>:</span>
<span id="cb2-25">        words.pop()</span>
<span id="cb2-26"></span>
<span id="cb2-27">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ensure probabilities list matches the number of non-empty words</span></span>
<span id="cb2-28">    normalized_probs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, p), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> probabilities]</span>
<span id="cb2-29"></span>
<span id="cb2-30">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use a Seaborn color palette and map probabilities to colors</span></span>
<span id="cb2-31">    palette <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sns.light_palette(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>, as_cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb2-32"></span>
<span id="cb2-33">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Start building the HTML string using the 'pre' tag to preserve whitespace</span></span>
<span id="cb2-34">    html_string <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;pre style='font-family: inherit; white-space: pre-wrap; word-break: break-all;'&gt;"</span></span>
<span id="cb2-35"></span>
<span id="cb2-36"></span>
<span id="cb2-37">    prob_index <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Index for the current probability</span></span>
<span id="cb2-38"></span>
<span id="cb2-39">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> word, space <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> words:</span>
<span id="cb2-40">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> word <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">and</span> word <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>:  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If the element is not a space or newline</span></span>
<span id="cb2-41">            rgba_color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> palette(normalized_probs[prob_index])</span>
<span id="cb2-42">            hex_color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mcolors.to_hex(rgba_color)</span>
<span id="cb2-43">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set the text color to black and the background color to the word's color</span></span>
<span id="cb2-44">            html_string <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"&lt;span style='background-color: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>hex_color<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">; color: black;'&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>word<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;/span&gt;"</span></span>
<span id="cb2-45">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> space:</span>
<span id="cb2-46">                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set the space's background color to the word's color</span></span>
<span id="cb2-47">                html_string <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"&lt;span style='background-color: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>hex_color<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">; color: black;'&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>space<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;/span&gt;"</span></span>
<span id="cb2-48">            prob_index <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-49">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> word <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>:</span>
<span id="cb2-50">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add a newline in HTML, and reset the color for the next line</span></span>
<span id="cb2-51">            html_string <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;br&gt;"</span></span>
<span id="cb2-52">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb2-53">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This case handles multiple spaces in a row</span></span>
<span id="cb2-54">            previous_hex_color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mcolors.to_hex(</span>
<span id="cb2-55">                palette(normalized_probs[prob_index <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb2-56">            )</span>
<span id="cb2-57">            html_string <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> (</span>
<span id="cb2-58">                <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"&lt;span style='background-color: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>previous_hex_color<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt; &lt;/span&gt;"</span></span>
<span id="cb2-59">            )</span>
<span id="cb2-60"></span>
<span id="cb2-61">    html_string <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/pre&gt;"</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Close the 'pre' tag</span></span>
<span id="cb2-62"></span>
<span id="cb2-63">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the HTML string</span></span>
<span id="cb2-64">    display(HTML(html_string))</span></code></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">highlight(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hello I am Arun"</span>, [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>])</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="font-family: inherit; white-space: pre-wrap; word-break: break-all;"><span style="background-color: #178b17; color: black;">Hello</span><span style="background-color: #178b17; color: black;"> </span><span style="background-color: #2f972f; color: black;">I</span><span style="background-color: #2f972f; color: black;"> </span><span style="background-color: #5eae5e; color: black;">am</span><span style="background-color: #5eae5e; color: black;"> </span><span style="background-color: #8dc58d; color: black;">Arun</span><span style="background-color: #8dc58d; color: black;"> </span></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb4-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> dotenv <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> load_dotenv</span>
<span id="cb4-3">load_dotenv()</span>
<span id="cb4-4">os.environ[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OPENAI_API_KEY"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OPENAI_API_KEY"</span>)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> openai <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> OpenAI, __version__</span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"OpenAI version: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>__version__<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb5-3">client <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> OpenAI()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OpenAI version: 1.5.0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span></span></code></pre></div>
</div>
<section id="tokens" class="level1">
<h1>Tokens</h1>
<p>In large language models (LLMs), tokens are the smallest units of text that the model processes and generates. They can represent individual characters, words, subwords, or even larger linguistic units, depending on the specific tokenization approach used. Tokens act as a bridge between the raw text data and the numerical representations that LLMs can work with.</p>
<p>In the context of OpenAI, tokens are the basic units of text processed by their language models, such as GPT-3. OpenAI employs Byte-Pair Encoding (BPE) for tokenization, which is a method initially designed for text compression. BPE identifies the most frequent pairs of characters or tokens and merges them to form new tokens, thus optimizing the tokenization process for efficiency and effectiveness in representing the text data. This approach allows the model to handle a wide range of vocabulary, including rare words or phrases, by breaking them down into subword units.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature_files/figure-html/b47380a6-1-image.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image.png</figcaption>
</figure>
</div>
<p>source https://platform.openai.com/tokenizer</p>
<p>In openai chat completion APIs, four parameter controls the token generation process. They are</p>
<ul>
<li>temperature</li>
<li>top_p</li>
<li>frequency_penalty</li>
<li>presence_penalty</li>
</ul>
</section>
<section id="temperature" class="level1">
<h1>Temperature</h1>
<p>In large language models, temperature is a parameter that controls the randomness of predictions by scaling the logits before applying the softmax function. A low temperature makes the model more confident and conservative, favoring more likely predictions, while a high temperature increases diversity and creativity, allowing for less probable outcomes.</p>
<p>Temperature adjusts the probability distribution of the next word. A higher temperature increases randomness, while a lower one makes the model more deterministic.</p>
<p>Purpose: It controls the level of unpredictability in the output.</p>
<p>The temperature adjustment equation in LaTeX format is as follows:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AP'(w_i)%20=%20%5Cfrac%7BP(w_i)%5E%7B%5Cfrac%7B1%7D%7BT%7D%7D%7D%7B%5Csum_%7Bj=1%7D%5E%7BV%7D%20P(w_j)%5E%7B%5Cfrac%7B1%7D%7BT%7D%7D%7D%0A"></p>
<p>Here, <img src="https://latex.codecogs.com/png.latex?P(w_i)"> is the original probability of the word <img src="https://latex.codecogs.com/png.latex?w_i">, <img src="https://latex.codecogs.com/png.latex?T"> is the temperature, <img src="https://latex.codecogs.com/png.latex?P'(w_i)"> is the adjusted probability of the word, and <img src="https://latex.codecogs.com/png.latex?V"> is the vocabulary size (the total number of words over which the probabilities are distributed). This equation shows how each original probability <img src="https://latex.codecogs.com/png.latex?P(w_i)"> is raised to the power of the reciprocal of the temperature, and then normalized by dividing by the sum of all such adjusted probabilities to ensure that the adjusted probabilities sum to 1.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.9</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>0.368437494723581</code></pre>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>0.06652540281931184</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb12-2"></span>
<span id="cb12-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Base probabilities for 20 words</span></span>
<span id="cb12-4">base_probabilities <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb12-5">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.19</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.12</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.10</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.09</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.07</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.06</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.04</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.03</span>,</span>
<span id="cb12-6">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.03</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.03</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span></span>
<span id="cb12-7">]</span>
<span id="cb12-8"></span>
<span id="cb12-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Temperatures</span></span>
<span id="cb12-10">high_temperature <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.9</span></span>
<span id="cb12-11">low_temperature <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span></span>
<span id="cb12-12"></span>
<span id="cb12-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adjusted probabilities with high temperature</span></span>
<span id="cb12-14">adjusted_probabilities_high <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> high_temperature) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> base_probabilities]</span>
<span id="cb12-15"></span>
<span id="cb12-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adjusted probabilities with low temperature</span></span>
<span id="cb12-17">adjusted_probabilities_low <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> low_temperature) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> base_probabilities]</span>
<span id="cb12-18"></span>
<span id="cb12-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Normalizing the adjusted probabilities for high temperature</span></span>
<span id="cb12-20">sum_adjusted_probabilities_high <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(adjusted_probabilities_high)</span>
<span id="cb12-21">normalized_probabilities_high <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> sum_adjusted_probabilities_high <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> adjusted_probabilities_high]</span>
<span id="cb12-22"></span>
<span id="cb12-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Normalizing the adjusted probabilities for low temperature</span></span>
<span id="cb12-24">sum_adjusted_probabilities_low <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(adjusted_probabilities_low)</span>
<span id="cb12-25">normalized_probabilities_low <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> sum_adjusted_probabilities_low <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> adjusted_probabilities_low]</span>
<span id="cb12-26"></span>
<span id="cb12-27">words <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"word</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)]</span>
<span id="cb12-28"></span>
<span id="cb12-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a DataFrame with the words and their probabilities, adjusted for high and low temperatures</span></span>
<span id="cb12-30">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame({</span>
<span id="cb12-31">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"word"</span>: words,</span>
<span id="cb12-32">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"base_probability"</span>: base_probabilities,</span>
<span id="cb12-33">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"adjusted_probability_high=1.9"</span>: adjusted_probabilities_high,</span>
<span id="cb12-34">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normalized_probabilities_high=1.9"</span>: normalized_probabilities_high,</span>
<span id="cb12-35">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"adjusted_probability_low=0.4"</span>: adjusted_probabilities_low,</span>
<span id="cb12-36">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normalized_probabilities_low=0.4"</span>: normalized_probabilities_low</span>
<span id="cb12-37">})</span>
<span id="cb12-38"></span>
<span id="cb12-39">df</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">word</th>
<th data-quarto-table-cell-role="th">base_probability</th>
<th data-quarto-table-cell-role="th">adjusted_probability_high=1.9</th>
<th data-quarto-table-cell-role="th">normalized_probabilities_high=1.9</th>
<th data-quarto-table-cell-role="th">adjusted_probability_low=0.4</th>
<th data-quarto-table-cell-role="th">normalized_probabilities_low=0.4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>word0</td>
<td>0.19</td>
<td>0.417250</td>
<td>0.111183</td>
<td>0.015736</td>
<td>0.493728</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>word1</td>
<td>0.12</td>
<td>0.327611</td>
<td>0.087298</td>
<td>0.004988</td>
<td>0.156515</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>word2</td>
<td>0.10</td>
<td>0.297635</td>
<td>0.079310</td>
<td>0.003162</td>
<td>0.099221</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>word3</td>
<td>0.09</td>
<td>0.281580</td>
<td>0.075032</td>
<td>0.002430</td>
<td>0.076245</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>word4</td>
<td>0.08</td>
<td>0.264654</td>
<td>0.070522</td>
<td>0.001810</td>
<td>0.056797</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>word5</td>
<td>0.07</td>
<td>0.246693</td>
<td>0.065736</td>
<td>0.001296</td>
<td>0.040677</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>word6</td>
<td>0.06</td>
<td>0.227469</td>
<td>0.060613</td>
<td>0.000882</td>
<td>0.027668</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>word7</td>
<td>0.05</td>
<td>0.206656</td>
<td>0.055067</td>
<td>0.000559</td>
<td>0.017540</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>word8</td>
<td>0.04</td>
<td>0.183756</td>
<td>0.048965</td>
<td>0.000320</td>
<td>0.010040</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>word9</td>
<td>0.03</td>
<td>0.157937</td>
<td>0.042085</td>
<td>0.000156</td>
<td>0.004891</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>word10</td>
<td>0.03</td>
<td>0.157937</td>
<td>0.042085</td>
<td>0.000156</td>
<td>0.004891</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>word11</td>
<td>0.03</td>
<td>0.157937</td>
<td>0.042085</td>
<td>0.000156</td>
<td>0.004891</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>word12</td>
<td>0.02</td>
<td>0.127587</td>
<td>0.033998</td>
<td>0.000057</td>
<td>0.001775</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>word13</td>
<td>0.02</td>
<td>0.127587</td>
<td>0.033998</td>
<td>0.000057</td>
<td>0.001775</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>word14</td>
<td>0.02</td>
<td>0.127587</td>
<td>0.033998</td>
<td>0.000057</td>
<td>0.001775</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>word15</td>
<td>0.01</td>
<td>0.088587</td>
<td>0.023605</td>
<td>0.000010</td>
<td>0.000314</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>word16</td>
<td>0.01</td>
<td>0.088587</td>
<td>0.023605</td>
<td>0.000010</td>
<td>0.000314</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>word17</td>
<td>0.01</td>
<td>0.088587</td>
<td>0.023605</td>
<td>0.000010</td>
<td>0.000314</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>word18</td>
<td>0.01</td>
<td>0.088587</td>
<td>0.023605</td>
<td>0.000010</td>
<td>0.000314</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>word19</td>
<td>0.01</td>
<td>0.088587</td>
<td>0.023605</td>
<td>0.000010</td>
<td>0.000314</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"base_probability"</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>1.0</code></pre>
</div>
</div>
<p>As we can see that the base probabilities decrease progressively from <code>word0</code> to <code>word19</code>, starting at 0.19 and going down to 0.01. However, after the adjustment, the probabilities are closer to each other, indicating that the temperature scaling has made the less likely words more probable and the more probable words less dominant.</p>
<p>For example, <code>word0</code> has its probability decreased from 0.19 to about 0.11, while <code>word19</code> has its probability slightly increased from 0.01 to about 0.024. This adjustment serves to flatten the probability distribution, making the model less certain and more explorative in its word choices.</p>
<p>The adjusted probabilities are also normalized, as their sum should equal 1 to represent a valid probability distribution. This adjustment allows for a less deterministic and more varied text generation, which can be useful for generating more diverse and creative text outputs.</p>
<p>The temperature adjustment has effectively reduced the likelihood of the most probable word being selected and increased the likelihood of less probable words, thus adding variability to the text generation process.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot the probabilities</span></span>
<span id="cb15-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb15-3">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb15-4">plt.plot(words, base_probabilities, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Base Probabilities"</span>)</span>
<span id="cb15-5">plt.plot(words, normalized_probabilities_high, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High Temperature"</span>)</span>
<span id="cb15-6">plt.plot(words, normalized_probabilities_low, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Low Temperature"</span>)</span>
<span id="cb15-7">plt.xticks(rotation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>)</span>
<span id="cb15-8">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Words"</span>)</span>
<span id="cb15-9">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probability"</span>)</span>
<span id="cb15-10">plt.legend()</span>
<span id="cb15-11">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature_files/figure-html/cell-12-output-1.png" class="img-fluid"></p>
</div>
</div>
<section id="temperature-0-deterministic" class="level3">
<h3 class="anchored" data-anchor-id="temperature-0-deterministic">Temperature : 0( Deterministic)</h3>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"></span>
<span id="cb16-2">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb16-3">  model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model,</span>
<span id="cb16-4">  messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb16-5">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a helpful assistant."</span>},</span>
<span id="cb16-6">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: question}</span>
<span id="cb16-7">  ],</span>
<span id="cb16-8">  logprobs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb16-9">  temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb16-10">  seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seed</span>
<span id="cb16-11">)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].message.content)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Machine learning is like having a super smart robot friend that can learn things on its own. Just like how you learn new things by practicing and trying different things, machine learning is when a computer program learns from lots of examples and gets better at doing a task. For example, if you show the robot friend lots of pictures of cats and dogs, it can learn to tell the difference between them. It's like magic, but really it's just the computer using math and patterns to figure things out.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1">response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].logprobs.content[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># first 5 tokens</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>[ChatCompletionTokenLogprob(token='Machine', bytes=[77, 97, 99, 104, 105, 110, 101], logprob=-0.001537835, top_logprobs=[]),
 ChatCompletionTokenLogprob(token=' learning', bytes=[32, 108, 101, 97, 114, 110, 105, 110, 103], logprob=-0.00058532227, top_logprobs=[]),
 ChatCompletionTokenLogprob(token=' is', bytes=[32, 105, 115], logprob=-0.00044044392, top_logprobs=[]),
 ChatCompletionTokenLogprob(token=' like', bytes=[32, 108, 105, 107, 101], logprob=-0.31134152, top_logprobs=[]),
 ChatCompletionTokenLogprob(token=' having', bytes=[32, 104, 97, 118, 105, 110, 103], logprob=-1.0659788, top_logprobs=[])]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1">probs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span></code></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb22-2"></span>
<span id="cb22-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> res <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].logprobs.content:</span>
<span id="cb22-4">    probs.append(np.exp(res.logprob))</span></code></pre></div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">plt.hist(probs)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb23-2">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probability"</span>)</span>
<span id="cb23-3">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span>
<span id="cb23-4">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature_files/figure-html/cell-18-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1">response.system_fingerprint</span></code></pre></div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">highlight_openai_response(response)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="font-family: inherit; white-space: pre-wrap; word-break: break-all;"><span style="background-color: #008000; color: black;">Machine</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">learning</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">is</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #3f9f3f; color: black;">like</span><span style="background-color: #3f9f3f; color: black;"> </span><span style="background-color: #9acb9a; color: black;">having</span><span style="background-color: #9acb9a; color: black;"> </span><span style="background-color: #008000; color: black;">a</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #8fc68f; color: black;">super</span><span style="background-color: #8fc68f; color: black;"> </span><span style="background-color: #108810; color: black;">smart</span><span style="background-color: #108810; color: black;"> </span><span style="background-color: #63b163; color: black;">robot</span><span style="background-color: #63b163; color: black;"> </span><span style="background-color: #1e8f1e; color: black;">friend</span><span style="background-color: #1e8f1e; color: black;"> </span><span style="background-color: #72b872; color: black;">that</span><span style="background-color: #72b872; color: black;"> </span><span style="background-color: #2a952a; color: black;">can</span><span style="background-color: #2a952a; color: black;"> </span><span style="background-color: #018001; color: black;">learn</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #61af61; color: black;">things</span><span style="background-color: #61af61; color: black;"> </span><span style="background-color: #65b265; color: black;">on</span><span style="background-color: #65b265; color: black;"> </span><span style="background-color: #008000; color: black;">its</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">own.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #198c19; color: black;">Just</span><span style="background-color: #198c19; color: black;"> </span><span style="background-color: #5cad5c; color: black;">like</span><span style="background-color: #5cad5c; color: black;"> </span><span style="background-color: #008000; color: black;">how</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #8dc58d; color: black;">you</span><span style="background-color: #8dc58d; color: black;"> </span><span style="background-color: #1d8e1d; color: black;">learn</span><span style="background-color: #1d8e1d; color: black;"> </span><span style="background-color: #028102; color: black;">new</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #399c39; color: black;">things</span><span style="background-color: #399c39; color: black;"> </span><span style="background-color: #038103; color: black;">by</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #279327; color: black;">practicing</span><span style="background-color: #279327; color: black;"> </span><span style="background-color: #53a953; color: black;">and</span><span style="background-color: #53a953; color: black;"> </span><span style="background-color: #46a246; color: black;">trying</span><span style="background-color: #46a246; color: black;"> </span><span style="background-color: #40a040; color: black;">different</span><span style="background-color: #40a040; color: black;"> </span><span style="background-color: #41a041; color: black;">things,</span><span style="background-color: #41a041; color: black;"> </span><span style="background-color: #43a143; color: black;">machine</span><span style="background-color: #43a143; color: black;"> </span><span style="background-color: #008000; color: black;">learning</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #369b36; color: black;">is</span><span style="background-color: #369b36; color: black;"> </span><span style="background-color: #008000; color: black;">when</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #70b770; color: black;">a</span><span style="background-color: #70b770; color: black;"> </span><span style="background-color: #349a34; color: black;">computer</span><span style="background-color: #349a34; color: black;"> </span><span style="background-color: #1d8e1d; color: black;">program</span><span style="background-color: #1d8e1d; color: black;"> </span><span style="background-color: #028102; color: black;">learns</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #48a348; color: black;">from</span><span style="background-color: #48a348; color: black;"> </span><span style="background-color: #4ba54a; color: black;">lots</span><span style="background-color: #4ba54a; color: black;"> </span><span style="background-color: #96c996; color: black;">of</span><span style="background-color: #96c996; color: black;"> </span><span style="background-color: #359a35; color: black;">examples</span><span style="background-color: #359a35; color: black;"> </span><span style="background-color: #2b952b; color: black;">and</span><span style="background-color: #2b952b; color: black;"> </span><span style="background-color: #3f9f3f; color: black;">gets</span><span style="background-color: #3f9f3f; color: black;"> </span><span style="background-color: #1d8e1d; color: black;">better</span><span style="background-color: #1d8e1d; color: black;"> </span><span style="background-color: #1e8f1e; color: black;">at</span><span style="background-color: #1e8f1e; color: black;"> </span><span style="background-color: #0d860d; color: black;">doing</span><span style="background-color: #0d860d; color: black;"> </span><span style="background-color: #0c860c; color: black;">a</span><span style="background-color: #0c860c; color: black;"> </span><span style="background-color: #1b8d1b; color: black;">task.</span><span style="background-color: #1b8d1b; color: black;"> </span><span style="background-color: #6db56d; color: black;">For</span><span style="background-color: #6db56d; color: black;"> </span><span style="background-color: #349934; color: black;">example,</span><span style="background-color: #349934; color: black;"> </span><span style="background-color: #70b770; color: black;">if</span><span style="background-color: #70b770; color: black;"> </span><span style="background-color: #84c084; color: black;">you</span><span style="background-color: #84c084; color: black;"> </span><span style="background-color: #008000; color: black;">show</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #50a750; color: black;">robot</span><span style="background-color: #50a750; color: black;"> </span><span style="background-color: #3d9e3d; color: black;">friend</span><span style="background-color: #3d9e3d; color: black;"> </span><span style="background-color: #2d962d; color: black;">lots</span><span style="background-color: #2d962d; color: black;"> </span><span style="background-color: #339933; color: black;">of</span><span style="background-color: #339933; color: black;"> </span><span style="background-color: #84c184; color: black;">pictures</span><span style="background-color: #84c184; color: black;"> </span><span style="background-color: #168b16; color: black;">of</span><span style="background-color: #168b16; color: black;"> </span><span style="background-color: #379b37; color: black;">cats</span><span style="background-color: #379b37; color: black;"> </span><span style="background-color: #008000; color: black;">and</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">dogs,</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">it</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #51a851; color: black;">can</span><span style="background-color: #51a851; color: black;"> </span><span style="background-color: #118811; color: black;">learn</span><span style="background-color: #118811; color: black;"> </span><span style="background-color: #0f870f; color: black;">to</span><span style="background-color: #0f870f; color: black;"> </span><span style="background-color: #369b36; color: black;">tell</span><span style="background-color: #369b36; color: black;"> </span><span style="background-color: #018001; color: black;">the</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #1a8d1a; color: black;">difference</span><span style="background-color: #1a8d1a; color: black;"> </span><span style="background-color: #078407; color: black;">between</span><span style="background-color: #078407; color: black;"> </span><span style="background-color: #088408; color: black;">them.</span><span style="background-color: #088408; color: black;"> </span><span style="background-color: #098509; color: black;">It's</span><span style="background-color: #098509; color: black;"> </span><span style="background-color: #269226; color: black;">like</span><span style="background-color: #269226; color: black;"> </span><span style="background-color: #008000; color: black;">magic,</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #038103; color: black;">but</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #078407; color: black;">really</span><span style="background-color: #078407; color: black;"> </span><span style="background-color: #66b266; color: black;">it's</span><span style="background-color: #66b266; color: black;"> </span><span style="background-color: #65b265; color: black;">just</span><span style="background-color: #65b265; color: black;"> </span><span style="background-color: #68b368; color: black;">the</span><span style="background-color: #68b368; color: black;"> </span><span style="background-color: #49a449; color: black;">computer</span><span style="background-color: #49a449; color: black;"> </span><span style="background-color: #8fc68f; color: black;">using</span><span style="background-color: #8fc68f; color: black;"> </span><span style="background-color: #70b770; color: black;">math</span><span style="background-color: #70b770; color: black;"> </span><span style="background-color: #2f972f; color: black;">and</span><span style="background-color: #2f972f; color: black;"> </span><span style="background-color: #62b062; color: black;">patterns</span><span style="background-color: #62b062; color: black;"> </span><span style="background-color: #078407; color: black;">to</span><span style="background-color: #078407; color: black;"> </span><span style="background-color: #018001; color: black;">figure</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #0a850a; color: black;">things</span><span style="background-color: #0a850a; color: black;"> </span><span style="background-color: #7abc7a; color: black;">out.</span><span style="background-color: #7abc7a; color: black;"> </span></pre>
</div>
</div>
</section>
</section>
<section id="high-temperature-more-randomness" class="level1">
<h1>High Temperature ( More Randomness)</h1>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"></span>
<span id="cb26-2">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb26-3">  model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model,</span>
<span id="cb26-4">  messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb26-5">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a helpful assistant."</span>},</span>
<span id="cb26-6">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: question}</span>
<span id="cb26-7">  ],</span>
<span id="cb26-8">  logprobs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb26-9">  temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.6</span>,</span>
<span id="cb26-10">  seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seed</span>
<span id="cb26-11">)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">highlight_openai_response(response)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="font-family: inherit; white-space: pre-wrap; word-break: break-all;"><span style="background-color: #008000; color: black;">Machine</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">learning</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">is</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #c4e0c4; color: black;">when</span><span style="background-color: #c4e0c4; color: black;"> </span><span style="background-color: #eaf2ea; color: black;">computer</span><span style="background-color: #eaf2ea; color: black;"> </span><span style="background-color: #068306; color: black;">programs</span><span style="background-color: #068306; color: black;"> </span><span style="background-color: #a1cfa1; color: black;">can</span><span style="background-color: #a1cfa1; color: black;"> </span><span style="background-color: #048204; color: black;">learn</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #56aa56; color: black;">and</span><span style="background-color: #56aa56; color: black;"> </span><span style="background-color: #c8e2c8; color: black;">improve</span><span style="background-color: #c8e2c8; color: black;"> </span><span style="background-color: #96c996; color: black;">by</span><span style="background-color: #96c996; color: black;"> </span><span style="background-color: #008000; color: black;">themselves.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000;"> </span><br><span style="background-color: #008000;"> </span><br><span style="background-color: #a0cea0; color: black;">Imagine</span><span style="background-color: #a0cea0; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">you</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #219021; color: black;">have</span><span style="background-color: #219021; color: black;"> </span><span style="background-color: #048204; color: black;">a</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #038103; color: black;">puzzle</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #008000; color: black;">toy</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">with</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">pictures</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #7dbd7d; color: black;">on</span><span style="background-color: #7dbd7d; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">it.</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #a6d2a6; color: black;">At</span><span style="background-color: #a6d2a6; color: black;"> </span><span style="background-color: #0b850b; color: black;">first</span><span style="background-color: #0b850b; color: black;"> </span><span style="background-color: #369b36; color: black;">it's</span><span style="background-color: #369b36; color: black;"> </span><span style="background-color: #339933; color: black;">all</span><span style="background-color: #339933; color: black;"> </span><span style="background-color: #018001; color: black;">mixed</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">up</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #3a9c3a; color: black;">and</span><span style="background-color: #3a9c3a; color: black;"> </span><span style="background-color: #6cb56c; color: black;">you</span><span style="background-color: #6cb56c; color: black;"> </span><span style="background-color: #1c8e1c; color: black;">don't</span><span style="background-color: #1c8e1c; color: black;"> </span><span style="background-color: #008000; color: black;">know</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #54a954; color: black;">how</span><span style="background-color: #54a954; color: black;"> </span><span style="background-color: #068306; color: black;">to</span><span style="background-color: #068306; color: black;"> </span><span style="background-color: #239123; color: black;">make</span><span style="background-color: #239123; color: black;"> </span><span style="background-color: #008000; color: black;">it</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">right.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #9bcc9b; color: black;">When</span><span style="background-color: #9bcc9b; color: black;"> </span><span style="background-color: #058205; color: black;">you</span><span style="background-color: #058205; color: black;"> </span><span style="background-color: #eaf2ea; color: black;">start</span><span style="background-color: #eaf2ea; color: black;"> </span><span style="background-color: #cae3ca; color: black;">solving</span><span style="background-color: #cae3ca; color: black;"> </span><span style="background-color: #8ac48a; color: black;">it</span><span style="background-color: #8ac48a; color: black;"> </span><span style="background-color: #008000; color: black;">a</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">few</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #008000; color: black;">times,</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #a5d1a5; color: black;">you</span><span style="background-color: #a5d1a5; color: black;"> </span><span style="background-color: #e7f1e7; color: black;">start</span><span style="background-color: #e7f1e7; color: black;"> </span><span style="background-color: #2b952b; color: black;">getting</span><span style="background-color: #2b952b; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">better</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #259225; color: black;">and</span><span style="background-color: #259225; color: black;"> </span><span style="background-color: #008000; color: black;">can</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #018001; color: black;">finish</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #0e870e; color: black;">the</span><span style="background-color: #0e870e; color: black;"> </span><span style="background-color: #b0d6b0; color: black;">puzzle</span><span style="background-color: #b0d6b0; color: black;"> </span><span style="background-color: #deedde; color: black;">faster.</span><span style="background-color: #deedde; color: black;"> </span><span style="background-color: #0b850b; color: black;">That's</span><span style="background-color: #0b850b; color: black;"> </span><span style="background-color: #349a34; color: black;">how</span><span style="background-color: #349a34; color: black;"> </span><span style="background-color: #e4f0e4; color: black;">machines</span><span style="background-color: #e4f0e4; color: black;"> </span><span style="background-color: #d7e9d7; color: black;">work</span><span style="background-color: #d7e9d7; color: black;"> </span><span style="background-color: #e5f0e5; color: black;">too,</span><span style="background-color: #e5f0e5; color: black;"> </span><span style="background-color: #028102; color: black;">they</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #1a8d1a; color: black;">start</span><span style="background-color: #1a8d1a; color: black;"> </span><span style="background-color: #118911; color: black;">with</span><span style="background-color: #118911; color: black;"> </span><span style="background-color: #58ab58; color: black;">learning</span><span style="background-color: #58ab58; color: black;"> </span><span style="background-color: #028102; color: black;">puzzles</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #a3d0a3; color: black;">and</span><span style="background-color: #a3d0a3; color: black;"> </span><span style="background-color: #e0eedf; color: black;">every</span><span style="background-color: #e0eedf; color: black;"> </span><span style="background-color: #eaf2ea; color: black;">time</span><span style="background-color: #eaf2ea; color: black;"> </span><span style="background-color: #088408; color: black;">they</span><span style="background-color: #088408; color: black;"> </span><span style="background-color: #dfeddf; color: black;">make</span><span style="background-color: #dfeddf; color: black;"> </span><span style="background-color: #a5d1a5; color: black;">a</span><span style="background-color: #a5d1a5; color: black;"> </span><span style="background-color: #a4d0a4; color: black;">mistake,</span><span style="background-color: #a4d0a4; color: black;"> </span><span style="background-color: #3c9d3c; color: black;">they</span><span style="background-color: #3c9d3c; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">remember</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">that</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #46a246; color: black;">and</span><span style="background-color: #46a246; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">try</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #008000; color: black;">not</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">to</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #e8f2e8; color: black;">make</span><span style="background-color: #e8f2e8; color: black;"> </span><span style="background-color: #0f870f; color: black;">the</span><span style="background-color: #0f870f; color: black;"> </span><span style="background-color: #028102; color: black;">same</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #0e870e; color: black;">mistake</span><span style="background-color: #0e870e; color: black;"> </span><span style="background-color: #018001; color: black;">again.</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #e9f2e9; color: black;">They</span><span style="background-color: #e9f2e9; color: black;"> </span><span style="background-color: #e6f1e6; color: black;">keep</span><span style="background-color: #e6f1e6; color: black;"> </span><span style="background-color: #65b265; color: black;">getting</span><span style="background-color: #65b265; color: black;"> </span><span style="background-color: #168b16; color: black;">better</span><span style="background-color: #168b16; color: black;"> </span><span style="background-color: #8ac48a; color: black;">and</span><span style="background-color: #8ac48a; color: black;"> </span><span style="background-color: #008000; color: black;">better!</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #3b9d3b; color: black;">They</span><span style="background-color: #3b9d3b; color: black;"> </span><span style="background-color: #79bc79; color: black;">can</span><span style="background-color: #79bc79; color: black;"> </span><span style="background-color: #008000; color: black;">use</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">what</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #078407; color: black;">they</span><span style="background-color: #078407; color: black;"> </span><span style="background-color: #1b8d1b; color: black;">have</span><span style="background-color: #1b8d1b; color: black;"> </span><span style="background-color: #a9d3a9; color: black;">learned</span><span style="background-color: #a9d3a9; color: black;"> </span><span style="background-color: #128912; color: black;">to</span><span style="background-color: #128912; color: black;"> </span><span style="background-color: #9acb9a; color: black;">help</span><span style="background-color: #9acb9a; color: black;"> </span><span style="background-color: #389b38; color: black;">us,</span><span style="background-color: #389b38; color: black;"> </span><span style="background-color: #2c962c; color: black;">like</span><span style="background-color: #2c962c; color: black;"> </span><span style="background-color: #1f8f1f; color: black;">find</span><span style="background-color: #1f8f1f; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">things</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #e8f2e8; color: black;">on</span><span style="background-color: #e8f2e8; color: black;"> </span><span style="background-color: #2b952b; color: black;">the</span><span style="background-color: #2b952b; color: black;"> </span><span style="background-color: #cde5cd; color: black;">internet</span><span style="background-color: #cde5cd; color: black;"> </span><span style="background-color: #b9dbb9; color: black;">or</span><span style="background-color: #b9dbb9; color: black;"> </span><span style="background-color: #008000; color: black;">even</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #d3e7d3; color: black;">drive</span><span style="background-color: #d3e7d3; color: black;"> </span><span style="background-color: #008000; color: black;">cars.</span><span style="background-color: #008000; color: black;"> </span></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1">probs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb28-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> res <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].logprobs.content:</span>
<span id="cb28-3">    probs.append(np.exp(res.logprob))</span>
<span id="cb28-4"></span>
<span id="cb28-5">plt.hist(probs)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-6">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probability"</span>)</span>
<span id="cb28-7">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span>
<span id="cb28-8">plt.show()</span>
<span id="cb28-9"></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature_files/figure-html/cell-23-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="temperature-1-default" class="level1">
<h1>Temperature : 1 ( Default)</h1>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"></span>
<span id="cb29-2">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb29-3">  model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model,</span>
<span id="cb29-4">  messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb29-5">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a helpful assistant."</span>},</span>
<span id="cb29-6">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: question}</span>
<span id="cb29-7">  ],</span>
<span id="cb29-8">  logprobs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb29-9">  temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb29-10">  seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seed</span>
<span id="cb29-11">)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1">highlight_openai_response(response)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="font-family: inherit; white-space: pre-wrap; word-break: break-all;"><span style="background-color: #008000; color: black;">Machine</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">learning</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">is</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #c4e0c4; color: black;">when</span><span style="background-color: #c4e0c4; color: black;"> </span><span style="background-color: #349934; color: black;">computers</span><span style="background-color: #349934; color: black;"> </span><span style="background-color: #50a750; color: black;">learn</span><span style="background-color: #50a750; color: black;"> </span><span style="background-color: #c9e2c8; color: black;">things</span><span style="background-color: #c9e2c8; color: black;"> </span><span style="background-color: #67b267; color: black;">on</span><span style="background-color: #67b267; color: black;"> </span><span style="background-color: #008000; color: black;">their</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">own,</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #57ab57; color: black;">just</span><span style="background-color: #57ab57; color: black;"> </span><span style="background-color: #81bf81; color: black;">like</span><span style="background-color: #81bf81; color: black;"> </span><span style="background-color: #008000; color: black;">how</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #2f972f; color: black;">you</span><span style="background-color: #2f972f; color: black;"> </span><span style="background-color: #369b36; color: black;">learn</span><span style="background-color: #369b36; color: black;"> </span><span style="background-color: #008000; color: black;">new</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #1e8f1e; color: black;">things.</span><span style="background-color: #1e8f1e; color: black;"> </span><span style="background-color: #008000; color: black;">Imagine</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #afd6af; color: black;">you</span><span style="background-color: #afd6af; color: black;"> </span><span style="background-color: #83c083; color: black;">have</span><span style="background-color: #83c083; color: black;"> </span><span style="background-color: #128912; color: black;">a</span><span style="background-color: #128912; color: black;"> </span><span style="background-color: #058205; color: black;">special</span><span style="background-color: #058205; color: black;"> </span><span style="background-color: #018001; color: black;">toy</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #b3d8b3; color: black;">that</span><span style="background-color: #b3d8b3; color: black;"> </span><span style="background-color: #86c286; color: black;">can</span><span style="background-color: #86c286; color: black;"> </span><span style="background-color: #078407; color: black;">remember</span><span style="background-color: #078407; color: black;"> </span><span style="background-color: #1f8f1f; color: black;">things</span><span style="background-color: #1f8f1f; color: black;"> </span><span style="background-color: #e8f2e8; color: black;">it</span><span style="background-color: #e8f2e8; color: black;"> </span><span style="background-color: #9fce9f; color: black;">sees</span><span style="background-color: #9fce9f; color: black;"> </span><span style="background-color: #e5f0e5; color: black;">and</span><span style="background-color: #e5f0e5; color: black;"> </span><span style="background-color: #1f8f1f; color: black;">hears.</span><span style="background-color: #1f8f1f; color: black;"> </span><span style="background-color: #55a955; color: black;">When</span><span style="background-color: #55a955; color: black;"> </span><span style="background-color: #349a34; color: black;">you</span><span style="background-color: #349a34; color: black;"> </span><span style="background-color: #058205; color: black;">show</span><span style="background-color: #058205; color: black;"> </span><span style="background-color: #a5d1a5; color: black;">it</span><span style="background-color: #a5d1a5; color: black;"> </span><span style="background-color: #068306; color: black;">a</span><span style="background-color: #068306; color: black;"> </span><span style="background-color: #0b850b; color: black;">picture</span><span style="background-color: #0b850b; color: black;"> </span><span style="background-color: #399c39; color: black;">of</span><span style="background-color: #399c39; color: black;"> </span><span style="background-color: #1c8e1c; color: black;">a</span><span style="background-color: #1c8e1c; color: black;"> </span><span style="background-color: #1d8e1d; color: black;">cat</span><span style="background-color: #1d8e1d; color: black;"> </span><span style="background-color: #018001; color: black;">and</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #0a850a; color: black;">tell</span><span style="background-color: #0a850a; color: black;"> </span><span style="background-color: #57ab57; color: black;">it</span><span style="background-color: #57ab57; color: black;"> </span><span style="background-color: #68b368; color: black;">"this</span><span style="background-color: #68b368; color: black;"> </span><span style="background-color: #4ba54b; color: black;">is</span><span style="background-color: #4ba54b; color: black;"> </span><span style="background-color: #008000; color: black;">a</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #a6d2a6; color: black;">cat,"</span><span style="background-color: #a6d2a6; color: black;"> </span><span style="background-color: #56aa56; color: black;">the</span><span style="background-color: #56aa56; color: black;"> </span><span style="background-color: #008000; color: black;">toy</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">remembers</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">that.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #3b9d3b; color: black;">Then,</span><span style="background-color: #3b9d3b; color: black;"> </span><span style="background-color: #a6d2a6; color: black;">when</span><span style="background-color: #a6d2a6; color: black;"> </span><span style="background-color: #008000; color: black;">you</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #399c39; color: black;">show</span><span style="background-color: #399c39; color: black;"> </span><span style="background-color: #43a143; color: black;">it</span><span style="background-color: #43a143; color: black;"> </span><span style="background-color: #4ca54c; color: black;">another</span><span style="background-color: #4ca54c; color: black;"> </span><span style="background-color: #239123; color: black;">picture</span><span style="background-color: #239123; color: black;"> </span><span style="background-color: #0c860c; color: black;">of</span><span style="background-color: #0c860c; color: black;"> </span><span style="background-color: #188c18; color: black;">a</span><span style="background-color: #188c18; color: black;"> </span><span style="background-color: #0b850b; color: black;">cat</span><span style="background-color: #0b850b; color: black;"> </span><span style="background-color: #008000; color: black;">without</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #018001; color: black;">telling</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #86c286; color: black;">it</span><span style="background-color: #86c286; color: black;"> </span><span style="background-color: #008000; color: black;">anything,</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #2d962d; color: black;">the</span><span style="background-color: #2d962d; color: black;"> </span><span style="background-color: #018001; color: black;">toy</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #048204; color: black;">can</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #dcecdc; color: black;">recognize</span><span style="background-color: #dcecdc; color: black;"> </span><span style="background-color: #138913; color: black;">that</span><span style="background-color: #138913; color: black;"> </span><span style="background-color: #008000; color: black;">it's</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #85c185; color: black;">a</span><span style="background-color: #85c185; color: black;"> </span><span style="background-color: #008000; color: black;">cat</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #1c8e1c; color: black;">too!</span><span style="background-color: #1c8e1c; color: black;"> </span><span style="background-color: #008000; color: black;">This</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #229122; color: black;">is</span><span style="background-color: #229122; color: black;"> </span><span style="background-color: #c9e3c9; color: black;">because</span><span style="background-color: #c9e3c9; color: black;"> </span><span style="background-color: #56aa56; color: black;">the</span><span style="background-color: #56aa56; color: black;"> </span><span style="background-color: #008000; color: black;">toy</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #3d9e3d; color: black;">learned</span><span style="background-color: #3d9e3d; color: black;"> </span><span style="background-color: #138913; color: black;">from</span><span style="background-color: #138913; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #96c996; color: black;">first</span><span style="background-color: #96c996; color: black;"> </span><span style="background-color: #7bbc7b; color: black;">picture.</span><span style="background-color: #7bbc7b; color: black;"> </span><span style="background-color: #7bbc7b;"> </span><br><span style="background-color: #7bbc7b;"> </span><br><span style="background-color: #dcecdc; color: black;">Machine</span><span style="background-color: #dcecdc; color: black;"> </span><span style="background-color: #018001; color: black;">learning</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #63b163; color: black;">is</span><span style="background-color: #63b163; color: black;"> </span><span style="background-color: #128912; color: black;">like</span><span style="background-color: #128912; color: black;"> </span><span style="background-color: #008000; color: black;">that</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #8fc68f; color: black;">toy,</span><span style="background-color: #8fc68f; color: black;"> </span><span style="background-color: #369b36; color: black;">but</span><span style="background-color: #369b36; color: black;"> </span><span style="background-color: #038103; color: black;">with</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #018001; color: black;">big</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #028102; color: black;">computers.</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #62b062; color: black;">They</span><span style="background-color: #62b062; color: black;"> </span><span style="background-color: #8dc58d; color: black;">can</span><span style="background-color: #8dc58d; color: black;"> </span><span style="background-color: #a3d0a3; color: black;">learn</span><span style="background-color: #a3d0a3; color: black;"> </span><span style="background-color: #008000; color: black;">from</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #4ca54c; color: black;">lots</span><span style="background-color: #4ca54c; color: black;"> </span><span style="background-color: #3a9c3a; color: black;">of</span><span style="background-color: #3a9c3a; color: black;"> </span><span style="background-color: #75b975; color: black;">pictures,</span><span style="background-color: #75b975; color: black;"> </span><span style="background-color: #84c184; color: black;">sounds,</span><span style="background-color: #84c184; color: black;"> </span><span style="background-color: #209020; color: black;">and</span><span style="background-color: #209020; color: black;"> </span><span style="background-color: #028102; color: black;">information</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #c4e0c4; color: black;">to</span><span style="background-color: #c4e0c4; color: black;"> </span><span style="background-color: #c6e1c6; color: black;">understand</span><span style="background-color: #c6e1c6; color: black;"> </span><span style="background-color: #289328; color: black;">things</span><span style="background-color: #289328; color: black;"> </span><span style="background-color: #54a954; color: black;">all</span><span style="background-color: #54a954; color: black;"> </span><span style="background-color: #66b266; color: black;">by</span><span style="background-color: #66b266; color: black;"> </span><span style="background-color: #2b952b; color: black;">themselves.</span><span style="background-color: #2b952b; color: black;"> </span><span style="background-color: #1d8e1d; color: black;">The</span><span style="background-color: #1d8e1d; color: black;"> </span><span style="background-color: #279327; color: black;">more</span><span style="background-color: #279327; color: black;"> </span><span style="background-color: #0a850a; color: black;">they</span><span style="background-color: #0a850a; color: black;"> </span><span style="background-color: #56aa56; color: black;">learn,</span><span style="background-color: #56aa56; color: black;"> </span><span style="background-color: #1e8f1e; color: black;">the</span><span style="background-color: #1e8f1e; color: black;"> </span><span style="background-color: #5eae5e; color: black;">smarter</span><span style="background-color: #5eae5e; color: black;"> </span><span style="background-color: #048204; color: black;">they</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #008000; color: black;">become.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #42a042; color: black;">They</span><span style="background-color: #42a042; color: black;"> </span><span style="background-color: #b9dbb9; color: black;">can</span><span style="background-color: #b9dbb9; color: black;"> </span><span style="background-color: #4fa74f; color: black;">even</span><span style="background-color: #4fa74f; color: black;"> </span><span style="background-color: #b4d8b4; color: black;">help</span><span style="background-color: #b4d8b4; color: black;"> </span><span style="background-color: #7ebe7e; color: black;">us</span><span style="background-color: #7ebe7e; color: black;"> </span><span style="background-color: #e0eee0; color: black;">do</span><span style="background-color: #e0eee0; color: black;"> </span><span style="background-color: #088408; color: black;">things</span><span style="background-color: #088408; color: black;"> </span><span style="background-color: #008000; color: black;">like</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #028102; color: black;">finding</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #eaf2ea; color: black;">answers</span><span style="background-color: #eaf2ea; color: black;"> </span><span style="background-color: #138913; color: black;">to</span><span style="background-color: #138913; color: black;"> </span><span style="background-color: #4ea64e; color: black;">questions,</span><span style="background-color: #4ea64e; color: black;"> </span><span style="background-color: #018001; color: black;">predicting</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #008000; color: black;">what</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">might</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #91c791; color: black;">happen</span><span style="background-color: #91c791; color: black;"> </span><span style="background-color: #018001; color: black;">next,</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #309730; color: black;">and</span><span style="background-color: #309730; color: black;"> </span><span style="background-color: #89c389; color: black;">making</span><span style="background-color: #89c389; color: black;"> </span><span style="background-color: #389b38; color: black;">decisions.</span><span style="background-color: #389b38; color: black;"> </span><span style="background-color: #028102; color: black;">It's</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #9ccd9c; color: black;">like</span><span style="background-color: #9ccd9c; color: black;"> </span><span style="background-color: #389b38; color: black;">having</span><span style="background-color: #389b38; color: black;"> </span><span style="background-color: #86c286; color: black;">a</span><span style="background-color: #86c286; color: black;"> </span><span style="background-color: #7abc7a; color: black;">really</span><span style="background-color: #7abc7a; color: black;"> </span><span style="background-color: #2d962d; color: black;">smart</span><span style="background-color: #2d962d; color: black;"> </span><span style="background-color: #289428; color: black;">friend</span><span style="background-color: #289428; color: black;"> </span><span style="background-color: #b2d7b2; color: black;">who</span><span style="background-color: #b2d7b2; color: black;"> </span><span style="background-color: #e5f0e5; color: black;">knows</span><span style="background-color: #e5f0e5; color: black;"> </span><span style="background-color: #178b17; color: black;">so</span><span style="background-color: #178b17; color: black;"> </span><span style="background-color: #239123; color: black;">many</span><span style="background-color: #239123; color: black;"> </span><span style="background-color: #63b163; color: black;">things!</span><span style="background-color: #63b163; color: black;"> </span></pre>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1">probs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb31-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> res <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].logprobs.content:</span>
<span id="cb31-3">    probs.append(np.exp(res.logprob))</span>
<span id="cb31-4"></span>
<span id="cb31-5">plt.hist(probs)</span>
<span id="cb31-6">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probability"</span>)</span>
<span id="cb31-7">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span>
<span id="cb31-8">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature_files/figure-html/cell-26-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="openai-recommendations-for-temperature" class="level1">
<h1>OpenAI Recommendations for Temperature</h1>
<p><img src="https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature_files/figure-html/803b5454-1-image-3.png" class="img-fluid" alt="image-3.png"> - default is 1 - range: 0 to 2 <img src="https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature_files/figure-html/803b5454-2-image.png" class="img-fluid" alt="image.png"></p>
</section>
<section id="top-p-nucleus-sampling" class="level1">
<h1>Top-P (Nucleus Sampling)</h1>
<p>Top-p sampling, also known as nucleus sampling, is a technique used in large language models to control the diversity and quality of generated text. It involves selecting tokens from the most probable options, where the sum of their probabilities determines the selection.</p>
<p>The “top p” parameter acts as a filter, controlling how many different words or phrases the model considers when predicting the next word. The lower the value of <code>p</code>, the more deterministic the responses generated by the model are.</p>
<p>This method helps balance between diversity and high-probability words, ensuring the output is both diverse and contextually relevant.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1">df_p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'word'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'base_probability'</span>]].copy()</span>
<span id="cb32-2"></span>
<span id="cb32-3">df_p[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cumulative_probability'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df_p[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'base_probability'</span>].cumsum()</span>
<span id="cb32-4"></span>
<span id="cb32-5">df_p</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">word</th>
<th data-quarto-table-cell-role="th">base_probability</th>
<th data-quarto-table-cell-role="th">cumulative_probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>word0</td>
<td>0.19</td>
<td>0.19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>word1</td>
<td>0.12</td>
<td>0.31</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>word2</td>
<td>0.10</td>
<td>0.41</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>word3</td>
<td>0.09</td>
<td>0.50</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>word4</td>
<td>0.08</td>
<td>0.58</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>word5</td>
<td>0.07</td>
<td>0.65</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>word6</td>
<td>0.06</td>
<td>0.71</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>word7</td>
<td>0.05</td>
<td>0.76</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>word8</td>
<td>0.04</td>
<td>0.80</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>word9</td>
<td>0.03</td>
<td>0.83</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>word10</td>
<td>0.03</td>
<td>0.86</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>word11</td>
<td>0.03</td>
<td>0.89</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>word12</td>
<td>0.02</td>
<td>0.91</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>word13</td>
<td>0.02</td>
<td>0.93</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>word14</td>
<td>0.02</td>
<td>0.95</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>word15</td>
<td>0.01</td>
<td>0.96</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>word16</td>
<td>0.01</td>
<td>0.97</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>word17</td>
<td>0.01</td>
<td>0.98</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>word18</td>
<td>0.01</td>
<td>0.99</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>word19</td>
<td>0.01</td>
<td>1.00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1">df_p.style.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">apply</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">lambda</span> x: [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'background: yellow'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> x.cumulative_probability <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> x], axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<style type="text/css">
#T_b7719_row0_col0, #T_b7719_row0_col1, #T_b7719_row0_col2, #T_b7719_row1_col0, #T_b7719_row1_col1, #T_b7719_row1_col2, #T_b7719_row2_col0, #T_b7719_row2_col1, #T_b7719_row2_col2, #T_b7719_row3_col0, #T_b7719_row3_col1, #T_b7719_row3_col2, #T_b7719_row4_col0, #T_b7719_row4_col1, #T_b7719_row4_col2, #T_b7719_row5_col0, #T_b7719_row5_col1, #T_b7719_row5_col2, #T_b7719_row6_col0, #T_b7719_row6_col1, #T_b7719_row6_col2, #T_b7719_row7_col0, #T_b7719_row7_col1, #T_b7719_row7_col2, #T_b7719_row8_col0, #T_b7719_row8_col1, #T_b7719_row8_col2 {
  background: yellow;
}
</style>

<table id="T_b7719" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_b7719_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">word</th>
<th id="T_b7719_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">base_probability</th>
<th id="T_b7719_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">cumulative_probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_b7719_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_b7719_row0_col0" class="data row0 col0">word0</td>
<td id="T_b7719_row0_col1" class="data row0 col1">0.190000</td>
<td id="T_b7719_row0_col2" class="data row0 col2">0.190000</td>
</tr>
<tr class="even">
<td id="T_b7719_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_b7719_row1_col0" class="data row1 col0">word1</td>
<td id="T_b7719_row1_col1" class="data row1 col1">0.120000</td>
<td id="T_b7719_row1_col2" class="data row1 col2">0.310000</td>
</tr>
<tr class="odd">
<td id="T_b7719_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_b7719_row2_col0" class="data row2 col0">word2</td>
<td id="T_b7719_row2_col1" class="data row2 col1">0.100000</td>
<td id="T_b7719_row2_col2" class="data row2 col2">0.410000</td>
</tr>
<tr class="even">
<td id="T_b7719_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_b7719_row3_col0" class="data row3 col0">word3</td>
<td id="T_b7719_row3_col1" class="data row3 col1">0.090000</td>
<td id="T_b7719_row3_col2" class="data row3 col2">0.500000</td>
</tr>
<tr class="odd">
<td id="T_b7719_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">4</td>
<td id="T_b7719_row4_col0" class="data row4 col0">word4</td>
<td id="T_b7719_row4_col1" class="data row4 col1">0.080000</td>
<td id="T_b7719_row4_col2" class="data row4 col2">0.580000</td>
</tr>
<tr class="even">
<td id="T_b7719_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">5</td>
<td id="T_b7719_row5_col0" class="data row5 col0">word5</td>
<td id="T_b7719_row5_col1" class="data row5 col1">0.070000</td>
<td id="T_b7719_row5_col2" class="data row5 col2">0.650000</td>
</tr>
<tr class="odd">
<td id="T_b7719_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">6</td>
<td id="T_b7719_row6_col0" class="data row6 col0">word6</td>
<td id="T_b7719_row6_col1" class="data row6 col1">0.060000</td>
<td id="T_b7719_row6_col2" class="data row6 col2">0.710000</td>
</tr>
<tr class="even">
<td id="T_b7719_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">7</td>
<td id="T_b7719_row7_col0" class="data row7 col0">word7</td>
<td id="T_b7719_row7_col1" class="data row7 col1">0.050000</td>
<td id="T_b7719_row7_col2" class="data row7 col2">0.760000</td>
</tr>
<tr class="odd">
<td id="T_b7719_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">8</td>
<td id="T_b7719_row8_col0" class="data row8 col0">word8</td>
<td id="T_b7719_row8_col1" class="data row8 col1">0.040000</td>
<td id="T_b7719_row8_col2" class="data row8 col2">0.800000</td>
</tr>
<tr class="even">
<td id="T_b7719_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">9</td>
<td id="T_b7719_row9_col0" class="data row9 col0">word9</td>
<td id="T_b7719_row9_col1" class="data row9 col1">0.030000</td>
<td id="T_b7719_row9_col2" class="data row9 col2">0.830000</td>
</tr>
<tr class="odd">
<td id="T_b7719_level0_row10" class="row_heading level0 row10" data-quarto-table-cell-role="th">10</td>
<td id="T_b7719_row10_col0" class="data row10 col0">word10</td>
<td id="T_b7719_row10_col1" class="data row10 col1">0.030000</td>
<td id="T_b7719_row10_col2" class="data row10 col2">0.860000</td>
</tr>
<tr class="even">
<td id="T_b7719_level0_row11" class="row_heading level0 row11" data-quarto-table-cell-role="th">11</td>
<td id="T_b7719_row11_col0" class="data row11 col0">word11</td>
<td id="T_b7719_row11_col1" class="data row11 col1">0.030000</td>
<td id="T_b7719_row11_col2" class="data row11 col2">0.890000</td>
</tr>
<tr class="odd">
<td id="T_b7719_level0_row12" class="row_heading level0 row12" data-quarto-table-cell-role="th">12</td>
<td id="T_b7719_row12_col0" class="data row12 col0">word12</td>
<td id="T_b7719_row12_col1" class="data row12 col1">0.020000</td>
<td id="T_b7719_row12_col2" class="data row12 col2">0.910000</td>
</tr>
<tr class="even">
<td id="T_b7719_level0_row13" class="row_heading level0 row13" data-quarto-table-cell-role="th">13</td>
<td id="T_b7719_row13_col0" class="data row13 col0">word13</td>
<td id="T_b7719_row13_col1" class="data row13 col1">0.020000</td>
<td id="T_b7719_row13_col2" class="data row13 col2">0.930000</td>
</tr>
<tr class="odd">
<td id="T_b7719_level0_row14" class="row_heading level0 row14" data-quarto-table-cell-role="th">14</td>
<td id="T_b7719_row14_col0" class="data row14 col0">word14</td>
<td id="T_b7719_row14_col1" class="data row14 col1">0.020000</td>
<td id="T_b7719_row14_col2" class="data row14 col2">0.950000</td>
</tr>
<tr class="even">
<td id="T_b7719_level0_row15" class="row_heading level0 row15" data-quarto-table-cell-role="th">15</td>
<td id="T_b7719_row15_col0" class="data row15 col0">word15</td>
<td id="T_b7719_row15_col1" class="data row15 col1">0.010000</td>
<td id="T_b7719_row15_col2" class="data row15 col2">0.960000</td>
</tr>
<tr class="odd">
<td id="T_b7719_level0_row16" class="row_heading level0 row16" data-quarto-table-cell-role="th">16</td>
<td id="T_b7719_row16_col0" class="data row16 col0">word16</td>
<td id="T_b7719_row16_col1" class="data row16 col1">0.010000</td>
<td id="T_b7719_row16_col2" class="data row16 col2">0.970000</td>
</tr>
<tr class="even">
<td id="T_b7719_level0_row17" class="row_heading level0 row17" data-quarto-table-cell-role="th">17</td>
<td id="T_b7719_row17_col0" class="data row17 col0">word17</td>
<td id="T_b7719_row17_col1" class="data row17 col1">0.010000</td>
<td id="T_b7719_row17_col2" class="data row17 col2">0.980000</td>
</tr>
<tr class="odd">
<td id="T_b7719_level0_row18" class="row_heading level0 row18" data-quarto-table-cell-role="th">18</td>
<td id="T_b7719_row18_col0" class="data row18 col0">word18</td>
<td id="T_b7719_row18_col1" class="data row18 col1">0.010000</td>
<td id="T_b7719_row18_col2" class="data row18 col2">0.990000</td>
</tr>
<tr class="even">
<td id="T_b7719_level0_row19" class="row_heading level0 row19" data-quarto-table-cell-role="th">19</td>
<td id="T_b7719_row19_col0" class="data row19 col0">word19</td>
<td id="T_b7719_row19_col1" class="data row19 col1">0.010000</td>
<td id="T_b7719_row19_col2" class="data row19 col2">1.000000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1">df_p[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"base_probability"</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>1.0</code></pre>
</div>
</div>
<section id="high-top-p-includes-more-tokens-to-sample" class="level3">
<h3 class="anchored" data-anchor-id="high-top-p-includes-more-tokens-to-sample">High Top-P ( Includes more tokens to sample)</h3>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"></span>
<span id="cb36-2">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb36-3">  model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model,</span>
<span id="cb36-4">  messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb36-5">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a helpful assistant."</span>},</span>
<span id="cb36-6">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: question}</span>
<span id="cb36-7">  ],</span>
<span id="cb36-8">  logprobs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb36-9">  top_p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb36-10">  seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seed</span>
<span id="cb36-11">)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].message.content)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Machine learning is when computers learn things on their own, just like how you learn new things. Imagine you have a special toy that can remember things it sees and hears. When you show it a picture of a cat and tell it "this is a cat," the toy remembers that. Then, when you show it another picture of a cat without telling it anything, the toy can recognize that it's a cat too! This is because the toy learned from the first picture. 

Machine learning is like that toy, but with big computers. They can learn from lots of pictures, sounds, and information to understand things all by themselves. The more they learn, the smarter they become. They can even help us do things like finding answers to questions, predicting what might happen next, and making decisions. It's like having a really smart friend who knows so many things!</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1">highlight_openai_response(response)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="font-family: inherit; white-space: pre-wrap; word-break: break-all;"><span style="background-color: #008000; color: black;">Machine</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">learning</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">is</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #c4e0c4; color: black;">when</span><span style="background-color: #c4e0c4; color: black;"> </span><span style="background-color: #349934; color: black;">computers</span><span style="background-color: #349934; color: black;"> </span><span style="background-color: #50a750; color: black;">learn</span><span style="background-color: #50a750; color: black;"> </span><span style="background-color: #c9e2c8; color: black;">things</span><span style="background-color: #c9e2c8; color: black;"> </span><span style="background-color: #67b267; color: black;">on</span><span style="background-color: #67b267; color: black;"> </span><span style="background-color: #008000; color: black;">their</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">own,</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #58ab58; color: black;">just</span><span style="background-color: #58ab58; color: black;"> </span><span style="background-color: #81bf81; color: black;">like</span><span style="background-color: #81bf81; color: black;"> </span><span style="background-color: #008000; color: black;">how</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #339933; color: black;">you</span><span style="background-color: #339933; color: black;"> </span><span style="background-color: #369b36; color: black;">learn</span><span style="background-color: #369b36; color: black;"> </span><span style="background-color: #008000; color: black;">new</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #1d8e1d; color: black;">things.</span><span style="background-color: #1d8e1d; color: black;"> </span><span style="background-color: #008000; color: black;">Imagine</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #afd6af; color: black;">you</span><span style="background-color: #afd6af; color: black;"> </span><span style="background-color: #83c083; color: black;">have</span><span style="background-color: #83c083; color: black;"> </span><span style="background-color: #128912; color: black;">a</span><span style="background-color: #128912; color: black;"> </span><span style="background-color: #058205; color: black;">special</span><span style="background-color: #058205; color: black;"> </span><span style="background-color: #018001; color: black;">toy</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #b3d8b3; color: black;">that</span><span style="background-color: #b3d8b3; color: black;"> </span><span style="background-color: #86c286; color: black;">can</span><span style="background-color: #86c286; color: black;"> </span><span style="background-color: #078407; color: black;">remember</span><span style="background-color: #078407; color: black;"> </span><span style="background-color: #209020; color: black;">things</span><span style="background-color: #209020; color: black;"> </span><span style="background-color: #e8f2e8; color: black;">it</span><span style="background-color: #e8f2e8; color: black;"> </span><span style="background-color: #9fce9f; color: black;">sees</span><span style="background-color: #9fce9f; color: black;"> </span><span style="background-color: #e5f0e5; color: black;">and</span><span style="background-color: #e5f0e5; color: black;"> </span><span style="background-color: #1f8f1f; color: black;">hears.</span><span style="background-color: #1f8f1f; color: black;"> </span><span style="background-color: #55a955; color: black;">When</span><span style="background-color: #55a955; color: black;"> </span><span style="background-color: #359a35; color: black;">you</span><span style="background-color: #359a35; color: black;"> </span><span style="background-color: #058205; color: black;">show</span><span style="background-color: #058205; color: black;"> </span><span style="background-color: #a5d1a5; color: black;">it</span><span style="background-color: #a5d1a5; color: black;"> </span><span style="background-color: #068306; color: black;">a</span><span style="background-color: #068306; color: black;"> </span><span style="background-color: #0b850b; color: black;">picture</span><span style="background-color: #0b850b; color: black;"> </span><span style="background-color: #389b38; color: black;">of</span><span style="background-color: #389b38; color: black;"> </span><span style="background-color: #1b8d1b; color: black;">a</span><span style="background-color: #1b8d1b; color: black;"> </span><span style="background-color: #1d8e1d; color: black;">cat</span><span style="background-color: #1d8e1d; color: black;"> </span><span style="background-color: #018001; color: black;">and</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #0a850a; color: black;">tell</span><span style="background-color: #0a850a; color: black;"> </span><span style="background-color: #57ab57; color: black;">it</span><span style="background-color: #57ab57; color: black;"> </span><span style="background-color: #67b267; color: black;">"this</span><span style="background-color: #67b267; color: black;"> </span><span style="background-color: #4ba54b; color: black;">is</span><span style="background-color: #4ba54b; color: black;"> </span><span style="background-color: #008000; color: black;">a</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #a6d2a6; color: black;">cat,"</span><span style="background-color: #a6d2a6; color: black;"> </span><span style="background-color: #56aa56; color: black;">the</span><span style="background-color: #56aa56; color: black;"> </span><span style="background-color: #008000; color: black;">toy</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">remembers</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">that.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #3a9c3a; color: black;">Then,</span><span style="background-color: #3a9c3a; color: black;"> </span><span style="background-color: #a7d2a7; color: black;">when</span><span style="background-color: #a7d2a7; color: black;"> </span><span style="background-color: #008000; color: black;">you</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #399c39; color: black;">show</span><span style="background-color: #399c39; color: black;"> </span><span style="background-color: #42a042; color: black;">it</span><span style="background-color: #42a042; color: black;"> </span><span style="background-color: #4ba54b; color: black;">another</span><span style="background-color: #4ba54b; color: black;"> </span><span style="background-color: #229122; color: black;">picture</span><span style="background-color: #229122; color: black;"> </span><span style="background-color: #0c860c; color: black;">of</span><span style="background-color: #0c860c; color: black;"> </span><span style="background-color: #188c18; color: black;">a</span><span style="background-color: #188c18; color: black;"> </span><span style="background-color: #0a850a; color: black;">cat</span><span style="background-color: #0a850a; color: black;"> </span><span style="background-color: #008000; color: black;">without</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #018001; color: black;">telling</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #85c185; color: black;">it</span><span style="background-color: #85c185; color: black;"> </span><span style="background-color: #008000; color: black;">anything,</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #2d962d; color: black;">the</span><span style="background-color: #2d962d; color: black;"> </span><span style="background-color: #018001; color: black;">toy</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #048204; color: black;">can</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #dcecdc; color: black;">recognize</span><span style="background-color: #dcecdc; color: black;"> </span><span style="background-color: #128912; color: black;">that</span><span style="background-color: #128912; color: black;"> </span><span style="background-color: #008000; color: black;">it's</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #86c286; color: black;">a</span><span style="background-color: #86c286; color: black;"> </span><span style="background-color: #008000; color: black;">cat</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #1d8e1d; color: black;">too!</span><span style="background-color: #1d8e1d; color: black;"> </span><span style="background-color: #008000; color: black;">This</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #239123; color: black;">is</span><span style="background-color: #239123; color: black;"> </span><span style="background-color: #c9e3c9; color: black;">because</span><span style="background-color: #c9e3c9; color: black;"> </span><span style="background-color: #54a954; color: black;">the</span><span style="background-color: #54a954; color: black;"> </span><span style="background-color: #008000; color: black;">toy</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #3e9e3e; color: black;">learned</span><span style="background-color: #3e9e3e; color: black;"> </span><span style="background-color: #118911; color: black;">from</span><span style="background-color: #118911; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #98ca98; color: black;">first</span><span style="background-color: #98ca98; color: black;"> </span><span style="background-color: #78bb78; color: black;">picture.</span><span style="background-color: #78bb78; color: black;"> </span><span style="background-color: #78bb78;"> </span><br><span style="background-color: #78bb78;"> </span><br><span style="background-color: #dcecdc; color: black;">Machine</span><span style="background-color: #dcecdc; color: black;"> </span><span style="background-color: #018001; color: black;">learning</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #66b266; color: black;">is</span><span style="background-color: #66b266; color: black;"> </span><span style="background-color: #128912; color: black;">like</span><span style="background-color: #128912; color: black;"> </span><span style="background-color: #008000; color: black;">that</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #8fc68f; color: black;">toy,</span><span style="background-color: #8fc68f; color: black;"> </span><span style="background-color: #369b36; color: black;">but</span><span style="background-color: #369b36; color: black;"> </span><span style="background-color: #038103; color: black;">with</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #018001; color: black;">big</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #028102; color: black;">computers.</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #56aa56; color: black;">They</span><span style="background-color: #56aa56; color: black;"> </span><span style="background-color: #90c790; color: black;">can</span><span style="background-color: #90c790; color: black;"> </span><span style="background-color: #a5d1a5; color: black;">learn</span><span style="background-color: #a5d1a5; color: black;"> </span><span style="background-color: #008000; color: black;">from</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #4ba54b; color: black;">lots</span><span style="background-color: #4ba54b; color: black;"> </span><span style="background-color: #3a9c3a; color: black;">of</span><span style="background-color: #3a9c3a; color: black;"> </span><span style="background-color: #78bb78; color: black;">pictures,</span><span style="background-color: #78bb78; color: black;"> </span><span style="background-color: #84c184; color: black;">sounds,</span><span style="background-color: #84c184; color: black;"> </span><span style="background-color: #209020; color: black;">and</span><span style="background-color: #209020; color: black;"> </span><span style="background-color: #028102; color: black;">information</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #c3e0c3; color: black;">to</span><span style="background-color: #c3e0c3; color: black;"> </span><span style="background-color: #c6e1c6; color: black;">understand</span><span style="background-color: #c6e1c6; color: black;"> </span><span style="background-color: #279327; color: black;">things</span><span style="background-color: #279327; color: black;"> </span><span style="background-color: #53a953; color: black;">all</span><span style="background-color: #53a953; color: black;"> </span><span style="background-color: #62b062; color: black;">by</span><span style="background-color: #62b062; color: black;"> </span><span style="background-color: #2b952b; color: black;">themselves.</span><span style="background-color: #2b952b; color: black;"> </span><span style="background-color: #1c8e1c; color: black;">The</span><span style="background-color: #1c8e1c; color: black;"> </span><span style="background-color: #239123; color: black;">more</span><span style="background-color: #239123; color: black;"> </span><span style="background-color: #0a850a; color: black;">they</span><span style="background-color: #0a850a; color: black;"> </span><span style="background-color: #55a955; color: black;">learn,</span><span style="background-color: #55a955; color: black;"> </span><span style="background-color: #209020; color: black;">the</span><span style="background-color: #209020; color: black;"> </span><span style="background-color: #5cad5c; color: black;">smarter</span><span style="background-color: #5cad5c; color: black;"> </span><span style="background-color: #048204; color: black;">they</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #008000; color: black;">become.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #3f9f3f; color: black;">They</span><span style="background-color: #3f9f3f; color: black;"> </span><span style="background-color: #b5d9b5; color: black;">can</span><span style="background-color: #b5d9b5; color: black;"> </span><span style="background-color: #4fa74f; color: black;">even</span><span style="background-color: #4fa74f; color: black;"> </span><span style="background-color: #b3d8b3; color: black;">help</span><span style="background-color: #b3d8b3; color: black;"> </span><span style="background-color: #7fbe7f; color: black;">us</span><span style="background-color: #7fbe7f; color: black;"> </span><span style="background-color: #e0eee0; color: black;">do</span><span style="background-color: #e0eee0; color: black;"> </span><span style="background-color: #088408; color: black;">things</span><span style="background-color: #088408; color: black;"> </span><span style="background-color: #008000; color: black;">like</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #028102; color: black;">finding</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #eaf2ea; color: black;">answers</span><span style="background-color: #eaf2ea; color: black;"> </span><span style="background-color: #148a14; color: black;">to</span><span style="background-color: #148a14; color: black;"> </span><span style="background-color: #4da64d; color: black;">questions,</span><span style="background-color: #4da64d; color: black;"> </span><span style="background-color: #018001; color: black;">predicting</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #008000; color: black;">what</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">might</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #92c892; color: black;">happen</span><span style="background-color: #92c892; color: black;"> </span><span style="background-color: #018001; color: black;">next,</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #319831; color: black;">and</span><span style="background-color: #319831; color: black;"> </span><span style="background-color: #87c287; color: black;">making</span><span style="background-color: #87c287; color: black;"> </span><span style="background-color: #359a35; color: black;">decisions.</span><span style="background-color: #359a35; color: black;"> </span><span style="background-color: #028102; color: black;">It's</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #9ece9e; color: black;">like</span><span style="background-color: #9ece9e; color: black;"> </span><span style="background-color: #379b37; color: black;">having</span><span style="background-color: #379b37; color: black;"> </span><span style="background-color: #86c286; color: black;">a</span><span style="background-color: #86c286; color: black;"> </span><span style="background-color: #7abc7a; color: black;">really</span><span style="background-color: #7abc7a; color: black;"> </span><span style="background-color: #2c962c; color: black;">smart</span><span style="background-color: #2c962c; color: black;"> </span><span style="background-color: #289428; color: black;">friend</span><span style="background-color: #289428; color: black;"> </span><span style="background-color: #b3d8b3; color: black;">who</span><span style="background-color: #b3d8b3; color: black;"> </span><span style="background-color: #e5f0e5; color: black;">knows</span><span style="background-color: #e5f0e5; color: black;"> </span><span style="background-color: #178b17; color: black;">so</span><span style="background-color: #178b17; color: black;"> </span><span style="background-color: #229122; color: black;">many</span><span style="background-color: #229122; color: black;"> </span><span style="background-color: #61af61; color: black;">things!</span><span style="background-color: #61af61; color: black;"> </span></pre>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1">response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].logprobs.content[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># first 5 tokens</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>[ChatCompletionTokenLogprob(token='Machine', bytes=[77, 97, 99, 104, 105, 110, 101], logprob=-0.0015492603, top_logprobs=[]),
 ChatCompletionTokenLogprob(token=' learning', bytes=[32, 108, 101, 97, 114, 110, 105, 110, 103], logprob=-0.0005857991, top_logprobs=[]),
 ChatCompletionTokenLogprob(token=' is', bytes=[32, 105, 115], logprob=-0.00047642877, top_logprobs=[]),
 ChatCompletionTokenLogprob(token=' when', bytes=[32, 119, 104, 101, 110], logprob=-1.7854097, top_logprobs=[]),
 ChatCompletionTokenLogprob(token=' computers', bytes=[32, 99, 111, 109, 112, 117, 116, 101, 114, 115], logprob=-0.25018257, top_logprobs=[])]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1">probs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb42-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> res <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].logprobs.content:</span>
<span id="cb42-3">    probs.append(np.exp(res.logprob))</span>
<span id="cb42-4"></span>
<span id="cb42-5">plt.hist(probs)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb42-6">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probability"</span>)</span>
<span id="cb42-7">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span>
<span id="cb42-8">plt.show()</span>
<span id="cb42-9"></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature_files/figure-html/cell-34-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="low-top-p-more-deterministic" class="level1">
<h1>Low Top-P ( More Deterministic)</h1>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"></span>
<span id="cb43-2">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb43-3">  model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model,</span>
<span id="cb43-4">  messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb43-5">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a helpful assistant."</span>},</span>
<span id="cb43-6">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: question}</span>
<span id="cb43-7">  ],</span>
<span id="cb43-8">  logprobs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb43-9">  top_p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb43-10">  seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seed</span>
<span id="cb43-11">)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1">highlight_openai_response(response)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="font-family: inherit; white-space: pre-wrap; word-break: break-all;"><span style="background-color: #008000; color: black;">Machine</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">learning</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">is</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #3f9f3f; color: black;">like</span><span style="background-color: #3f9f3f; color: black;"> </span><span style="background-color: #9acb9a; color: black;">having</span><span style="background-color: #9acb9a; color: black;"> </span><span style="background-color: #008000; color: black;">a</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #91c791; color: black;">super</span><span style="background-color: #91c791; color: black;"> </span><span style="background-color: #0f870f; color: black;">smart</span><span style="background-color: #0f870f; color: black;"> </span><span style="background-color: #62b062; color: black;">robot</span><span style="background-color: #62b062; color: black;"> </span><span style="background-color: #1e8f1e; color: black;">friend</span><span style="background-color: #1e8f1e; color: black;"> </span><span style="background-color: #72b872; color: black;">that</span><span style="background-color: #72b872; color: black;"> </span><span style="background-color: #2a952a; color: black;">can</span><span style="background-color: #2a952a; color: black;"> </span><span style="background-color: #018001; color: black;">learn</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #61af61; color: black;">things</span><span style="background-color: #61af61; color: black;"> </span><span style="background-color: #65b265; color: black;">on</span><span style="background-color: #65b265; color: black;"> </span><span style="background-color: #008000; color: black;">its</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">own.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #198c19; color: black;">Just</span><span style="background-color: #198c19; color: black;"> </span><span style="background-color: #5cad5c; color: black;">like</span><span style="background-color: #5cad5c; color: black;"> </span><span style="background-color: #008000; color: black;">how</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #8cc58c; color: black;">you</span><span style="background-color: #8cc58c; color: black;"> </span><span style="background-color: #1d8e1d; color: black;">learn</span><span style="background-color: #1d8e1d; color: black;"> </span><span style="background-color: #028102; color: black;">new</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #3d9e3d; color: black;">things</span><span style="background-color: #3d9e3d; color: black;"> </span><span style="background-color: #038103; color: black;">by</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #289328; color: black;">practicing</span><span style="background-color: #289328; color: black;"> </span><span style="background-color: #53a953; color: black;">and</span><span style="background-color: #53a953; color: black;"> </span><span style="background-color: #47a347; color: black;">trying</span><span style="background-color: #47a347; color: black;"> </span><span style="background-color: #40a040; color: black;">different</span><span style="background-color: #40a040; color: black;"> </span><span style="background-color: #40a040; color: black;">things,</span><span style="background-color: #40a040; color: black;"> </span><span style="background-color: #42a042; color: black;">machine</span><span style="background-color: #42a042; color: black;"> </span><span style="background-color: #008000; color: black;">learning</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #359a35; color: black;">is</span><span style="background-color: #359a35; color: black;"> </span><span style="background-color: #008000; color: black;">when</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #70b770; color: black;">a</span><span style="background-color: #70b770; color: black;"> </span><span style="background-color: #349a34; color: black;">computer</span><span style="background-color: #349a34; color: black;"> </span><span style="background-color: #1d8e1d; color: black;">program</span><span style="background-color: #1d8e1d; color: black;"> </span><span style="background-color: #028102; color: black;">learns</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #48a348; color: black;">from</span><span style="background-color: #48a348; color: black;"> </span><span style="background-color: #4ba54a; color: black;">lots</span><span style="background-color: #4ba54a; color: black;"> </span><span style="background-color: #97ca97; color: black;">of</span><span style="background-color: #97ca97; color: black;"> </span><span style="background-color: #359a35; color: black;">examples</span><span style="background-color: #359a35; color: black;"> </span><span style="background-color: #2b952b; color: black;">and</span><span style="background-color: #2b952b; color: black;"> </span><span style="background-color: #40a040; color: black;">gets</span><span style="background-color: #40a040; color: black;"> </span><span style="background-color: #1d8e1d; color: black;">better</span><span style="background-color: #1d8e1d; color: black;"> </span><span style="background-color: #1e8f1e; color: black;">at</span><span style="background-color: #1e8f1e; color: black;"> </span><span style="background-color: #0d860d; color: black;">doing</span><span style="background-color: #0d860d; color: black;"> </span><span style="background-color: #0c860c; color: black;">a</span><span style="background-color: #0c860c; color: black;"> </span><span style="background-color: #1b8d1b; color: black;">task.</span><span style="background-color: #1b8d1b; color: black;"> </span><span style="background-color: #6eb66e; color: black;">For</span><span style="background-color: #6eb66e; color: black;"> </span><span style="background-color: #349934; color: black;">example,</span><span style="background-color: #349934; color: black;"> </span><span style="background-color: #71b771; color: black;">if</span><span style="background-color: #71b771; color: black;"> </span><span style="background-color: #84c084; color: black;">you</span><span style="background-color: #84c084; color: black;"> </span><span style="background-color: #008000; color: black;">show</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #50a750; color: black;">robot</span><span style="background-color: #50a750; color: black;"> </span><span style="background-color: #3d9e3d; color: black;">friend</span><span style="background-color: #3d9e3d; color: black;"> </span><span style="background-color: #2d962d; color: black;">lots</span><span style="background-color: #2d962d; color: black;"> </span><span style="background-color: #339933; color: black;">of</span><span style="background-color: #339933; color: black;"> </span><span style="background-color: #90c790; color: black;">pictures</span><span style="background-color: #90c790; color: black;"> </span><span style="background-color: #148a14; color: black;">of</span><span style="background-color: #148a14; color: black;"> </span><span style="background-color: #399c39; color: black;">cats</span><span style="background-color: #399c39; color: black;"> </span><span style="background-color: #008000; color: black;">and</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">dogs,</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">it</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #50a750; color: black;">can</span><span style="background-color: #50a750; color: black;"> </span><span style="background-color: #108810; color: black;">learn</span><span style="background-color: #108810; color: black;"> </span><span style="background-color: #0f870f; color: black;">to</span><span style="background-color: #0f870f; color: black;"> </span><span style="background-color: #349a34; color: black;">tell</span><span style="background-color: #349a34; color: black;"> </span><span style="background-color: #018001; color: black;">the</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #1c8e1c; color: black;">difference</span><span style="background-color: #1c8e1c; color: black;"> </span><span style="background-color: #078407; color: black;">between</span><span style="background-color: #078407; color: black;"> </span><span style="background-color: #088408; color: black;">them.</span><span style="background-color: #088408; color: black;"> </span><span style="background-color: #0b850b; color: black;">It's</span><span style="background-color: #0b850b; color: black;"> </span><span style="background-color: #289328; color: black;">like</span><span style="background-color: #289328; color: black;"> </span><span style="background-color: #008000; color: black;">magic,</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #038103; color: black;">but</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #088408; color: black;">really</span><span style="background-color: #088408; color: black;"> </span><span style="background-color: #6ab46a; color: black;">it's</span><span style="background-color: #6ab46a; color: black;"> </span><span style="background-color: #66b266; color: black;">just</span><span style="background-color: #66b266; color: black;"> </span><span style="background-color: #6ab46a; color: black;">the</span><span style="background-color: #6ab46a; color: black;"> </span><span style="background-color: #4da64d; color: black;">computer</span><span style="background-color: #4da64d; color: black;"> </span><span style="background-color: #90c790; color: black;">using</span><span style="background-color: #90c790; color: black;"> </span><span style="background-color: #6cb56c; color: black;">math</span><span style="background-color: #6cb56c; color: black;"> </span><span style="background-color: #2f972f; color: black;">and</span><span style="background-color: #2f972f; color: black;"> </span><span style="background-color: #5bad5b; color: black;">patterns</span><span style="background-color: #5bad5b; color: black;"> </span><span style="background-color: #088408; color: black;">to</span><span style="background-color: #088408; color: black;"> </span><span style="background-color: #018001; color: black;">figure</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #0e870e; color: black;">things</span><span style="background-color: #0e870e; color: black;"> </span><span style="background-color: #7fbe7f; color: black;">out.</span><span style="background-color: #7fbe7f; color: black;"> </span></pre>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1">probs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb45-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> res <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> response.choices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].logprobs.content:</span>
<span id="cb45-3">    probs.append(np.exp(res.logprob))</span>
<span id="cb45-4"></span>
<span id="cb45-5">plt.hist(probs)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb45-6">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probability"</span>)</span>
<span id="cb45-7">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span>
<span id="cb45-8">plt.show()</span>
<span id="cb45-9"></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature_files/figure-html/cell-37-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="openai-recommendations-for-top-p" class="level1">
<h1>OpenAI Recommendations for Top-P</h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature_files/figure-html/dec87f32-1-image.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image.png</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature_files/figure-html/2ba2fb3f-1-image-2.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image-2.png</figcaption>
</figure>
</div>
</section>
<section id="interactions-between-temperature-and-top-p" class="level1">
<h1>Interactions between Temperature and Top-P</h1>
<p>Let’s experiment the interactions between temperature and top-p</p>
<ul>
<li>High Temperature and High Top-P</li>
<li>High Temperature and Low Top-P</li>
<li>Low Temperature and High Top-P</li>
<li>Low Temperature and Low Top-P</li>
</ul>
<section id="high-temperature-high-top-p" class="level3">
<h3 class="anchored" data-anchor-id="high-temperature-high-top-p">High Temperature, High Top-P</h3>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"></span>
<span id="cb46-2">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb46-3">  model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model,</span>
<span id="cb46-4">  messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb46-5">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a helpful assistant."</span>},</span>
<span id="cb46-6">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: question}</span>
<span id="cb46-7">  ],</span>
<span id="cb46-8">  logprobs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb46-9">  top_p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb46-10">  temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.6</span>,</span>
<span id="cb46-11">  seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seed</span>
<span id="cb46-12">)</span>
<span id="cb46-13">highlight_openai_response(response)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="font-family: inherit; white-space: pre-wrap; word-break: break-all;"><span style="background-color: #008000; color: black;">Machine</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">learning</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">is</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #c3e0c3; color: black;">when</span><span style="background-color: #c3e0c3; color: black;"> </span><span style="background-color: #eaf2ea; color: black;">computer</span><span style="background-color: #eaf2ea; color: black;"> </span><span style="background-color: #068306; color: black;">programs</span><span style="background-color: #068306; color: black;"> </span><span style="background-color: #a1cfa1; color: black;">can</span><span style="background-color: #a1cfa1; color: black;"> </span><span style="background-color: #058205; color: black;">learn</span><span style="background-color: #058205; color: black;"> </span><span style="background-color: #57ab57; color: black;">and</span><span style="background-color: #57ab57; color: black;"> </span><span style="background-color: #c9e2c8; color: black;">improve</span><span style="background-color: #c9e2c8; color: black;"> </span><span style="background-color: #95c995; color: black;">by</span><span style="background-color: #95c995; color: black;"> </span><span style="background-color: #008000; color: black;">themselves.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000;"> </span><br><span style="background-color: #008000;"> </span><br><span style="background-color: #a1cfa1; color: black;">Imagine</span><span style="background-color: #a1cfa1; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">you</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #209020; color: black;">have</span><span style="background-color: #209020; color: black;"> </span><span style="background-color: #048204; color: black;">a</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #038103; color: black;">puzzle</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #008000; color: black;">toy</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">with</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">pictures</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #7abc7a; color: black;">on</span><span style="background-color: #7abc7a; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">it.</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #aad3aa; color: black;">At</span><span style="background-color: #aad3aa; color: black;"> </span><span style="background-color: #0b850b; color: black;">first</span><span style="background-color: #0b850b; color: black;"> </span><span style="background-color: #389b38; color: black;">it's</span><span style="background-color: #389b38; color: black;"> </span><span style="background-color: #359a35; color: black;">all</span><span style="background-color: #359a35; color: black;"> </span><span style="background-color: #018001; color: black;">mixed</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">up</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #369b36; color: black;">and</span><span style="background-color: #369b36; color: black;"> </span><span style="background-color: #6db66d; color: black;">you</span><span style="background-color: #6db66d; color: black;"> </span><span style="background-color: #198c19; color: black;">don't</span><span style="background-color: #198c19; color: black;"> </span><span style="background-color: #008000; color: black;">know</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #52a852; color: black;">how</span><span style="background-color: #52a852; color: black;"> </span><span style="background-color: #068306; color: black;">to</span><span style="background-color: #068306; color: black;"> </span><span style="background-color: #239123; color: black;">make</span><span style="background-color: #239123; color: black;"> </span><span style="background-color: #008000; color: black;">it</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">right.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #9bcc9b; color: black;">When</span><span style="background-color: #9bcc9b; color: black;"> </span><span style="background-color: #058205; color: black;">you</span><span style="background-color: #058205; color: black;"> </span><span style="background-color: #eaf2ea; color: black;">start</span><span style="background-color: #eaf2ea; color: black;"> </span><span style="background-color: #c9e2c8; color: black;">solving</span><span style="background-color: #c9e2c8; color: black;"> </span><span style="background-color: #82c082; color: black;">it</span><span style="background-color: #82c082; color: black;"> </span><span style="background-color: #008000; color: black;">a</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">few</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #018001; color: black;">times,</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #a3d0a3; color: black;">you</span><span style="background-color: #a3d0a3; color: black;"> </span><span style="background-color: #e8f2e8; color: black;">start</span><span style="background-color: #e8f2e8; color: black;"> </span><span style="background-color: #2c962c; color: black;">getting</span><span style="background-color: #2c962c; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">better</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #339933; color: black;">and</span><span style="background-color: #339933; color: black;"> </span><span style="background-color: #008000; color: black;">can</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #018001; color: black;">finish</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #0f870f; color: black;">the</span><span style="background-color: #0f870f; color: black;"> </span><span style="background-color: #b2d7b1; color: black;">puzzle</span><span style="background-color: #b2d7b1; color: black;"> </span><span style="background-color: #ddecdd; color: black;">faster.</span><span style="background-color: #ddecdd; color: black;"> </span><span style="background-color: #ddecdd;"> </span><br><span style="background-color: #ddecdd;"> </span><br><span style="background-color: #0a850a; color: black;">Machine</span><span style="background-color: #0a850a; color: black;"> </span><span style="background-color: #349a34; color: black;">learning</span><span style="background-color: #349a34; color: black;"> </span><span style="background-color: #e2efe2; color: black;">works</span><span style="background-color: #e2efe2; color: black;"> </span><span style="background-color: #d6e9d6; color: black;">a</span><span style="background-color: #d6e9d6; color: black;"> </span><span style="background-color: #e5f0e5; color: black;">bit</span><span style="background-color: #e5f0e5; color: black;"> </span><span style="background-color: #028102; color: black;">like</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #1b8d1b; color: black;">that.</span><span style="background-color: #1b8d1b; color: black;"> </span><span style="background-color: #118911; color: black;">It's</span><span style="background-color: #118911; color: black;"> </span><span style="background-color: #cbe4cb; color: black;">like</span><span style="background-color: #cbe4cb; color: black;"> </span><span style="background-color: #47a347; color: black;">a</span><span style="background-color: #47a347; color: black;"> </span><span style="background-color: #008000; color: black;">really</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #d9ead9; color: black;">smart</span><span style="background-color: #d9ead9; color: black;"> </span><span style="background-color: #d7e9d7; color: black;">program</span><span style="background-color: #d7e9d7; color: black;"> </span><span style="background-color: #138913; color: black;">that</span><span style="background-color: #138913; color: black;"> </span><span style="background-color: #008000; color: black;">learns</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #048204; color: black;">from</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #309730; color: black;">doing</span><span style="background-color: #309730; color: black;"> </span><span style="background-color: #cee5ce; color: black;">things</span><span style="background-color: #cee5ce; color: black;"> </span><span style="background-color: #229122; color: black;">over</span><span style="background-color: #229122; color: black;"> </span><span style="background-color: #74b974; color: black;">and</span><span style="background-color: #74b974; color: black;"> </span><span style="background-color: #94c994; color: black;">over</span><span style="background-color: #94c994; color: black;"> </span><span style="background-color: #eaf2ea; color: black;">again.</span><span style="background-color: #eaf2ea; color: black;"> </span><span style="background-color: #088408; color: black;">It</span><span style="background-color: #088408; color: black;"> </span><span style="background-color: #e8f2e8; color: black;">gets</span><span style="background-color: #e8f2e8; color: black;"> </span><span style="background-color: #008000; color: black;">more</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #deedde; color: black;">and</span><span style="background-color: #deedde; color: black;"> </span><span style="background-color: #309730; color: black;">more</span><span style="background-color: #309730; color: black;"> </span><span style="background-color: #b4d8b4; color: black;">powerful,</span><span style="background-color: #b4d8b4; color: black;"> </span><span style="background-color: #259225; color: black;">by</span><span style="background-color: #259225; color: black;"> </span><span style="background-color: #2a952a; color: black;">learning</span><span style="background-color: #2a952a; color: black;"> </span><span style="background-color: #008000; color: black;">from</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">its</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #239123; color: black;">own</span><span style="background-color: #239123; color: black;"> </span><span style="background-color: #1f8f1f; color: black;">experiences!</span><span style="background-color: #1f8f1f; color: black;"> </span><span style="background-color: #1a8d1a; color: black;">So</span><span style="background-color: #1a8d1a; color: black;"> </span><span style="background-color: #b0d6b0; color: black;">just</span><span style="background-color: #b0d6b0; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">like</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #178b17; color: black;">you,</span><span style="background-color: #178b17; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">computer</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #e3efe3; color: black;">program</span><span style="background-color: #e3efe3; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">gets</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #badbba; color: black;">better</span><span style="background-color: #badbba; color: black;"> </span><span style="background-color: #178b17; color: black;">and</span><span style="background-color: #178b17; color: black;"> </span><span style="background-color: #188c18; color: black;">better</span><span style="background-color: #188c18; color: black;"> </span><span style="background-color: #add5ad; color: black;">at</span><span style="background-color: #add5ad; color: black;"> </span><span style="background-color: #c2dfc2; color: black;">solving</span><span style="background-color: #c2dfc2; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">the</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #c9e2c8; color: black;">problems</span><span style="background-color: #c9e2c8; color: black;"> </span><span style="background-color: #d1e6d1; color: black;">it</span><span style="background-color: #d1e6d1; color: black;"> </span><span style="background-color: #008000; color: black;">faces.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #1a8d1a; color: black;">Isn’t</span><span style="background-color: #1a8d1a; color: black;"> </span><span style="background-color: #dbebdb; color: black;">that</span><span style="background-color: #dbebdb; color: black;"> </span><span style="background-color: #84c184; color: black;">amazing?!</span><span style="background-color: #84c184; color: black;"> </span></pre>
</div>
</div>
</section>
<section id="high-temperature-low-top-p" class="level3">
<h3 class="anchored" data-anchor-id="high-temperature-low-top-p">High Temperature, Low Top-P</h3>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"></span>
<span id="cb47-2">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb47-3">  model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model,</span>
<span id="cb47-4">  messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb47-5">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a helpful assistant."</span>},</span>
<span id="cb47-6">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: question}</span>
<span id="cb47-7">  ],</span>
<span id="cb47-8">  logprobs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb47-9">  top_p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb47-10">  temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb47-11">  seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seed</span>
<span id="cb47-12">)</span>
<span id="cb47-13">highlight_openai_response(response)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="font-family: inherit; white-space: pre-wrap; word-break: break-all;"><span style="background-color: #008000; color: black;">Machine</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">learning</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">is</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #3f9f3f; color: black;">like</span><span style="background-color: #3f9f3f; color: black;"> </span><span style="background-color: #9bcc9b; color: black;">having</span><span style="background-color: #9bcc9b; color: black;"> </span><span style="background-color: #008000; color: black;">a</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #91c791; color: black;">super</span><span style="background-color: #91c791; color: black;"> </span><span style="background-color: #108810; color: black;">smart</span><span style="background-color: #108810; color: black;"> </span><span style="background-color: #63b163; color: black;">robot</span><span style="background-color: #63b163; color: black;"> </span><span style="background-color: #1e8f1e; color: black;">friend</span><span style="background-color: #1e8f1e; color: black;"> </span><span style="background-color: #72b872; color: black;">that</span><span style="background-color: #72b872; color: black;"> </span><span style="background-color: #2a952a; color: black;">can</span><span style="background-color: #2a952a; color: black;"> </span><span style="background-color: #018001; color: black;">learn</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #61af61; color: black;">things</span><span style="background-color: #61af61; color: black;"> </span><span style="background-color: #65b265; color: black;">on</span><span style="background-color: #65b265; color: black;"> </span><span style="background-color: #008000; color: black;">its</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">own.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #198c19; color: black;">Just</span><span style="background-color: #198c19; color: black;"> </span><span style="background-color: #5cad5c; color: black;">like</span><span style="background-color: #5cad5c; color: black;"> </span><span style="background-color: #008000; color: black;">how</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #8dc58d; color: black;">you</span><span style="background-color: #8dc58d; color: black;"> </span><span style="background-color: #1d8e1d; color: black;">learn</span><span style="background-color: #1d8e1d; color: black;"> </span><span style="background-color: #028102; color: black;">new</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #3a9c3a; color: black;">things</span><span style="background-color: #3a9c3a; color: black;"> </span><span style="background-color: #038103; color: black;">by</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #279327; color: black;">practicing</span><span style="background-color: #279327; color: black;"> </span><span style="background-color: #53a953; color: black;">and</span><span style="background-color: #53a953; color: black;"> </span><span style="background-color: #46a246; color: black;">trying</span><span style="background-color: #46a246; color: black;"> </span><span style="background-color: #40a040; color: black;">different</span><span style="background-color: #40a040; color: black;"> </span><span style="background-color: #41a041; color: black;">things,</span><span style="background-color: #41a041; color: black;"> </span><span style="background-color: #43a143; color: black;">machine</span><span style="background-color: #43a143; color: black;"> </span><span style="background-color: #008000; color: black;">learning</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #359a35; color: black;">is</span><span style="background-color: #359a35; color: black;"> </span><span style="background-color: #008000; color: black;">when</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #70b770; color: black;">a</span><span style="background-color: #70b770; color: black;"> </span><span style="background-color: #359a35; color: black;">computer</span><span style="background-color: #359a35; color: black;"> </span><span style="background-color: #1d8e1d; color: black;">program</span><span style="background-color: #1d8e1d; color: black;"> </span><span style="background-color: #028102; color: black;">learns</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #48a348; color: black;">from</span><span style="background-color: #48a348; color: black;"> </span><span style="background-color: #4ba54a; color: black;">lots</span><span style="background-color: #4ba54a; color: black;"> </span><span style="background-color: #98ca98; color: black;">of</span><span style="background-color: #98ca98; color: black;"> </span><span style="background-color: #359a35; color: black;">examples</span><span style="background-color: #359a35; color: black;"> </span><span style="background-color: #2b952b; color: black;">and</span><span style="background-color: #2b952b; color: black;"> </span><span style="background-color: #3e9e3e; color: black;">gets</span><span style="background-color: #3e9e3e; color: black;"> </span><span style="background-color: #1d8e1d; color: black;">better</span><span style="background-color: #1d8e1d; color: black;"> </span><span style="background-color: #1d8e1d; color: black;">at</span><span style="background-color: #1d8e1d; color: black;"> </span><span style="background-color: #0d860d; color: black;">doing</span><span style="background-color: #0d860d; color: black;"> </span><span style="background-color: #0b850b; color: black;">a</span><span style="background-color: #0b850b; color: black;"> </span><span style="background-color: #1b8d1b; color: black;">task.</span><span style="background-color: #1b8d1b; color: black;"> </span><span style="background-color: #6db56d; color: black;">For</span><span style="background-color: #6db56d; color: black;"> </span><span style="background-color: #349934; color: black;">example,</span><span style="background-color: #349934; color: black;"> </span><span style="background-color: #70b770; color: black;">if</span><span style="background-color: #70b770; color: black;"> </span><span style="background-color: #84c084; color: black;">you</span><span style="background-color: #84c084; color: black;"> </span><span style="background-color: #008000; color: black;">show</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #4fa74f; color: black;">robot</span><span style="background-color: #4fa74f; color: black;"> </span><span style="background-color: #3d9e3d; color: black;">friend</span><span style="background-color: #3d9e3d; color: black;"> </span><span style="background-color: #2c962c; color: black;">lots</span><span style="background-color: #2c962c; color: black;"> </span><span style="background-color: #339933; color: black;">of</span><span style="background-color: #339933; color: black;"> </span><span style="background-color: #84c184; color: black;">pictures</span><span style="background-color: #84c184; color: black;"> </span><span style="background-color: #168b16; color: black;">of</span><span style="background-color: #168b16; color: black;"> </span><span style="background-color: #389b38; color: black;">cats</span><span style="background-color: #389b38; color: black;"> </span><span style="background-color: #008000; color: black;">and</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">dogs,</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">it</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #51a851; color: black;">can</span><span style="background-color: #51a851; color: black;"> </span><span style="background-color: #118811; color: black;">learn</span><span style="background-color: #118811; color: black;"> </span><span style="background-color: #108810; color: black;">to</span><span style="background-color: #108810; color: black;"> </span><span style="background-color: #349a34; color: black;">tell</span><span style="background-color: #349a34; color: black;"> </span><span style="background-color: #018001; color: black;">the</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #1a8d1a; color: black;">difference</span><span style="background-color: #1a8d1a; color: black;"> </span><span style="background-color: #078407; color: black;">between</span><span style="background-color: #078407; color: black;"> </span><span style="background-color: #088408; color: black;">them.</span><span style="background-color: #088408; color: black;"> </span><span style="background-color: #098509; color: black;">It's</span><span style="background-color: #098509; color: black;"> </span><span style="background-color: #259225; color: black;">like</span><span style="background-color: #259225; color: black;"> </span><span style="background-color: #008000; color: black;">magic,</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #038103; color: black;">but</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #088408; color: black;">really</span><span style="background-color: #088408; color: black;"> </span><span style="background-color: #66b266; color: black;">it's</span><span style="background-color: #66b266; color: black;"> </span><span style="background-color: #65b265; color: black;">just</span><span style="background-color: #65b265; color: black;"> </span><span style="background-color: #72b872; color: black;">the</span><span style="background-color: #72b872; color: black;"> </span><span style="background-color: #49a449; color: black;">computer</span><span style="background-color: #49a449; color: black;"> </span><span style="background-color: #90c790; color: black;">using</span><span style="background-color: #90c790; color: black;"> </span><span style="background-color: #70b770; color: black;">math</span><span style="background-color: #70b770; color: black;"> </span><span style="background-color: #2f972f; color: black;">and</span><span style="background-color: #2f972f; color: black;"> </span><span style="background-color: #62b062; color: black;">patterns</span><span style="background-color: #62b062; color: black;"> </span><span style="background-color: #078407; color: black;">to</span><span style="background-color: #078407; color: black;"> </span><span style="background-color: #018001; color: black;">figure</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #0a850a; color: black;">things</span><span style="background-color: #0a850a; color: black;"> </span><span style="background-color: #7abc7a; color: black;">out.</span><span style="background-color: #7abc7a; color: black;"> </span></pre>
</div>
</div>
</section>
<section id="low-temperature-high-top-p" class="level3">
<h3 class="anchored" data-anchor-id="low-temperature-high-top-p">Low Temperature, High Top-P</h3>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"></span>
<span id="cb48-2">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb48-3">  model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model,</span>
<span id="cb48-4">  messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb48-5">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a helpful assistant."</span>},</span>
<span id="cb48-6">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: question}</span>
<span id="cb48-7">  ],</span>
<span id="cb48-8">  logprobs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb48-9">  top_p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb48-10">  temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb48-11">  seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seed</span>
<span id="cb48-12">)</span>
<span id="cb48-13">highlight_openai_response(response)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="font-family: inherit; white-space: pre-wrap; word-break: break-all;"><span style="background-color: #008000; color: black;">Machine</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">learning</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">is</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #3f9f3f; color: black;">like</span><span style="background-color: #3f9f3f; color: black;"> </span><span style="background-color: #98ca98; color: black;">having</span><span style="background-color: #98ca98; color: black;"> </span><span style="background-color: #008000; color: black;">a</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #90c790; color: black;">super</span><span style="background-color: #90c790; color: black;"> </span><span style="background-color: #108810; color: black;">smart</span><span style="background-color: #108810; color: black;"> </span><span style="background-color: #63b163; color: black;">robot</span><span style="background-color: #63b163; color: black;"> </span><span style="background-color: #1e8f1e; color: black;">friend</span><span style="background-color: #1e8f1e; color: black;"> </span><span style="background-color: #6eb66e; color: black;">that</span><span style="background-color: #6eb66e; color: black;"> </span><span style="background-color: #2e972e; color: black;">can</span><span style="background-color: #2e972e; color: black;"> </span><span style="background-color: #018001; color: black;">learn</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #5dae5d; color: black;">things</span><span style="background-color: #5dae5d; color: black;"> </span><span style="background-color: #66b266; color: black;">on</span><span style="background-color: #66b266; color: black;"> </span><span style="background-color: #008000; color: black;">its</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">own.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #198c19; color: black;">It's</span><span style="background-color: #198c19; color: black;"> </span><span style="background-color: #bbdcbb; color: black;">like</span><span style="background-color: #bbdcbb; color: black;"> </span><span style="background-color: #59ac59; color: black;">when</span><span style="background-color: #59ac59; color: black;"> </span><span style="background-color: #7bbc7b; color: black;">you</span><span style="background-color: #7bbc7b; color: black;"> </span><span style="background-color: #319831; color: black;">play</span><span style="background-color: #319831; color: black;"> </span><span style="background-color: #018001; color: black;">a</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #75b975; color: black;">game</span><span style="background-color: #75b975; color: black;"> </span><span style="background-color: #44a144; color: black;">and</span><span style="background-color: #44a144; color: black;"> </span><span style="background-color: #209020; color: black;">get</span><span style="background-color: #209020; color: black;"> </span><span style="background-color: #3e9e3e; color: black;">better</span><span style="background-color: #3e9e3e; color: black;"> </span><span style="background-color: #89c389; color: black;">each</span><span style="background-color: #89c389; color: black;"> </span><span style="background-color: #018001; color: black;">time</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #6cb56c; color: black;">because</span><span style="background-color: #6cb56c; color: black;"> </span><span style="background-color: #008000; color: black;">you</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #68b368; color: black;">remember</span><span style="background-color: #68b368; color: black;"> </span><span style="background-color: #008000; color: black;">what</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #0c860c; color: black;">you</span><span style="background-color: #0c860c; color: black;"> </span><span style="background-color: #0a850a; color: black;">did</span><span style="background-color: #0a850a; color: black;"> </span><span style="background-color: #88c388; color: black;">before.</span><span style="background-color: #88c388; color: black;"> </span><span style="background-color: #018001; color: black;">But</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #178b17; color: black;">instead</span><span style="background-color: #178b17; color: black;"> </span><span style="background-color: #048204; color: black;">of</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #57ab57; color: black;">a</span><span style="background-color: #57ab57; color: black;"> </span><span style="background-color: #389b38; color: black;">game,</span><span style="background-color: #389b38; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #319831; color: black;">robot</span><span style="background-color: #319831; color: black;"> </span><span style="background-color: #0b850b; color: black;">friend</span><span style="background-color: #0b850b; color: black;"> </span><span style="background-color: #008000; color: black;">learns</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #229122; color: black;">from</span><span style="background-color: #229122; color: black;"> </span><span style="background-color: #048204; color: black;">lots</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #118811; color: black;">of</span><span style="background-color: #118811; color: black;"> </span><span style="background-color: #269226; color: black;">information</span><span style="background-color: #269226; color: black;"> </span><span style="background-color: #0a850a; color: black;">and</span><span style="background-color: #0a850a; color: black;"> </span><span style="background-color: #259225; color: black;">figures</span><span style="background-color: #259225; color: black;"> </span><span style="background-color: #61b061; color: black;">out</span><span style="background-color: #61b061; color: black;"> </span><span style="background-color: #1c8e1c; color: black;">patterns</span><span style="background-color: #1c8e1c; color: black;"> </span><span style="background-color: #3c9d3c; color: black;">and</span><span style="background-color: #3c9d3c; color: black;"> </span><span style="background-color: #86c286; color: black;">rules.</span><span style="background-color: #86c286; color: black;"> </span><span style="background-color: #058205; color: black;">Then</span><span style="background-color: #058205; color: black;"> </span><span style="background-color: #48a348; color: black;">it</span><span style="background-color: #48a348; color: black;"> </span><span style="background-color: #91c791; color: black;">can</span><span style="background-color: #91c791; color: black;"> </span><span style="background-color: #078407; color: black;">use</span><span style="background-color: #078407; color: black;"> </span><span style="background-color: #5eae5e; color: black;">what</span><span style="background-color: #5eae5e; color: black;"> </span><span style="background-color: #6fb76f; color: black;">it</span><span style="background-color: #6fb76f; color: black;"> </span><span style="background-color: #77ba77; color: black;">learned</span><span style="background-color: #77ba77; color: black;"> </span><span style="background-color: #349934; color: black;">to</span><span style="background-color: #349934; color: black;"> </span><span style="background-color: #068306; color: black;">make</span><span style="background-color: #068306; color: black;"> </span><span style="background-color: #67b267; color: black;">predictions</span><span style="background-color: #67b267; color: black;"> </span><span style="background-color: #008000; color: black;">or</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #068306; color: black;">do</span><span style="background-color: #068306; color: black;"> </span><span style="background-color: #008000; color: black;">tasks</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #95c995; color: black;">without</span><span style="background-color: #95c995; color: black;"> </span><span style="background-color: #3e9e3e; color: black;">being</span><span style="background-color: #3e9e3e; color: black;"> </span><span style="background-color: #148a14; color: black;">told</span><span style="background-color: #148a14; color: black;"> </span><span style="background-color: #83c083; color: black;">exactly</span><span style="background-color: #83c083; color: black;"> </span><span style="background-color: #74b974; color: black;">what</span><span style="background-color: #74b974; color: black;"> </span><span style="background-color: #3e9e3e; color: black;">to</span><span style="background-color: #3e9e3e; color: black;"> </span><span style="background-color: #3a9c3a; color: black;">do.</span><span style="background-color: #3a9c3a; color: black;"> </span><span style="background-color: #028102; color: black;">It's</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #289428; color: black;">like</span><span style="background-color: #289428; color: black;"> </span><span style="background-color: #018001; color: black;">having</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #008000; color: black;">a</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">really</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #259225; color: black;">clever</span><span style="background-color: #259225; color: black;"> </span><span style="background-color: #279327; color: black;">friend</span><span style="background-color: #279327; color: black;"> </span><span style="background-color: #018001; color: black;">who</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #61af61; color: black;">can</span><span style="background-color: #61af61; color: black;"> </span><span style="background-color: #128912; color: black;">help</span><span style="background-color: #128912; color: black;"> </span><span style="background-color: #018001; color: black;">you</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #4ca54c; color: black;">with</span><span style="background-color: #4ca54c; color: black;"> </span><span style="background-color: #4ba54b; color: black;">all</span><span style="background-color: #4ba54b; color: black;"> </span><span style="background-color: #5cad5c; color: black;">sorts</span><span style="background-color: #5cad5c; color: black;"> </span><span style="background-color: #399c39; color: black;">of</span><span style="background-color: #399c39; color: black;"> </span><span style="background-color: #118911; color: black;">things!</span><span style="background-color: #118911; color: black;"> </span></pre>
</div>
</div>
</section>
<section id="low-temperature-low-top-p" class="level3">
<h3 class="anchored" data-anchor-id="low-temperature-low-top-p">Low Temperature, Low Top-P</h3>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"></span>
<span id="cb49-2">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb49-3">  model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model,</span>
<span id="cb49-4">  messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb49-5">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a helpful assistant."</span>},</span>
<span id="cb49-6">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: question}</span>
<span id="cb49-7">  ],</span>
<span id="cb49-8">  logprobs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb49-9">  top_p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb49-10">  temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb49-11">  seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seed</span>
<span id="cb49-12">)</span>
<span id="cb49-13">highlight_openai_response(response)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="font-family: inherit; white-space: pre-wrap; word-break: break-all;"><span style="background-color: #008000; color: black;">Machine</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">learning</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">is</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #3f9f3f; color: black;">like</span><span style="background-color: #3f9f3f; color: black;"> </span><span style="background-color: #98ca98; color: black;">having</span><span style="background-color: #98ca98; color: black;"> </span><span style="background-color: #008000; color: black;">a</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #90c790; color: black;">super</span><span style="background-color: #90c790; color: black;"> </span><span style="background-color: #108810; color: black;">smart</span><span style="background-color: #108810; color: black;"> </span><span style="background-color: #63b163; color: black;">robot</span><span style="background-color: #63b163; color: black;"> </span><span style="background-color: #1e8f1e; color: black;">friend</span><span style="background-color: #1e8f1e; color: black;"> </span><span style="background-color: #6eb66e; color: black;">that</span><span style="background-color: #6eb66e; color: black;"> </span><span style="background-color: #2e972e; color: black;">can</span><span style="background-color: #2e972e; color: black;"> </span><span style="background-color: #018001; color: black;">learn</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #5dae5d; color: black;">things</span><span style="background-color: #5dae5d; color: black;"> </span><span style="background-color: #66b266; color: black;">on</span><span style="background-color: #66b266; color: black;"> </span><span style="background-color: #008000; color: black;">its</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">own.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #198c19; color: black;">Just</span><span style="background-color: #198c19; color: black;"> </span><span style="background-color: #5bad5b; color: black;">like</span><span style="background-color: #5bad5b; color: black;"> </span><span style="background-color: #008000; color: black;">how</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #8fc68f; color: black;">you</span><span style="background-color: #8fc68f; color: black;"> </span><span style="background-color: #1d8e1d; color: black;">learn</span><span style="background-color: #1d8e1d; color: black;"> </span><span style="background-color: #028102; color: black;">new</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #399c39; color: black;">things</span><span style="background-color: #399c39; color: black;"> </span><span style="background-color: #038103; color: black;">by</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #279327; color: black;">practicing</span><span style="background-color: #279327; color: black;"> </span><span style="background-color: #58ab58; color: black;">and</span><span style="background-color: #58ab58; color: black;"> </span><span style="background-color: #46a246; color: black;">trying</span><span style="background-color: #46a246; color: black;"> </span><span style="background-color: #40a040; color: black;">different</span><span style="background-color: #40a040; color: black;"> </span><span style="background-color: #3f9f3f; color: black;">things,</span><span style="background-color: #3f9f3f; color: black;"> </span><span style="background-color: #42a042; color: black;">machine</span><span style="background-color: #42a042; color: black;"> </span><span style="background-color: #008000; color: black;">learning</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #369b36; color: black;">is</span><span style="background-color: #369b36; color: black;"> </span><span style="background-color: #008000; color: black;">when</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #70b770; color: black;">a</span><span style="background-color: #70b770; color: black;"> </span><span style="background-color: #349a34; color: black;">computer</span><span style="background-color: #349a34; color: black;"> </span><span style="background-color: #1d8e1d; color: black;">program</span><span style="background-color: #1d8e1d; color: black;"> </span><span style="background-color: #028102; color: black;">learns</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #47a347; color: black;">from</span><span style="background-color: #47a347; color: black;"> </span><span style="background-color: #4ba54a; color: black;">lots</span><span style="background-color: #4ba54a; color: black;"> </span><span style="background-color: #99cb99; color: black;">of</span><span style="background-color: #99cb99; color: black;"> </span><span style="background-color: #359a35; color: black;">examples</span><span style="background-color: #359a35; color: black;"> </span><span style="background-color: #279327; color: black;">and</span><span style="background-color: #279327; color: black;"> </span><span style="background-color: #41a041; color: black;">gets</span><span style="background-color: #41a041; color: black;"> </span><span style="background-color: #1c8e1c; color: black;">better</span><span style="background-color: #1c8e1c; color: black;"> </span><span style="background-color: #1e8f1e; color: black;">at</span><span style="background-color: #1e8f1e; color: black;"> </span><span style="background-color: #0d860d; color: black;">doing</span><span style="background-color: #0d860d; color: black;"> </span><span style="background-color: #0c860c; color: black;">a</span><span style="background-color: #0c860c; color: black;"> </span><span style="background-color: #1b8d1b; color: black;">task.</span><span style="background-color: #1b8d1b; color: black;"> </span><span style="background-color: #6db66d; color: black;">For</span><span style="background-color: #6db66d; color: black;"> </span><span style="background-color: #349934; color: black;">example,</span><span style="background-color: #349934; color: black;"> </span><span style="background-color: #73b873; color: black;">if</span><span style="background-color: #73b873; color: black;"> </span><span style="background-color: #8ac48a; color: black;">you</span><span style="background-color: #8ac48a; color: black;"> </span><span style="background-color: #008000; color: black;">show</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #4fa74f; color: black;">robot</span><span style="background-color: #4fa74f; color: black;"> </span><span style="background-color: #3d9e3d; color: black;">friend</span><span style="background-color: #3d9e3d; color: black;"> </span><span style="background-color: #2e972e; color: black;">lots</span><span style="background-color: #2e972e; color: black;"> </span><span style="background-color: #339933; color: black;">of</span><span style="background-color: #339933; color: black;"> </span><span style="background-color: #84c184; color: black;">pictures</span><span style="background-color: #84c184; color: black;"> </span><span style="background-color: #168b16; color: black;">of</span><span style="background-color: #168b16; color: black;"> </span><span style="background-color: #379b37; color: black;">cats</span><span style="background-color: #379b37; color: black;"> </span><span style="background-color: #008000; color: black;">and</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">dogs,</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">it</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #51a851; color: black;">can</span><span style="background-color: #51a851; color: black;"> </span><span style="background-color: #108810; color: black;">learn</span><span style="background-color: #108810; color: black;"> </span><span style="background-color: #108810; color: black;">to</span><span style="background-color: #108810; color: black;"> </span><span style="background-color: #359a35; color: black;">tell</span><span style="background-color: #359a35; color: black;"> </span><span style="background-color: #018001; color: black;">the</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #1a8d1a; color: black;">difference</span><span style="background-color: #1a8d1a; color: black;"> </span><span style="background-color: #078407; color: black;">between</span><span style="background-color: #078407; color: black;"> </span><span style="background-color: #088408; color: black;">them.</span><span style="background-color: #088408; color: black;"> </span><span style="background-color: #098509; color: black;">It's</span><span style="background-color: #098509; color: black;"> </span><span style="background-color: #249224; color: black;">like</span><span style="background-color: #249224; color: black;"> </span><span style="background-color: #008000; color: black;">magic,</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #038103; color: black;">but</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #088408; color: black;">really</span><span style="background-color: #088408; color: black;"> </span><span style="background-color: #68b368; color: black;">it's</span><span style="background-color: #68b368; color: black;"> </span><span style="background-color: #66b266; color: black;">just</span><span style="background-color: #66b266; color: black;"> </span><span style="background-color: #78bb78; color: black;">a</span><span style="background-color: #78bb78; color: black;"> </span><span style="background-color: #49a449; color: black;">computer</span><span style="background-color: #49a449; color: black;"> </span><span style="background-color: #93c893; color: black;">using</span><span style="background-color: #93c893; color: black;"> </span><span style="background-color: #72b872; color: black;">math</span><span style="background-color: #72b872; color: black;"> </span><span style="background-color: #2c962c; color: black;">to</span><span style="background-color: #2c962c; color: black;"> </span><span style="background-color: #63b163; color: black;">learn</span><span style="background-color: #63b163; color: black;"> </span><span style="background-color: #078407; color: black;">and</span><span style="background-color: #078407; color: black;"> </span><span style="background-color: #018001; color: black;">make</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #0a850a; color: black;">decisions.</span><span style="background-color: #0a850a; color: black;"> </span></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature_files/figure-html/56ef3d0f-1-image.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image.png</figcaption>
</figure>
</div>
</section>
</section>
<section id="frequency-penalty" class="level1">
<h1>Frequency Penalty</h1>
<p>Frequency Penalty is used to reduce the likelihood of a token being selected again if it has already appeared in the generated text.</p>
<p>It ranges from -2.0 to 2.0, where positive values discourage repetition by penalizing tokens that occur frequently, and negative values can increase the likelihood of repetition. This helps control the diversity of the generated content and prevent verbatim repetition.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature_files/figure-html/96a6c5ea-1-image.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image.png</figcaption>
</figure>
</div>
<p>In the above example, we can see recommendations such as National Park appeared twice in the generated text. We can use frequency penalty to reduce the likelihood of a token being selected again if it has already appeared in the generated text.</p>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1">question <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb50-2"></span>
<span id="cb50-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Write 10 slogans for ChatGPT</span></span>
<span id="cb50-4"></span>
<span id="cb50-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span></code></pre></div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"></span>
<span id="cb51-2">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb51-3">  model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model,</span>
<span id="cb51-4">  messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb51-5">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a helpful assistant."</span>},</span>
<span id="cb51-6">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: question}</span>
<span id="cb51-7">  ],</span>
<span id="cb51-8">  logprobs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb51-9">  temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb51-10">  seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seed</span>
<span id="cb51-11">)</span>
<span id="cb51-12">highlight_openai_response(response)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="font-family: inherit; white-space: pre-wrap; word-break: break-all;"><span style="background-color: #008000; color: black;">1.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"Unleash</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #cce4cc; color: black;">Power</span><span style="background-color: #cce4cc; color: black;"> </span><span style="background-color: #008000; color: black;">of</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chat</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #5cad5c; color: black;">with</span><span style="background-color: #5cad5c; color: black;"> </span><span style="background-color: #b3d8b3; color: black;">ChatGPT!"</span><span style="background-color: #b3d8b3; color: black;"> </span><br><span style="background-color: #008000; color: black;">2.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #63b163; color: black;">"ChatGPT:</span><span style="background-color: #63b163; color: black;"> </span><span style="background-color: #b0d6b0; color: black;">Your</span><span style="background-color: #b0d6b0; color: black;"> </span><span style="background-color: #008000; color: black;">Trusted</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Conversational</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Companion!"</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #108810; color: black;">3.</span><span style="background-color: #108810; color: black;"> </span><span style="background-color: #008000; color: black;">"Get</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Instant</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Answers</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #53a953; color: black;">with</span><span style="background-color: #53a953; color: black;"> </span><span style="background-color: #028102; color: black;">ChatGPT</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #008000; color: black;">-</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #038103; color: black;">Chat</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #50a750; color: black;">smarter,</span><span style="background-color: #50a750; color: black;"> </span><span style="background-color: #e8f2e8; color: black;">not</span><span style="background-color: #e8f2e8; color: black;"> </span><span style="background-color: #8dc58d; color: black;">harder!"</span><span style="background-color: #8dc58d; color: black;"> </span><br><span style="background-color: #008000; color: black;">4.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #349a34; color: black;">"Break</span><span style="background-color: #349a34; color: black;"> </span><span style="background-color: #5aac5a; color: black;">the</span><span style="background-color: #5aac5a; color: black;"> </span><span style="background-color: #008000; color: black;">Ice</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">with</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">ChatGPT</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #e9f2e9; color: black;">-</span><span style="background-color: #e9f2e9; color: black;"> </span><span style="background-color: #daebda; color: black;">The</span><span style="background-color: #daebda; color: black;"> </span><span style="background-color: #279327; color: black;">Ultimate</span><span style="background-color: #279327; color: black;"> </span><span style="background-color: #b5d9b5; color: black;">Conversation</span><span style="background-color: #b5d9b5; color: black;"> </span><span style="background-color: #068306; color: black;">Starter!"</span><span style="background-color: #068306; color: black;"> </span><br><span style="background-color: #008000; color: black;">5.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"ChatGPT:</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #a3d0a3; color: black;">With</span><span style="background-color: #a3d0a3; color: black;"> </span><span style="background-color: #c9e3c9; color: black;">every</span><span style="background-color: #c9e3c9; color: black;"> </span><span style="background-color: #c9e3c9; color: black;">chat,</span><span style="background-color: #c9e3c9; color: black;"> </span><span style="background-color: #068306; color: black;">we'll</span><span style="background-color: #068306; color: black;"> </span><span style="background-color: #158a15; color: black;">wow</span><span style="background-color: #158a15; color: black;"> </span><span style="background-color: #008000; color: black;">you!"</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #008000; color: black;">6.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"ChatGPT:</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Making</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Conversations</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">Magical!"</span><span style="background-color: #ebf3eb; color: black;"> </span><br><span style="background-color: #229122; color: black;">7.</span><span style="background-color: #229122; color: black;"> </span><span style="background-color: #cfe5cf; color: black;">"Experience</span><span style="background-color: #cfe5cf; color: black;"> </span><span style="background-color: #209020; color: black;">Smarter</span><span style="background-color: #209020; color: black;"> </span><span style="background-color: #008000; color: black;">Chats</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">with</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">ChatGPT</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #088408; color: black;">-</span><span style="background-color: #088408; color: black;"> </span><span style="background-color: #cde5cd; color: black;">Your</span><span style="background-color: #cde5cd; color: black;"> </span><span style="background-color: #1c8e1c; color: black;">virtual</span><span style="background-color: #1c8e1c; color: black;"> </span><span style="background-color: #45a245; color: black;">chat</span><span style="background-color: #45a245; color: black;"> </span><span style="background-color: #018001; color: black;">guru!"</span><span style="background-color: #018001; color: black;"> </span><br><span style="background-color: #008000; color: black;">8.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"Elevate</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Your</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chats</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #2f972f; color: black;">with</span><span style="background-color: #2f972f; color: black;"> </span><span style="background-color: #008000; color: black;">ChatGPT</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">-</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #1a8d1a; color: black;">Your</span><span style="background-color: #1a8d1a; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">chatbot</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #d4e8d4; color: black;">companion!"</span><span style="background-color: #d4e8d4; color: black;"> </span><br><span style="background-color: #78bb78; color: black;">9.</span><span style="background-color: #78bb78; color: black;"> </span><span style="background-color: #048204; color: black;">"ChatGPT:</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #8cc58c; color: black;">The</span><span style="background-color: #8cc58c; color: black;"> </span><span style="background-color: #ddecdd; color: black;">Perfect</span><span style="background-color: #ddecdd; color: black;"> </span><span style="background-color: #e5f0e5; color: black;">Balance</span><span style="background-color: #e5f0e5; color: black;"> </span><span style="background-color: #0d860d; color: black;">of</span><span style="background-color: #0d860d; color: black;"> </span><span style="background-color: #188c18; color: black;">Wit</span><span style="background-color: #188c18; color: black;"> </span><span style="background-color: #008000; color: black;">and</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Intelligence!"</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #008000; color: black;">10.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #77ba77; color: black;">"Unlock</span><span style="background-color: #77ba77; color: black;"> </span><span style="background-color: #048204; color: black;">the</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #008000; color: black;">Potential</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #319831; color: black;">of</span><span style="background-color: #319831; color: black;"> </span><span style="background-color: #cfe5cf; color: black;">Chat</span><span style="background-color: #cfe5cf; color: black;"> </span><span style="background-color: #1f8f1f; color: black;">with</span><span style="background-color: #1f8f1f; color: black;"> </span><span style="background-color: #008000; color: black;">ChatGPT</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #e6f1e6; color: black;">-</span><span style="background-color: #e6f1e6; color: black;"> </span><span style="background-color: #3f9f3f; color: black;">Conversations</span><span style="background-color: #3f9f3f; color: black;"> </span><span style="background-color: #008000; color: black;">made</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">effortless!"</span><span style="background-color: #008000; color: black;"> </span></pre>
</div>
</div>
<section id="high-frequency-penalty" class="level3">
<h3 class="anchored" data-anchor-id="high-frequency-penalty">High Frequency Penalty</h3>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"></span>
<span id="cb52-2">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb52-3">  model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model,</span>
<span id="cb52-4">  messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb52-5">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a helpful assistant."</span>},</span>
<span id="cb52-6">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: question}</span>
<span id="cb52-7">  ],</span>
<span id="cb52-8">  logprobs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb52-9">  temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb52-10">  seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seed,</span>
<span id="cb52-11">  frequency_penalty<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb52-12">)</span>
<span id="cb52-13">highlight_openai_response(response)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="font-family: inherit; white-space: pre-wrap; word-break: break-all;"><span style="background-color: #008000; color: black;">1.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"Unleash</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #cce4cc; color: black;">Power</span><span style="background-color: #cce4cc; color: black;"> </span><span style="background-color: #008000; color: black;">of</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chat</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #5cad5c; color: black;">with</span><span style="background-color: #5cad5c; color: black;"> </span><span style="background-color: #b3d8b3; color: black;">ChatGPT!"</span><span style="background-color: #b3d8b3; color: black;"> </span><br><span style="background-color: #008000; color: black;">2.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #63b163; color: black;">"ChatGPT:</span><span style="background-color: #63b163; color: black;"> </span><span style="background-color: #b0d6b0; color: black;">Your</span><span style="background-color: #b0d6b0; color: black;"> </span><span style="background-color: #008000; color: black;">Trusted</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Conversational</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Companion."</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #108810; color: black;">3.</span><span style="background-color: #108810; color: black;"> </span><span style="background-color: #008000; color: black;">"Get</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Instant</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Answers</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #53a953; color: black;">and</span><span style="background-color: #53a953; color: black;"> </span><span style="background-color: #0c860c; color: black;">Engaging</span><span style="background-color: #0c860c; color: black;"> </span><span style="background-color: #008000; color: black;">Chats</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #038103; color: black;">with</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #50a750; color: black;">ChatGPT!"</span><span style="background-color: #50a750; color: black;"> </span><br><span style="background-color: #e8f2e8; color: black;">4.</span><span style="background-color: #e8f2e8; color: black;"> </span><span style="background-color: #8cc58c; color: black;">"Elevate</span><span style="background-color: #8cc58c; color: black;"> </span><span style="background-color: #008000; color: black;">Your</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #349a34; color: black;">Conversations</span><span style="background-color: #349a34; color: black;"> </span><span style="background-color: #47a347; color: black;">with</span><span style="background-color: #47a347; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Intelligence</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">of</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #e7f1e7; color: black;">ChatGPT."</span><span style="background-color: #e7f1e7; color: black;"> </span><br><span style="background-color: #d6e9d6; color: black;">5.</span><span style="background-color: #d6e9d6; color: black;"> </span><span style="background-color: #1f8f1f; color: black;">"Chat</span><span style="background-color: #1f8f1f; color: black;"> </span><span style="background-color: #2a952a; color: black;">Smarter,</span><span style="background-color: #2a952a; color: black;"> </span><span style="background-color: #0e870e; color: black;">With</span><span style="background-color: #0e870e; color: black;"> </span><span style="background-color: #038103; color: black;">Confidence</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #92c892; color: black;">-</span><span style="background-color: #92c892; color: black;"> </span><span style="background-color: #008000; color: black;">Made</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #068306; color: black;">Possible</span><span style="background-color: #068306; color: black;"> </span><span style="background-color: #008000; color: black;">by</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">ChatGPT!"</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #008000; color: black;">6.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #72b872; color: black;">"Discover</span><span style="background-color: #72b872; color: black;"> </span><span style="background-color: #008000; color: black;">a</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">New</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Level</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #d0e6d0; color: black;">of</span><span style="background-color: #d0e6d0; color: black;"> </span><span style="background-color: #008000; color: black;">Conversation</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Excellence</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #89c389; color: black;">with</span><span style="background-color: #89c389; color: black;"> </span><span style="background-color: #1a8d1a; color: black;">ChatGPT."</span><span style="background-color: #1a8d1a; color: black;"> </span><br><span style="background-color: #008000; color: black;">7.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #289428; color: black;">“Experience</span><span style="background-color: #289428; color: black;"> </span><span style="background-color: #2e972e; color: black;">Artificial</span><span style="background-color: #2e972e; color: black;"> </span><span style="background-color: #8ac48a; color: black;">Intelligence</span><span style="background-color: #8ac48a; color: black;"> </span><span style="background-color: #008000; color: black;">that</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Feels</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Human</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">–</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #028102; color: black;">Meet</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #008000; color: black;">chatbot</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #018001; color: black;">G.”</span><span style="background-color: #018001; color: black;"> </span><br><span style="background-color: #018001; color: black;">8.“Make</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #b1d7b1; color: black;">Every</span><span style="background-color: #b1d7b1; color: black;"> </span><span style="background-color: #269226; color: black;">Interaction</span><span style="background-color: #269226; color: black;"> </span><span style="background-color: #008000; color: black;">Count</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">–</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">Talk</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #94c994; color: black;">to</span><span style="background-color: #94c994; color: black;"> </span><span style="background-color: #51a851; color: black;">Our</span><span style="background-color: #51a851; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">Powerful</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #058205; color: black;">AI</span><span style="background-color: #058205; color: black;"> </span><span style="background-color: #008000; color: black;">Assistant!”</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #028102; color: black;">9.“Unlock</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #028102; color: black;">Boundless</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #018001; color: black;">Knowledge</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #87c287; color: black;">and</span><span style="background-color: #87c287; color: black;"> </span><span style="background-color: #008000; color: black;">Vivid</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #088408; color: black;">Imagination–</span><span style="background-color: #088408; color: black;"> </span><span style="background-color: #108810; color: black;">Say</span><span style="background-color: #108810; color: black;"> </span><span style="background-color: #d7e9d7; color: black;">Hi</span><span style="background-color: #d7e9d7; color: black;"> </span><span style="background-color: #55a955; color: black;">to</span><span style="background-color: #55a955; color: black;"> </span><span style="background-color: #3d9e3d; color: black;">Our</span><span style="background-color: #3d9e3d; color: black;"> </span><span style="background-color: #6db66d; color: black;">Intelligent</span><span style="background-color: #6db66d; color: black;"> </span><span style="background-color: #008000; color: black;">AI</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #7cbd7c; color: black;">friend!"</span><span style="background-color: #7cbd7c; color: black;"> </span><span style="background-color: #7cbd7c;"> </span><br><span style="background-color: #51a851; color: black;">10."Connect,</span><span style="background-color: #51a851; color: black;"> </span><span style="background-color: #8dc58d; color: black;">Collaborate,</span><span style="background-color: #8dc58d; color: black;"> </span><span style="background-color: #0b850b; color: black;">Converse</span><span style="background-color: #0b850b; color: black;"> </span><span style="background-color: #078407; color: black;">like</span><span style="background-color: #078407; color: black;"> </span><span style="background-color: #088408; color: black;">never</span><span style="background-color: #088408; color: black;"> </span><span style="background-color: #0c860c; color: black;">before</span><span style="background-color: #0c860c; color: black;"> </span><span style="background-color: #008000; color: black;">-</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #3b9d3b; color: black;">Powered</span><span style="background-color: #3b9d3b; color: black;"> </span><span style="background-color: #b9dbb9; color: black;">by</span><span style="background-color: #b9dbb9; color: black;"> </span><span style="background-color: #d3e7d3; color: black;">the</span><span style="background-color: #d3e7d3; color: black;"> </span><span style="background-color: #e6f1e6; color: black;">Amazingness</span><span style="background-color: #e6f1e6; color: black;"> </span><span style="background-color: #118811; color: black;">Of</span><span style="background-color: #118811; color: black;"> </span><span style="background-color: #d1e6d1; color: black;">'Yethe'"</span><span style="background-color: #d1e6d1; color: black;"> </span></pre>
</div>
</div>
</section>
<section id="low-frequency-penalty" class="level3">
<h3 class="anchored" data-anchor-id="low-frequency-penalty">Low Frequency Penalty</h3>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"></span>
<span id="cb53-2">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb53-3">  model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model,</span>
<span id="cb53-4">  messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb53-5">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a helpful assistant."</span>},</span>
<span id="cb53-6">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: question}</span>
<span id="cb53-7">  ],</span>
<span id="cb53-8">  logprobs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb53-9">  temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb53-10">  seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seed,</span>
<span id="cb53-11">  frequency_penalty<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb53-12">)</span>
<span id="cb53-13">highlight_openai_response(response)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="font-family: inherit; white-space: pre-wrap; word-break: break-all;"><span style="background-color: #008000; color: black;">1.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"Unleash</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #cbe4cb; color: black;">Power</span><span style="background-color: #cbe4cb; color: black;"> </span><span style="background-color: #008000; color: black;">of</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chat</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #5aac5a; color: black;">with</span><span style="background-color: #5aac5a; color: black;"> </span><span style="background-color: #b4d8b4; color: black;">ChatGPT!"</span><span style="background-color: #b4d8b4; color: black;"> </span><br><span style="background-color: #008000; color: black;">2.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #65b265; color: black;">"ChatGPT:</span><span style="background-color: #65b265; color: black;"> </span><span style="background-color: #b4d8b4; color: black;">Your</span><span style="background-color: #b4d8b4; color: black;"> </span><span style="background-color: #008000; color: black;">Trusted</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Conversational</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Companion!"</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #108810; color: black;">3.</span><span style="background-color: #108810; color: black;"> </span><span style="background-color: #008000; color: black;">"Get</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Instant</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Answers</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #54a954; color: black;">with</span><span style="background-color: #54a954; color: black;"> </span><span style="background-color: #018001; color: black;">ChatGPT!"</span><span style="background-color: #018001; color: black;"> </span><br><span style="background-color: #008000; color: black;">4.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #028102; color: black;">"ChatGPT:</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #4fa74f; color: black;">Making</span><span style="background-color: #4fa74f; color: black;"> </span><span style="background-color: #e8f2e8; color: black;">Conversations</span><span style="background-color: #e8f2e8; color: black;"> </span><span style="background-color: #8ec58e; color: black;">Smarter!"</span><span style="background-color: #8ec58e; color: black;"> </span><br><span style="background-color: #008000; color: black;">5.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #359a35; color: black;">"Connect,</span><span style="background-color: #359a35; color: black;"> </span><span style="background-color: #49a449; color: black;">Engage,</span><span style="background-color: #49a449; color: black;"> </span><span style="background-color: #008000; color: black;">and</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Learn</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">with</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #eaf2ea; color: black;">ChatGPT!"</span><span style="background-color: #eaf2ea; color: black;"> </span><br><span style="background-color: #ddecdd; color: black;">6.</span><span style="background-color: #ddecdd; color: black;"> </span><span style="background-color: #2c962c; color: black;">"Elevate</span><span style="background-color: #2c962c; color: black;"> </span><span style="background-color: #9dcd9d; color: black;">Your</span><span style="background-color: #9dcd9d; color: black;"> </span><span style="background-color: #048204; color: black;">Conversations</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #008000; color: black;">with</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">ChatGPT!"</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #74b974; color: black;">7.</span><span style="background-color: #74b974; color: black;"> </span><span style="background-color: #008000; color: black;">"ChatGPT:</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Your</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Virtual</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #239123; color: black;">Conversational</span><span style="background-color: #239123; color: black;"> </span><span style="background-color: #008000; color: black;">Superpower!"</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #008000; color: black;">8.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"Experience</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #d2e7d2; color: black;">the</span><span style="background-color: #d2e7d2; color: black;"> </span><span style="background-color: #138913; color: black;">Future</span><span style="background-color: #138913; color: black;"> </span><span style="background-color: #008000; color: black;">of</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #118911; color: black;">Chat</span><span style="background-color: #118911; color: black;"> </span><span style="background-color: #008000; color: black;">with</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #289328; color: black;">ChatGPT!"</span><span style="background-color: #289328; color: black;"> </span><br><span style="background-color: #008000; color: black;">9.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"ChatGPT:</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Making</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #e9f2e9; color: black;">Talk</span><span style="background-color: #e9f2e9; color: black;"> </span><span style="background-color: #61af61; color: black;">as</span><span style="background-color: #61af61; color: black;"> </span><span style="background-color: #daebda; color: black;">Intelligent</span><span style="background-color: #daebda; color: black;"> </span><span style="background-color: #008000; color: black;">as</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">You!"</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #0e870e; color: black;">10.</span><span style="background-color: #0e870e; color: black;"> </span><span style="background-color: #a3d0a3; color: black;">"ChatGPT:</span><span style="background-color: #a3d0a3; color: black;"> </span><span style="background-color: #008000; color: black;">Your</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chatbot</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Buddy</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">for</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Every</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Occasion!"</span><span style="background-color: #008000; color: black;"> </span></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature_files/figure-html/f9b010fd-1-image.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image.png</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature_files/figure-html/9d9e75e2-1-image.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image.png</figcaption>
</figure>
</div>
</section>
</section>
<section id="presence-penalty" class="level1">
<h1>Presence Penalty</h1>
<p>Presence Penalty is a parameter that influences the generation of new content by penalizing tokens that have already appeared in the text. It ranges from -2.0 to 2.0, where positive values discourage repetition and encourage the model to introduce new topics, while negative values do the opposite. This penalty is applied as a one-time, additive contribution to tokens that have been used at least once, helping to ensure more diverse and creative outputs</p>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"></span>
<span id="cb54-2">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb54-3">  model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model,</span>
<span id="cb54-4">  messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb54-5">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a helpful assistant."</span>},</span>
<span id="cb54-6">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: question}</span>
<span id="cb54-7">  ],</span>
<span id="cb54-8">  logprobs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb54-9">  temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb54-10">  seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seed</span>
<span id="cb54-11">)</span>
<span id="cb54-12">highlight_openai_response(response)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="font-family: inherit; white-space: pre-wrap; word-break: break-all;"><span style="background-color: #008000; color: black;">1.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"Unleash</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #cce4cc; color: black;">Power</span><span style="background-color: #cce4cc; color: black;"> </span><span style="background-color: #008000; color: black;">of</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chat</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #5cad5c; color: black;">with</span><span style="background-color: #5cad5c; color: black;"> </span><span style="background-color: #b3d8b3; color: black;">ChatGPT!"</span><span style="background-color: #b3d8b3; color: black;"> </span><br><span style="background-color: #008000; color: black;">2.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #63b163; color: black;">"ChatGPT:</span><span style="background-color: #63b163; color: black;"> </span><span style="background-color: #b0d6b0; color: black;">Your</span><span style="background-color: #b0d6b0; color: black;"> </span><span style="background-color: #008000; color: black;">Trusted</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Conversational</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Companion!"</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #108810; color: black;">3.</span><span style="background-color: #108810; color: black;"> </span><span style="background-color: #008000; color: black;">"Get</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Instant</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Answers</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #53a953; color: black;">with</span><span style="background-color: #53a953; color: black;"> </span><span style="background-color: #028102; color: black;">ChatGPT</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #008000; color: black;">-</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #038103; color: black;">Chat</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #4fa74f; color: black;">smarter,</span><span style="background-color: #4fa74f; color: black;"> </span><span style="background-color: #e8f2e8; color: black;">not</span><span style="background-color: #e8f2e8; color: black;"> </span><span style="background-color: #8dc58d; color: black;">harder!"</span><span style="background-color: #8dc58d; color: black;"> </span><br><span style="background-color: #008000; color: black;">4.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #349934; color: black;">"Break</span><span style="background-color: #349934; color: black;"> </span><span style="background-color: #5aac5a; color: black;">the</span><span style="background-color: #5aac5a; color: black;"> </span><span style="background-color: #008000; color: black;">Ice</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">with</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">ChatGPT</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #e9f2e9; color: black;">-</span><span style="background-color: #e9f2e9; color: black;"> </span><span style="background-color: #d8ead8; color: black;">The</span><span style="background-color: #d8ead8; color: black;"> </span><span style="background-color: #259225; color: black;">Ultimate</span><span style="background-color: #259225; color: black;"> </span><span style="background-color: #b2d7b1; color: black;">Conversation</span><span style="background-color: #b2d7b1; color: black;"> </span><span style="background-color: #068306; color: black;">Starter!"</span><span style="background-color: #068306; color: black;"> </span><br><span style="background-color: #008000; color: black;">5.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"ChatGPT:</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #a6d2a6; color: black;">With</span><span style="background-color: #a6d2a6; color: black;"> </span><span style="background-color: #cce4cc; color: black;">every</span><span style="background-color: #cce4cc; color: black;"> </span><span style="background-color: #c7e1c7; color: black;">chat,</span><span style="background-color: #c7e1c7; color: black;"> </span><span style="background-color: #088408; color: black;">knowledge</span><span style="background-color: #088408; color: black;"> </span><span style="background-color: #188c18; color: black;">expands!"</span><span style="background-color: #188c18; color: black;"> </span><br><span style="background-color: #008000; color: black;">6.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #018001; color: black;">"Join</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chat</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Revolution</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">-</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #259225; color: black;">Welcome</span><span style="background-color: #259225; color: black;"> </span><span style="background-color: #d6e9d6; color: black;">to</span><span style="background-color: #d6e9d6; color: black;"> </span><span style="background-color: #1f8f1f; color: black;">ChatGPT!"</span><span style="background-color: #1f8f1f; color: black;"> </span><br><span style="background-color: #008000; color: black;">7.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"Experience</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chat</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #098509; color: black;">Brilliance</span><span style="background-color: #098509; color: black;"> </span><span style="background-color: #d0e6d0; color: black;">with</span><span style="background-color: #d0e6d0; color: black;"> </span><span style="background-color: #1c8e1c; color: black;">ChatGPT</span><span style="background-color: #1c8e1c; color: black;"> </span><span style="background-color: #3f9f3f; color: black;">-</span><span style="background-color: #3f9f3f; color: black;"> </span><span style="background-color: #018001; color: black;">Seamless</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #008000; color: black;">Conversations,</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Unmatched</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Results!"</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #008000; color: black;">8.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #2e972e; color: black;">"Chat</span><span style="background-color: #2e972e; color: black;"> </span><span style="background-color: #008000; color: black;">Smarter,</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Talk</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #1d8e1d; color: black;">Faster</span><span style="background-color: #1d8e1d; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">with</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #d5e9d5; color: black;">ChatGPT!"</span><span style="background-color: #d5e9d5; color: black;"> </span><br><span style="background-color: #8ec58e; color: black;">9.</span><span style="background-color: #8ec58e; color: black;"> </span><span style="background-color: #048204; color: black;">"ChatGPT:</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #dcecdc; color: black;">The</span><span style="background-color: #dcecdc; color: black;"> </span><span style="background-color: #5fae5f; color: black;">Intelligent</span><span style="background-color: #5fae5f; color: black;"> </span><span style="background-color: #068306; color: black;">Chatbot</span><span style="background-color: #068306; color: black;"> </span><span style="background-color: #008000; color: black;">for</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">All</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Your</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">Conversational</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #008000; color: black;">Needs!"</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #0e870e; color: black;">10.</span><span style="background-color: #0e870e; color: black;"> </span><span style="background-color: #56aa56; color: black;">"Unlock</span><span style="background-color: #56aa56; color: black;"> </span><span style="background-color: #c9e3c9; color: black;">the</span><span style="background-color: #c9e3c9; color: black;"> </span><span style="background-color: #ddecdd; color: black;">Potential</span><span style="background-color: #ddecdd; color: black;"> </span><span style="background-color: #008000; color: black;">of</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #369b36; color: black;">Chat</span><span style="background-color: #369b36; color: black;"> </span><span style="background-color: #008000; color: black;">with</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">ChatGPT</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #038103; color: black;">-</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #008000; color: black;">Conversations</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Redefined!"</span><span style="background-color: #008000; color: black;"> </span></pre>
</div>
</div>
<section id="high-presence-penalty" class="level3">
<h3 class="anchored" data-anchor-id="high-presence-penalty">High Presence Penalty</h3>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"></span>
<span id="cb55-2">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb55-3">  model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model,</span>
<span id="cb55-4">  messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb55-5">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a helpful assistant."</span>},</span>
<span id="cb55-6">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: question}</span>
<span id="cb55-7">  ],</span>
<span id="cb55-8">  logprobs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb55-9">  temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb55-10">  seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seed,</span>
<span id="cb55-11">  presence_penalty<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb55-12">)</span>
<span id="cb55-13">highlight_openai_response(response)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="font-family: inherit; white-space: pre-wrap; word-break: break-all;"><span style="background-color: #008000; color: black;">1.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"Unleash</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #cce4cc; color: black;">Power</span><span style="background-color: #cce4cc; color: black;"> </span><span style="background-color: #008000; color: black;">of</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chat</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #5cad5c; color: black;">with</span><span style="background-color: #5cad5c; color: black;"> </span><span style="background-color: #b7dab7; color: black;">ChatGPT!"</span><span style="background-color: #b7dab7; color: black;"> </span><br><span style="background-color: #008000; color: black;">2.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #63b163; color: black;">"ChatGPT:</span><span style="background-color: #63b163; color: black;"> </span><span style="background-color: #b0d6b0; color: black;">Your</span><span style="background-color: #b0d6b0; color: black;"> </span><span style="background-color: #008000; color: black;">Trusted</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Conversational</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Companion."</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #108810; color: black;">3.</span><span style="background-color: #108810; color: black;"> </span><span style="background-color: #008000; color: black;">"Get</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Instant</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Answers</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #53a953; color: black;">and</span><span style="background-color: #53a953; color: black;"> </span><span style="background-color: #078407; color: black;">Engaging</span><span style="background-color: #078407; color: black;"> </span><span style="background-color: #008000; color: black;">Chats</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #028102; color: black;">with</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #4fa74f; color: black;">ChatGPT!"</span><span style="background-color: #4fa74f; color: black;"> </span><br><span style="background-color: #e8f2e8; color: black;">4.</span><span style="background-color: #e8f2e8; color: black;"> </span><span style="background-color: #8cc58c; color: black;">"Elevate</span><span style="background-color: #8cc58c; color: black;"> </span><span style="background-color: #008000; color: black;">Your</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #349934; color: black;">Conversations</span><span style="background-color: #349934; color: black;"> </span><span style="background-color: #56aa56; color: black;">with</span><span style="background-color: #56aa56; color: black;"> </span><span style="background-color: #008000; color: black;">ChatGPT's</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Intelligent</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">AI."</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #e7f1e7; color: black;">5.</span><span style="background-color: #e7f1e7; color: black;"> </span><span style="background-color: #d6e9d6; color: black;">"ChatGPT:</span><span style="background-color: #d6e9d6; color: black;"> </span><span style="background-color: #209020; color: black;">With</span><span style="background-color: #209020; color: black;"> </span><span style="background-color: #319831; color: black;">You</span><span style="background-color: #319831; color: black;"> </span><span style="background-color: #0f870f; color: black;">Every</span><span style="background-color: #0f870f; color: black;"> </span><span style="background-color: #038103; color: black;">Step</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #abd4ab; color: black;">of</span><span style="background-color: #abd4ab; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #048204; color: black;">Conversation."</span><span style="background-color: #048204; color: black;"> </span><br><span style="background-color: #008000; color: black;">6.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"Unlock</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">New</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #72b872; color: black;">Possibilities</span><span style="background-color: #72b872; color: black;"> </span><span style="background-color: #008000; color: black;">in</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Dialogue</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">with</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #d3e7d3; color: black;">ChatGPT."</span><span style="background-color: #d3e7d3; color: black;"> </span><br><span style="background-color: #008000; color: black;">7.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"Experience</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #6cb56c; color: black;">Natural</span><span style="background-color: #6cb56c; color: black;"> </span><span style="background-color: #148a14; color: black;">Language</span><span style="background-color: #148a14; color: black;"> </span><span style="background-color: #008000; color: black;">Communication</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #048204; color: black;">with</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #44a144; color: black;">ChatGPT."</span><span style="background-color: #44a144; color: black;"> </span><br><span style="background-color: #008000; color: black;">8.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"Supercharge</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #1c8e1c; color: black;">Your</span><span style="background-color: #1c8e1c; color: black;"> </span><span style="background-color: #cbe4cb; color: black;">Conversations</span><span style="background-color: #cbe4cb; color: black;"> </span><span style="background-color: #86c286; color: black;">with</span><span style="background-color: #86c286; color: black;"> </span><span style="background-color: #048204; color: black;">ChatGPT's</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #008000; color: black;">AI</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Assistant."</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #008000; color: black;">9.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #96c996; color: black;">"Chat</span><span style="background-color: #96c996; color: black;"> </span><span style="background-color: #1b8d1b; color: black;">Smarter,</span><span style="background-color: #1b8d1b; color: black;"> </span><span style="background-color: #008000; color: black;">Not</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #078407; color: black;">Harder,</span><span style="background-color: #078407; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">with</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #40a040; color: black;">ChatGPT."</span><span style="background-color: #40a040; color: black;"> </span><br><span style="background-color: #399c39; color: black;">10.</span><span style="background-color: #399c39; color: black;"> </span><span style="background-color: #008000; color: black;">"Say</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Hello</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #018001; color: black;">to</span><span style="background-color: #018001; color: black;"> </span><span style="background-color: #289328; color: black;">Seamless</span><span style="background-color: #289328; color: black;"> </span><span style="background-color: #068306; color: black;">Chats</span><span style="background-color: #068306; color: black;"> </span><span style="background-color: #008000; color: black;">and</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Intelligent</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Responses</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #b8dab8; color: black;">with</span><span style="background-color: #b8dab8; color: black;"> </span><span style="background-color: #daebda; color: black;">ChatGPT!"</span><span style="background-color: #daebda; color: black;"> </span></pre>
</div>
</div>
</section>
<section id="low-presence-penalty" class="level3">
<h3 class="anchored" data-anchor-id="low-presence-penalty">Low Presence Penalty</h3>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"></span>
<span id="cb56-2">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb56-3">  model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model,</span>
<span id="cb56-4">  messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb56-5">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a helpful assistant."</span>},</span>
<span id="cb56-6">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: question}</span>
<span id="cb56-7">  ],</span>
<span id="cb56-8">  logprobs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb56-9">  temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb56-10">  seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seed,</span>
<span id="cb56-11">  presence_penalty<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb56-12">)</span>
<span id="cb56-13">highlight_openai_response(response)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="font-family: inherit; white-space: pre-wrap; word-break: break-all;"><span style="background-color: #008000; color: black;">1.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"Unleash</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #cce4cc; color: black;">Power</span><span style="background-color: #cce4cc; color: black;"> </span><span style="background-color: #008000; color: black;">of</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chat</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #5cad5c; color: black;">with</span><span style="background-color: #5cad5c; color: black;"> </span><span style="background-color: #b7dab7; color: black;">ChatGPT!"</span><span style="background-color: #b7dab7; color: black;"> </span><br><span style="background-color: #008000; color: black;">2.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #63b163; color: black;">"ChatGPT:</span><span style="background-color: #63b163; color: black;"> </span><span style="background-color: #b0d6b0; color: black;">Your</span><span style="background-color: #b0d6b0; color: black;"> </span><span style="background-color: #008000; color: black;">Trusted</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Conversational</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Companion!"</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #108810; color: black;">3.</span><span style="background-color: #108810; color: black;"> </span><span style="background-color: #008000; color: black;">"ChatGPT:</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chatting</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">just</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #54a954; color: black;">got</span><span style="background-color: #54a954; color: black;"> </span><span style="background-color: #008000; color: black;">Smarter!"</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #008000; color: black;">4.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #038103; color: black;">"Connect</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #51a851; color: black;">with</span><span style="background-color: #51a851; color: black;"> </span><span style="background-color: #e8f2e8; color: black;">ChatGPT:</span><span style="background-color: #e8f2e8; color: black;"> </span><span style="background-color: #94c994; color: black;">Your</span><span style="background-color: #94c994; color: black;"> </span><span style="background-color: #008000; color: black;">Virtual</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #349934; color: black;">Chatting</span><span style="background-color: #349934; color: black;"> </span><span style="background-color: #158a15; color: black;">Guru!"</span><span style="background-color: #158a15; color: black;"> </span><br><span style="background-color: #008000; color: black;">5.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"ChatGPT:</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Arm</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #158a15; color: black;">Your</span><span style="background-color: #158a15; color: black;"> </span><span style="background-color: #008000; color: black;">Conversations</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">With</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Intelligence!"</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #d0e6d0; color: black;">6.</span><span style="background-color: #d0e6d0; color: black;"> </span><span style="background-color: #6fb76f; color: black;">"ChatGPT:</span><span style="background-color: #6fb76f; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">Chatting</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #008000; color: black;">Perfected</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #77ba77; color: black;">with</span><span style="background-color: #77ba77; color: black;"> </span><span style="background-color: #008000; color: black;">Artificial</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #118911; color: black;">Intelligence!"</span><span style="background-color: #118911; color: black;"> </span><br><span style="background-color: #008000; color: black;">7.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"ChatGPT:</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Your</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #eaf2ea; color: black;">Personal</span><span style="background-color: #eaf2ea; color: black;"> </span><span style="background-color: #9ccd9c; color: black;">Chatting</span><span style="background-color: #9ccd9c; color: black;"> </span><span style="background-color: #088408; color: black;">Assistant</span><span style="background-color: #088408; color: black;"> </span><span style="background-color: #008000; color: black;">with</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #349a34; color: black;">Power</span><span style="background-color: #349a34; color: black;"> </span><span style="background-color: #8dc58d; color: black;">of</span><span style="background-color: #8dc58d; color: black;"> </span><span style="background-color: #afd6af; color: black;">AI!"</span><span style="background-color: #afd6af; color: black;"> </span><br><span style="background-color: #78bb78; color: black;">8.</span><span style="background-color: #78bb78; color: black;"> </span><span style="background-color: #43a143; color: black;">"ChatGPT:</span><span style="background-color: #43a143; color: black;"> </span><span style="background-color: #d4e8d4; color: black;">Elevate</span><span style="background-color: #d4e8d4; color: black;"> </span><span style="background-color: #008000; color: black;">Your</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Conversations</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">to</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #138913; color: black;">Next</span><span style="background-color: #138913; color: black;"> </span><span style="background-color: #008000; color: black;">Level!"</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #008000; color: black;">9.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"ChatGPT:</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">Your</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #d7e9d7; color: black;">Smart</span><span style="background-color: #d7e9d7; color: black;"> </span><span style="background-color: #098509; color: black;">Friend</span><span style="background-color: #098509; color: black;"> </span><span style="background-color: #008000; color: black;">for</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">Engaging</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #5eae5e; color: black;">Chats!"</span><span style="background-color: #5eae5e; color: black;"> </span><br><span style="background-color: #008000; color: black;">10.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"ChatGPT:</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Intelligent</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Conversations</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #289328; color: black;">Made</span><span style="background-color: #289328; color: black;"> </span><span style="background-color: #048204; color: black;">Effortless!"</span><span style="background-color: #048204; color: black;"> </span></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature_files/figure-html/e33386e8-1-image.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image.png</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature_files/figure-html/1ace7c9e-1-image.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image.png</figcaption>
</figure>
</div>
</section>
</section>
<section id="interaction-between-frequency-penalty-and-presence-penalty" class="level1">
<h1>Interaction between Frequency Penalty and Presence Penalty</h1>
<section id="high-frequency-penalty-and-high-presence-penalty" class="level3">
<h3 class="anchored" data-anchor-id="high-frequency-penalty-and-high-presence-penalty">High Frequency Penalty and High Presence Penalty</h3>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"></span>
<span id="cb57-2">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb57-3">  model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model,</span>
<span id="cb57-4">  messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb57-5">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a helpful assistant."</span>},</span>
<span id="cb57-6">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: question}</span>
<span id="cb57-7">  ],</span>
<span id="cb57-8">  logprobs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb57-9">  temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb57-10">  seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seed,</span>
<span id="cb57-11">  presence_penalty<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.8</span>,</span>
<span id="cb57-12">  frequency_penalty<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.8</span></span>
<span id="cb57-13">)</span>
<span id="cb57-14">highlight_openai_response(response)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="font-family: inherit; white-space: pre-wrap; word-break: break-all;"><span style="background-color: #008000; color: black;">1.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"Unleash</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #cbe4cb; color: black;">Power</span><span style="background-color: #cbe4cb; color: black;"> </span><span style="background-color: #008000; color: black;">of</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chat</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #5aac5a; color: black;">with</span><span style="background-color: #5aac5a; color: black;"> </span><span style="background-color: #b4d8b4; color: black;">ChatGPT!"</span><span style="background-color: #b4d8b4; color: black;"> </span><br><span style="background-color: #008000; color: black;">2.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #65b265; color: black;">"ChatGPT:</span><span style="background-color: #65b265; color: black;"> </span><span style="background-color: #b4d8b4; color: black;">Your</span><span style="background-color: #b4d8b4; color: black;"> </span><span style="background-color: #048204; color: black;">Trusted</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #008000; color: black;">Conversational</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Companion."</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #108810; color: black;">3.</span><span style="background-color: #108810; color: black;"> </span><span style="background-color: #008000; color: black;">"Get</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Instant</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Answers</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #54a954; color: black;">and</span><span style="background-color: #54a954; color: black;"> </span><span style="background-color: #339933; color: black;">Engaging</span><span style="background-color: #339933; color: black;"> </span><span style="background-color: #008000; color: black;">Chats</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #028102; color: black;">with</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #4ea64e; color: black;">ChatGPT!"</span><span style="background-color: #4ea64e; color: black;"> </span><br><span style="background-color: #e8f2e8; color: black;">4.</span><span style="background-color: #e8f2e8; color: black;"> </span><span style="background-color: #8bc48b; color: black;">"Elevate</span><span style="background-color: #8bc48b; color: black;"> </span><span style="background-color: #008000; color: black;">Your</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #359a35; color: black;">Conversations</span><span style="background-color: #359a35; color: black;"> </span><span style="background-color: #2f972f; color: black;">with</span><span style="background-color: #2f972f; color: black;"> </span><span style="background-color: #008000; color: black;">AI-Powered</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">ChatGPT."</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #008000; color: black;">5.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #e6f1e6; color: black;">"Let's</span><span style="background-color: #e6f1e6; color: black;"> </span><span style="background-color: #d5e9d5; color: black;">Talk!</span><span style="background-color: #d5e9d5; color: black;"> </span><span style="background-color: #209020; color: black;">With</span><span style="background-color: #209020; color: black;"> </span><span style="background-color: #219021; color: black;">Dynamic</span><span style="background-color: #219021; color: black;"> </span><span style="background-color: #0d860d; color: black;">Dialogue</span><span style="background-color: #0d860d; color: black;"> </span><span style="background-color: #038103; color: black;">Made</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #45a245; color: black;">Easy</span><span style="background-color: #45a245; color: black;"> </span><span style="background-color: #008000; color: black;">by</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #1b8d1b; color: black;">ChatGPT."</span><span style="background-color: #1b8d1b; color: black;"> </span><br><span style="background-color: #008000; color: black;">6.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"Discover</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Smarter,</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #79bc79; color: black;">More</span><span style="background-color: #79bc79; color: black;"> </span><span style="background-color: #008000; color: black;">Natural</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chats</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Using</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #cbe4cb; color: black;">ChatGPT."</span><span style="background-color: #cbe4cb; color: black;"> </span><br><span style="background-color: #008000; color: black;">7.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"Unlock</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #cde5cd; color: black;">a</span><span style="background-color: #cde5cd; color: black;"> </span><span style="background-color: #56aa56; color: black;">World</span><span style="background-color: #56aa56; color: black;"> </span><span style="background-color: #008000; color: black;">of</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #6ab46a; color: black;">Seamless</span><span style="background-color: #6ab46a; color: black;"> </span><span style="background-color: #96c996; color: black;">Communication</span><span style="background-color: #96c996; color: black;"> </span><span style="background-color: #128912; color: black;">with</span><span style="background-color: #128912; color: black;"> </span><span style="background-color: #008000; color: black;">ChatGPT."</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000;"> </span><br><span style="background-color: #269226; color: black;">8</span><span style="background-color: #269226; color: black;"> </span><span style="background-color: #259225; color: black;">."Experience</span><span style="background-color: #259225; color: black;"> </span><span style="background-color: #008000; color: black;">Human-Like</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #068306; color: black;">Interactions</span><span style="background-color: #068306; color: black;"> </span><span style="background-color: #008000; color: black;">using</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #038103; color: black;">our</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #028102; color: black;">Advanced</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #eaf2ea; color: black;">Assistant</span><span style="background-color: #eaf2ea; color: black;"> </span><span style="background-color: #87c287; color: black;">-Chat</span><span style="background-color: #87c287; color: black;"> </span><span style="background-color: #038103; color: black;">Gpt"</span><span style="background-color: #038103; color: black;"> </span><br><span style="background-color: #80bf80; color: black;">9</span><span style="background-color: #80bf80; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">."Your</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">Virtual</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #85c185; color: black;">Conversation</span><span style="background-color: #85c185; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">Buddy</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #8ec58e; color: black;">–</span><span style="background-color: #8ec58e; color: black;"> </span><span style="background-color: #048204; color: black;">Get</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #038103; color: black;">Talking</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #048204; color: black;">With</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #038103; color: black;">Chat</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #108810; color: black;">Gpt</span><span style="background-color: #108810; color: black;"> </span><span style="background-color: #008000; color: black;">Now</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #108810; color: black;">!</span><span style="background-color: #108810; color: black;"> </span><span style="background-color: #178b17; color: black;">"</span><span style="background-color: #178b17; color: black;"> </span><br><span style="background-color: #ddecdd; color: black;">10</span><span style="background-color: #ddecdd; color: black;"> </span><span style="background-color: #e9f2e9; color: black;">."Revolutionize</span><span style="background-color: #e9f2e9; color: black;"> </span><span style="background-color: #008000; color: black;">Your</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #86c286; color: black;">Conversations</span><span style="background-color: #86c286; color: black;"> </span><span style="background-color: #3a9c3a; color: black;">w</span><span style="background-color: #3a9c3a; color: black;"> </span></pre>
</div>
</div>
</section>
<section id="low-frequency-penalty-and-low-presence-penalty" class="level3">
<h3 class="anchored" data-anchor-id="low-frequency-penalty-and-low-presence-penalty">Low Frequency Penalty and Low Presence Penalty</h3>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"></span>
<span id="cb58-2">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> client.chat.completions.create(</span>
<span id="cb58-3">  model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model,</span>
<span id="cb58-4">  messages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb58-5">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a helpful assistant."</span>},</span>
<span id="cb58-6">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"role"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: question}</span>
<span id="cb58-7">  ],</span>
<span id="cb58-8">  logprobs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb58-9">  temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb58-10">  seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seed,</span>
<span id="cb58-11">  presence_penalty<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb58-12">  frequency_penalty<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb58-13">)</span>
<span id="cb58-14">highlight_openai_response(response)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="font-family: inherit; white-space: pre-wrap; word-break: break-all;"><span style="background-color: #008000; color: black;">1.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"Unleash</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">the</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #cce4cc; color: black;">Power</span><span style="background-color: #cce4cc; color: black;"> </span><span style="background-color: #008000; color: black;">of</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chat</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #5cad5c; color: black;">with</span><span style="background-color: #5cad5c; color: black;"> </span><span style="background-color: #b4d8b4; color: black;">ChatGPT!"</span><span style="background-color: #b4d8b4; color: black;"> </span><br><span style="background-color: #008000; color: black;">2.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #62b062; color: black;">"ChatGPT:</span><span style="background-color: #62b062; color: black;"> </span><span style="background-color: #b0d6b0; color: black;">Your</span><span style="background-color: #b0d6b0; color: black;"> </span><span style="background-color: #008000; color: black;">Trusted</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Conversational</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Companion!"</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #108810; color: black;">3.</span><span style="background-color: #108810; color: black;"> </span><span style="background-color: #008000; color: black;">"ChatGPT:</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chatting</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">just</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #53a953; color: black;">got</span><span style="background-color: #53a953; color: black;"> </span><span style="background-color: #008000; color: black;">Smarter!"</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #008000; color: black;">4.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #038103; color: black;">"Connect</span><span style="background-color: #038103; color: black;"> </span><span style="background-color: #50a750; color: black;">with</span><span style="background-color: #50a750; color: black;"> </span><span style="background-color: #e8f2e8; color: black;">ChatGPT:</span><span style="background-color: #e8f2e8; color: black;"> </span><span style="background-color: #90c790; color: black;">Chatting</span><span style="background-color: #90c790; color: black;"> </span><span style="background-color: #008000; color: black;">with</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #349934; color: black;">Intelligence!"</span><span style="background-color: #349934; color: black;"> </span><br><span style="background-color: #2c962c; color: black;">5.</span><span style="background-color: #2c962c; color: black;"> </span><span style="background-color: #008000; color: black;">"ChatGPT:</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Revolutionizing</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chatting,</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #339933; color: black;">One</span><span style="background-color: #339933; color: black;"> </span><span style="background-color: #008000; color: black;">Conversation</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">at</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">a</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #d2e7d2; color: black;">Time!"</span><span style="background-color: #d2e7d2; color: black;"> </span><br><span style="background-color: #61af61; color: black;">6.</span><span style="background-color: #61af61; color: black;"> </span><span style="background-color: #ebf3eb; color: black;">"ChatGPT:</span><span style="background-color: #ebf3eb; color: black;"> </span><span style="background-color: #008000; color: black;">Your</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #77ba77; color: black;">Virtual</span><span style="background-color: #77ba77; color: black;"> </span><span style="background-color: #008000; color: black;">Chatting</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #1d8e1d; color: black;">Expert!"</span><span style="background-color: #1d8e1d; color: black;"> </span><br><span style="background-color: #008000; color: black;">7.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"ChatGPT:</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chatting</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #e9f2e9; color: black;">with</span><span style="background-color: #e9f2e9; color: black;"> </span><span style="background-color: #c9e2c8; color: black;">Artificial</span><span style="background-color: #c9e2c8; color: black;"> </span><span style="background-color: #048204; color: black;">Intelligence</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #008000; color: black;">that</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Feels</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #4ba54b; color: black;">Human!"</span><span style="background-color: #4ba54b; color: black;"> </span><br><span style="background-color: #b8dab8; color: black;">8.</span><span style="background-color: #b8dab8; color: black;"> </span><span style="background-color: #1f8f1f; color: black;">"ChatGPT:</span><span style="background-color: #1f8f1f; color: black;"> </span><span style="background-color: #c9e3c9; color: black;">Chatting</span><span style="background-color: #c9e3c9; color: black;"> </span><span style="background-color: #b7dab7; color: black;">made</span><span style="background-color: #b7dab7; color: black;"> </span><span style="background-color: #008000; color: black;">Easy,</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chatting</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">made</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Powerful!"</span><span style="background-color: #008000; color: black;"> </span><br><span style="background-color: #289428; color: black;">9.</span><span style="background-color: #289428; color: black;"> </span><span style="background-color: #008000; color: black;">"ChatGPT:</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chatting</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">with</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #deedde; color: black;">the</span><span style="background-color: #deedde; color: black;"> </span><span style="background-color: #028102; color: black;">Next</span><span style="background-color: #028102; color: black;"> </span><span style="background-color: #b2d7b2; color: black;">Level</span><span style="background-color: #b2d7b2; color: black;"> </span><span style="background-color: #3f9f3f; color: black;">of</span><span style="background-color: #3f9f3f; color: black;"> </span><span style="background-color: #badbba; color: black;">Chatbot</span><span style="background-color: #badbba; color: black;"> </span><span style="background-color: #068306; color: black;">Technology!"</span><span style="background-color: #068306; color: black;"> </span><br><span style="background-color: #048204; color: black;">10.</span><span style="background-color: #048204; color: black;"> </span><span style="background-color: #008000; color: black;">"ChatGPT:</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Chatting.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">Redefined.</span><span style="background-color: #008000; color: black;"> </span><span style="background-color: #008000; color: black;">"</span><span style="background-color: #008000; color: black;"> </span></pre>
</div>
</div>
</section>
</section>
<section id="practical-use-cases" class="level1">
<h1>Practical Use Cases</h1>
<section id="industry-1-creative-writing-e.g.-novels-short-stories" class="level3">
<h3 class="anchored" data-anchor-id="industry-1-creative-writing-e.g.-novels-short-stories">Industry 1: Creative Writing (e.g., Novels, Short Stories)</h3>
<ol type="1">
<li><strong>Temperature</strong>: Set to 0.8-0.9. Higher temperature encourages more creative and unexpected turns of phrase, enhancing the storytelling with originality.</li>
<li><strong>Top P (Nucleus Sampling)</strong>: Set around 0.9. Allows for a good range of probable words while still fostering creativity, which is vital in creative writing.</li>
<li><strong>Frequency Penalty</strong>: Set to a moderate value (e.g., 0.5). Helps avoid excessive repetition of words/phrases, maintaining a fresh and engaging narrative.</li>
<li><strong>Presence Penalty</strong>: Set to a lower value (e.g., 0.3-0.4). Encourages some repetition of key themes or phrases, which can be a powerful tool in storytelling.</li>
</ol>
</section>
<section id="industry-2-customer-support-e.g.-chatbots-for-service-queries" class="level3">
<h3 class="anchored" data-anchor-id="industry-2-customer-support-e.g.-chatbots-for-service-queries">Industry 2: Customer Support (e.g., Chatbots for Service Queries)</h3>
<ol type="1">
<li><strong>Temperature</strong>: Set lower, around 0.3-0.4. Ensures more predictable and relevant responses, crucial for accurate customer support.</li>
<li><strong>Top P (Nucleus Sampling)</strong>: Set around 0.8. Balances the need for coherent, relevant responses while allowing for some variability to better match customer queries.</li>
<li><strong>Frequency Penalty</strong>: Moderate to high (e.g., 0.6-0.8). In customer support, avoiding repetitive phrases can enhance clarity and professionalism in responses.</li>
<li><strong>Presence Penalty</strong>: Moderate (e.g., 0.5). Helps ensure a variety of information is provided, which can be crucial in addressing diverse customer queries comprehensively.</li>
</ol>
<section id="explanation" class="level4">
<h4 class="anchored" data-anchor-id="explanation">Explanation:</h4>
<ul>
<li><strong>Creative Writing</strong>: The settings are designed to maximize creativity and originality, ensuring a rich and engaging narrative.</li>
<li><strong>Customer Support</strong>: The focus here is on accuracy, relevance, and clarity in responses, which are essential in a customer support context.</li>
</ul>



</section>
</section>
</section>

<div class="quarto-listing quarto-listing-container-default" id="listing-listing">
<div class="list quarto-listing-default">

</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div><a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>llm</category>
  <category>openai</category>
  <guid>https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/llm_temperature.html</guid>
  <pubDate>Sat, 16 Dec 2023 18:30:00 GMT</pubDate>
  <media:content url="https://www.arunprakash.org/posts/understanding-openai-chatcompletion-model-parameters/IMG_F4CC52CE7F7F-1.jpeg" medium="image" type="image/jpeg"/>
</item>
</channel>
</rss>
